

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Customising navigation menus &mdash; django cms 3.1.0 documentation</title>






  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>









    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />





    <link rel="top" title="django cms 3.1.0 documentation" href="../index.html"/>
        <link rel="up" title="How-to guides" href="index.html"/>
        <link rel="next" title="Apphooks" href="apphooks.html"/>
        <link rel="prev" title="Custom Plugins" href="custom_plugins.html"/>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">


    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">

          <a href="../index.html" class="fa fa-home"> django cms</a>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">



              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/install.html">Installing django CMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/templates_placeholders.html">Templates &amp; Placeholders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/apphooks.html">Apphooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/third_party.html">Integrating a third-party application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/toolbar.html">Extending the Toolbar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/menu.html">Extending the navigation menu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/namespaced_apphooks.html">Namespaced Apphooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/contributing.html">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">How-to guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install.html">Installing django CMS by hand</a></li>
<li class="toctree-l2"><a class="reference internal" href="custom_plugins.html">Custom Plugins</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Customising navigation menus</a></li>
<li class="toctree-l2"><a class="reference internal" href="apphooks.html">Apphooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates.html">Working with templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="extending_page_title.html">Extending the page &amp; title models</a></li>
<li class="toctree-l2"><a class="reference internal" href="toolbar.html">Extending the Toolbar</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_south.html">Using South with django CMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Testing Your Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="placeholders.html">Placeholders outside the CMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="caching.html">Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="frontend_models.html">Frontend editing for Page and Django models</a></li>
<li class="toctree-l2"><a class="reference internal" href="sitemap.html">Sitemap Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../topics/index.html">Key topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../topics/menu_system.html">How the menu system works</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/publishing.html">Publishing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/multiple_languages.html">Serving content in multiple languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/i18n.html">Internationalisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/permissions.html">Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/commonly_used_plugins.html">Some commonly-used plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/searchdocs.html">Search and django CMS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/navigation.html">Navigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/api_references.html">API References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/fields.html">Form and model fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/templatetags.html">Template Tags</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/cli.html">Command Line Interface</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Development &amp; community</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/development.html">Development of django CMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/contributing.html">Contributing to django CMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/management.html">Code and project management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/testing.html">Running and writing tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#branch-policy">Branch policy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../upgrade/index.html">Release notes &amp; upgrade information</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.1.1.html">3.1.1 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.1.html">3.1 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.0.14.html">3.0.14 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.0.13.html">3.0.13 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.0.12.html">3.0.12 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.0.11.html">3.0.11 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.0.10.html">3.0.10 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.0.9.html">3.0.9 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.0.8.html">3.0.8 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.0.7.html">3.0.7 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.0.6.html">3.0.6 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.0.3.html">3.0.3 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/3.0.html">3.0 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/2.4.html">2.4 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/2.3.4.html">2.3.4 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/2.3.3.html">2.3.3 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/2.3.2.html">2.3.2 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/2.3.html">2.3 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/2.2.html">2.2 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/2.1.html">Upgrading from 2.1.x and Django 1.2.x</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">Using django CMS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/tutorial/index.html">Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/reference/index.html">Reference for content editors</a></li>
</ul>
</li>
</ul>



      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">django cms</a>
      </nav>



      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>

          <li><a href="index.html">How-to guides</a> &raquo;</li>

    <li>Customising navigation menus</li>
      <li class="wy-breadcrumbs-aside">

          <a href="../_sources/how_to/menus.txt" rel="nofollow"> View page source</a>

      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">

  <div class="section" id="customising-navigation-menus">
<h1>Customising navigation menus<a class="headerlink" href="#customising-navigation-menus" title="Permalink to this headline">¶</a></h1>
<p>In this document we discuss three different way of customising the navigation
menus of django CMS sites.</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#integration-menus"><span>Menus</span></a>: Statically extend the menu entries</li>
<li><a class="reference internal" href="#integration-attach-menus"><span>Attach Menus</span></a>: Attach your menu to a page.</li>
<li><a class="reference internal" href="#integration-modifiers"><span>Navigation Modifiers</span></a>: Modify the whole menu tree</li>
</ol>
<div class="section" id="menus">
<span id="integration-menus"></span><h2>Menus<a class="headerlink" href="#menus" title="Permalink to this headline">¶</a></h2>
<p>Create a <code class="docutils literal"><span class="pre">cms_menus.py</span></code> in your application and write the following inside:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">menus.base</span> <span class="kn">import</span> <span class="n">Menu</span><span class="p">,</span> <span class="n">NavigationNode</span>
<span class="kn">from</span> <span class="nn">menus.menu_pool</span> <span class="kn">import</span> <span class="n">menu_pool</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>

<span class="k">class</span> <span class="nc">TestMenu</span><span class="p">(</span><span class="n">Menu</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">NavigationNode</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;sample root page&#39;</span><span class="p">),</span> <span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">NavigationNode</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;sample settings page&#39;</span><span class="p">),</span> <span class="s">&quot;/bye/&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">n3</span> <span class="o">=</span> <span class="n">NavigationNode</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;sample account page&#39;</span><span class="p">),</span> <span class="s">&quot;/hello/&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">n4</span> <span class="o">=</span> <span class="n">NavigationNode</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;sample my profile page&#39;</span><span class="p">),</span> <span class="s">&quot;/hello/world/&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n4</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nodes</span>

<span class="n">menu_pool</span><span class="o">.</span><span class="n">register_menu</span><span class="p">(</span><span class="n">TestMenu</span><span class="p">)</span>
</pre></div>
</div>
<p>If you refresh a page you should now see the menu entries from above.
The get_nodes function should return a list of
<a class="reference internal" href="../reference/api_references.html#menus.base.NavigationNode" title="menus.base.NavigationNode"><code class="xref py py-class docutils literal"><span class="pre">NavigationNode</span></code></a> instances. A
<code class="xref py py-class docutils literal"><span class="pre">NavigationNode</span></code> takes the following arguments:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">title</span></code></dt>
<dd>What the menu entry should read as</dd>
<dt><code class="docutils literal"><span class="pre">url</span></code></dt>
<dd>Link if menu entry is clicked.</dd>
<dt><code class="docutils literal"><span class="pre">id</span></code></dt>
<dd>A unique id for this menu.</dd>
<dt><code class="docutils literal"><span class="pre">parent_id=None</span></code></dt>
<dd>If this is a child of another node supply the id of the parent here.</dd>
<dt><code class="docutils literal"><span class="pre">parent_namespace=None</span></code></dt>
<dd>If the parent node is not from this menu you can give it the parent
namespace. The namespace is the name of the class. In the above example that
would be: &#8220;TestMenu&#8221;</dd>
<dt><code class="docutils literal"><span class="pre">attr=None</span></code></dt>
<dd>A dictionary of additional attributes you may want to use in a modifier or
in the template.</dd>
<dt><code class="docutils literal"><span class="pre">visible=True</span></code></dt>
<dd>Whether or not this menu item should be visible.</dd>
</dl>
<p>Additionally, each <code class="xref py py-class docutils literal"><span class="pre">NavigationNode</span></code> provides a number of methods which are
detailed in the <a class="reference internal" href="../reference/api_references.html#menus.base.NavigationNode" title="menus.base.NavigationNode"><code class="xref py py-class docutils literal"><span class="pre">NavigationNode</span></code></a> API references.</p>
<div class="section" id="customize-menus-at-runtime">
<h3>Customize menus at runtime<a class="headerlink" href="#customize-menus-at-runtime" title="Permalink to this headline">¶</a></h3>
<p>To adapt your menus according to request dependent conditions (say: anonymous /
logged in user), you can use <a class="reference internal" href="#navigation-modifiers">Navigation Modifiers</a>  or you can leverage existing
ones.</p>
<p>For example it&#8217;s possible to add <code class="docutils literal"><span class="pre">{'visible_for_anonymous':</span> <span class="pre">False}</span></code> /
<code class="docutils literal"><span class="pre">{'visible_for_authenticated':</span> <span class="pre">False}</span></code> attributes recognized by the
django CMS core <code class="docutils literal"><span class="pre">AuthVisibility</span></code> modifier.</p>
<p>Complete example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UserMenu</span><span class="p">(</span><span class="n">Menu</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="n">NavigationNode</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Profile&quot;</span><span class="p">),</span> <span class="n">reverse</span><span class="p">(</span><span class="n">profile</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;visible_for_anonymous&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">}),</span>
                <span class="n">NavigationNode</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Log in&quot;</span><span class="p">),</span> <span class="n">reverse</span><span class="p">(</span><span class="n">login</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;visible_for_authenticated&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">}),</span>
                <span class="n">NavigationNode</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Sign up&quot;</span><span class="p">),</span> <span class="n">reverse</span><span class="p">(</span><span class="n">logout</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;visible_for_authenticated&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">}),</span>
                <span class="n">NavigationNode</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Log out&quot;</span><span class="p">),</span> <span class="n">reverse</span><span class="p">(</span><span class="n">logout</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;visible_for_anonymous&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">}),</span>
            <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="attach-menus">
<span id="integration-attach-menus"></span><h2>Attach Menus<a class="headerlink" href="#attach-menus" title="Permalink to this headline">¶</a></h2>
<p>Classes that extend from <code class="xref py py-class docutils literal"><span class="pre">menus.base.Menu</span></code> always get attached to the
root. But if you want the menu to be attached to a CMS Page you can do that as
well.</p>
<p>Instead of extending from <code class="xref py py-class docutils literal"><span class="pre">Menu</span></code> you need to extend from
<code class="xref py py-class docutils literal"><span class="pre">cms.menu_bases.CMSAttachMenu</span></code> and you need to define a name. We will do
that with the example from above:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">menus.base</span> <span class="kn">import</span> <span class="n">NavigationNode</span>
<span class="kn">from</span> <span class="nn">menus.menu_pool</span> <span class="kn">import</span> <span class="n">menu_pool</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>
<span class="kn">from</span> <span class="nn">cms.menu_bases</span> <span class="kn">import</span> <span class="n">CMSAttachMenu</span>

<span class="k">class</span> <span class="nc">TestMenu</span><span class="p">(</span><span class="n">CMSAttachMenu</span><span class="p">):</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;test menu&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">NavigationNode</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;sample root page&#39;</span><span class="p">),</span> <span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">NavigationNode</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;sample settings page&#39;</span><span class="p">),</span> <span class="s">&quot;/bye/&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">n3</span> <span class="o">=</span> <span class="n">NavigationNode</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;sample account page&#39;</span><span class="p">),</span> <span class="s">&quot;/hello/&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">n4</span> <span class="o">=</span> <span class="n">NavigationNode</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;sample my profile page&#39;</span><span class="p">),</span> <span class="s">&quot;/hello/world/&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n4</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nodes</span>

<span class="n">menu_pool</span><span class="o">.</span><span class="n">register_menu</span><span class="p">(</span><span class="n">TestMenu</span><span class="p">)</span>
</pre></div>
</div>
<p>Now you can link this Menu to a page in the &#8216;Advanced&#8217; tab of the page
settings under attached menu.</p>
</div>
<div class="section" id="navigation-modifiers">
<span id="integration-modifiers"></span><h2>Navigation Modifiers<a class="headerlink" href="#navigation-modifiers" title="Permalink to this headline">¶</a></h2>
<p>Navigation Modifiers give your application access to navigation menus.</p>
<p>A modifier can change the properties of existing nodes or rearrange entire
menus.</p>
<div class="section" id="an-example-use-case">
<h3>An example use-case<a class="headerlink" href="#an-example-use-case" title="Permalink to this headline">¶</a></h3>
<p>A simple example: you have a news application that publishes pages
independently of django CMS. However, you would like to integrate the
application into the menu structure of your site, so that at appropriate
places a <em>News</em> node appears in the navigation menu.</p>
<p>In such a case, a Navigation Modifier is the solution.</p>
</div>
<div class="section" id="how-it-works">
<h3>How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h3>
<p>Normally, you&#8217;d want to place modifiers in your application&#8217;s
<code class="docutils literal"><span class="pre">cms_menus.py</span></code>.</p>
<p>To make your modifier available, it then needs to be registered with
<code class="docutils literal"><span class="pre">menus.menu_pool.menu_pool</span></code>.</p>
<p>Now, when a page is loaded and the menu generated, your modifier will
be able to inspect and modify its nodes.</p>
<p>A simple modifier looks something like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">menus.base</span> <span class="kn">import</span> <span class="n">Modifier</span>
<span class="kn">from</span> <span class="nn">menus.menu_pool</span> <span class="kn">import</span> <span class="n">menu_pool</span>

<span class="k">class</span> <span class="nc">MyMode</span><span class="p">(</span><span class="n">Modifier</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">modify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">root_id</span><span class="p">,</span> <span class="n">post_cut</span><span class="p">,</span> <span class="n">breadcrumb</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">post_cut</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nodes</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="n">node</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="n">count</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">nodes</span>

<span class="n">menu_pool</span><span class="o">.</span><span class="n">register_modifier</span><span class="p">(</span><span class="n">MyMode</span><span class="p">)</span>
</pre></div>
</div>
<p>It has a method <code class="xref py py-meth docutils literal"><span class="pre">modify()</span></code> that should return a list
of <a class="reference internal" href="../reference/api_references.html#menus.base.NavigationNode" title="menus.base.NavigationNode"><code class="xref py py-class docutils literal"><span class="pre">NavigationNode</span></code></a> instances.
<code class="xref py py-meth docutils literal"><span class="pre">modify()</span></code> should take the following arguments:</p>
<dl class="docutils">
<dt><cite>request</cite></dt>
<dd>A Django request instance. You want to modify based on sessions, or
user or permissions?</dd>
<dt><cite>nodes</cite></dt>
<dd>All the nodes. Normally you want to return them again.</dd>
<dt><cite>namespace</cite></dt>
<dd>A Menu Namespace. Only given if somebody requested a menu with only nodes
from this namespace.</dd>
<dt><cite>root_id</cite></dt>
<dd>Was a menu request based on an ID?</dd>
<dt><cite>post_cut</cite></dt>
<dd>Every modifier is called two times. First on the whole tree. After that the
tree gets cut to only show the nodes that are shown in the current menu.
After the cut the modifiers are called again with the final tree. If this is
the case <code class="docutils literal"><span class="pre">post_cut</span></code> is <code class="docutils literal"><span class="pre">True</span></code>.</dd>
<dt><cite>breadcrumb</cite></dt>
<dd>Is this not a menu call but a breadcrumb call?</dd>
</dl>
<p>Here is an example of a built-in modifier that marks all node levels:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Level</span><span class="p">(</span><span class="n">Modifier</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    marks all node levels</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">post_cut</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">modify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">root_id</span><span class="p">,</span> <span class="n">post_cut</span><span class="p">,</span> <span class="n">breadcrumb</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">breadcrumb</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nodes</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">post_cut</span><span class="p">:</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">menu_level</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mark_levels</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">post_cut</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nodes</span>

    <span class="k">def</span> <span class="nf">mark_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">post_cut</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">post_cut</span><span class="p">:</span>
                <span class="n">child</span><span class="o">.</span><span class="n">menu_level</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">menu_level</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">child</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mark_levels</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">post_cut</span><span class="p">)</span>

<span class="n">menu_pool</span><span class="o">.</span><span class="n">register_modifier</span><span class="p">(</span><span class="n">Level</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
          <footer>

    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">

        <a href="apphooks.html" class="btn btn-neutral float-right" title="Apphooks">Next <span class="fa fa-arrow-circle-right"></span></a>


        <a href="custom_plugins.html" class="btn btn-neutral" title="Custom Plugins"><span class="fa fa-arrow-circle-left"></span> Previous</a>

    </div>


  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2009-2015, Patrick Lauber.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>
        </div>
      </div>

    </section>

  </div>





    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>





    <script type="text/javascript" src="../_static/js/theme.js"></script>




  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>


</body>
</html>
