

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.1 release notes &mdash; django cms 3.1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="django cms 3.1.0 documentation" href="../index.html"/>
        <link rel="up" title="Release notes &amp; upgrade information" href="index.html"/>
        <link rel="next" title="3.0.14 release notes" href="3.0.14.html"/>
        <link rel="prev" title="3.1.1 release notes" href="3.1.1.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index.html" class="fa fa-home"> django cms</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/install.html">Installing django CMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/templates_placeholders.html">Templates &amp; Placeholders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/apphooks.html">Apphooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/third_party.html">Integrating a third-party application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/toolbar.html">Extending the Toolbar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/menu.html">Extending the navigation menu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/namespaced_apphooks.html">Namespaced Apphooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/contributing.html">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../how_to/index.html">How-to guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../how_to/install.html">Installing django CMS by hand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/custom_plugins.html">Custom Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/menus.html">Customising navigation menus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/apphooks.html">Apphooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/templates.html">Working with templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/extending_page_title.html">Extending the page &amp; title models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/toolbar.html">Extending the Toolbar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/using_south.html">Using South with django CMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/testing.html">Testing Your Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/placeholders.html">Placeholders outside the CMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/caching.html">Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/frontend_models.html">Frontend editing for Page and Django models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/sitemap.html">Sitemap Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../topics/index.html">Key topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../topics/menu_system.html">How the menu system works</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/publishing.html">Publishing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/multiple_languages.html">Serving content in multiple languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/i18n.html">Internationalisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/permissions.html">Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/commonly_used_plugins.html">Some commonly-used plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/searchdocs.html">Search and django CMS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/navigation.html">Navigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/api_references.html">API References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/fields.html">Form and model fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/templatetags.html">Template Tags</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/cli.html">Command Line Interface</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Development &amp; community</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/development.html">Development of django CMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/contributing.html">Contributing to django CMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/management.html">Code and project management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/testing.html">Running and writing tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#branch-policy">Branch policy</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Release notes &amp; upgrade information</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="3.1.1.html">3.1.1 release notes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">3.1 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.0.14.html">3.0.14 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.0.13.html">3.0.13 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.0.12.html">3.0.12 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.0.11.html">3.0.11 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.0.10.html">3.0.10 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.0.9.html">3.0.9 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.0.8.html">3.0.8 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.0.7.html">3.0.7 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.0.6.html">3.0.6 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.0.3.html">3.0.3 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.0.html">3.0 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.4.html">2.4 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.3.4.html">2.3.4 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.3.3.html">2.3.3 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.3.2.html">2.3.2 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.3.html">2.3 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.2.html">2.2 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.1.html">Upgrading from 2.1.x and Django 1.2.x</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">Using django CMS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/tutorial/index.html">Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/reference/index.html">Reference for content editors</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">django cms</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Release notes &amp; upgrade information</a> &raquo;</li>
      
    <li>3.1 release notes</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/upgrade/3.1.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="release-notes">
<span id="upgrade-to-3-1"></span><h1>3.1 release notes<a class="headerlink" href="#release-notes" title="Permalink to this headline">¶</a></h1>
<p>django CMS 3.1 has been planned largely as a consolidation release, to build on the progress made
in 3.0 and establish a safe, solid base for more ambitious work in the future.</p>
<p>In this release we have tried to maintain maximum backwards-compatibility, particularly for
third-party applications, and endeavoured to identify and tidy loose ends in the system wherever
possible.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Upgrading from previous versions</p>
<p class="last">3.1 introduces some changes that <strong>require</strong> action if you are upgrading
from a previous version. Please read <a class="reference internal" href="#upgrade-guide-3-1"><span>Upgrading django CMS 3.0 to 3.1</span></a> for a step-by-step guide to the
process of upgrading from 3.0 to 3.1.</p>
</div>
<div class="section" id="what-s-new-in-3-1">
<h2>What&#8217;s new in 3.1<a class="headerlink" href="#what-s-new-in-3-1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="switch-from-mptt-to-mp">
<h3>Switch from MPTT to MP<a class="headerlink" href="#switch-from-mptt-to-mp" title="Permalink to this headline">¶</a></h3>
<p>Since django CMS 2.0 we have relied on MPTT (Modified Preorder Tree Traversal) for efficiently
handling tree structures in the database.</p>
<p>In 3.1, <a class="reference external" href="https://github.com/django-mptt/django-mptt">Django MPTT</a> has been replaced by
<a class="reference external" href="https://github.com/tabo/django-treebeard">django-treebeard</a>, to improve performance and
reliability.</p>
<p>Over the years MPTT has proved not to be fast enough for big tree operations (&gt;1000 pages); tree
corruption, because of transactional errors, has also been a problem.</p>
<p>django-treebeard uses MP (Materialized Path). MP is more efficient and has more error resistance
then MPTT. It should make working with and using django CMS better - faster and reliable.</p>
<p>Other than this, end users should not notice any changes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>User feedback required</p>
<p class="last">We require as much feedback as possible about the performance of django-treebeard in this
release. Please let us know your experiences with it, especially if you encounter any problems.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Backward incompatible change</p>
<p class="last">While most of the low-level interface is very similar between <code class="docutils literal"><span class="pre">django-mptt</span></code> and
<code class="docutils literal"><span class="pre">django-treebeard</span></code> they are not exactly the same. If any custom code needs to make use of the
low-level interfaces of the page or plugins tree, please see the <a class="reference external" href="https://tabo.pe/projects/django-treebeard/docs/2.0/">django-treebeard
documentation</a> for information
on how to use equivalent calls in <code class="docutils literal"><span class="pre">django-treebeard</span></code>.</p>
</div>
<div class="section" id="action-required">
<h4>Action required<a class="headerlink" href="#action-required" title="Permalink to this headline">¶</a></h4>
<p>Run <a class="reference internal" href="../reference/cli.html#fix-mptt"><span>manage.py cms fix-mptt</span></a> before you upgrade.</p>
<p>Developers who use django CMS will need to run the schema and data migrations that are part of this
release. Developers of third-party applications that relied on the Django MPTT that shipped with
django CMS are advised to update their own applications so that they install it independently.</p>
</div>
</div>
<div class="section" id="dropped-support-for-django-1-4-and-1-5">
<h3>Dropped support for Django 1.4 and 1.5<a class="headerlink" href="#dropped-support-for-django-1-4-and-1-5" title="Permalink to this headline">¶</a></h3>
<p>Starting from version 3.1, django CMS runs on Django 1.6 and 1.7.</p>
<div class="section" id="id1">
<h4>Action required<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>If you&#8217;re still on an earlier version, you will need to install a newer one, and make sure that
your third-party applications are also up-to-date with it before attempting to upgrade django CMS.</p>
</div>
</div>
<div class="section" id="south-is-now-an-optional-dependency">
<h3>South is now an optional dependency<a class="headerlink" href="#south-is-now-an-optional-dependency" title="Permalink to this headline">¶</a></h3>
<p>As Django South is now required for Django 1.6 only, it&#8217;s marked as an optional dependency.</p>
<div class="section" id="id2">
<h4>Action required<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>To install South along with django CMS use <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">django-cms[south]</span></code>.</p>
</div>
</div>
<div class="section" id="migrations-moved">
<h3>Migrations moved<a class="headerlink" href="#migrations-moved" title="Permalink to this headline">¶</a></h3>
<p>Migrations directories have been renamed to conform to the new standard layout:</p>
<blockquote>
<div><ul class="simple">
<li>Django 1.7 migrations: in the default <code class="docutils literal"><span class="pre">cms/migrations</span></code> and <code class="docutils literal"><span class="pre">menus/migrations</span></code> directories</li>
<li>South migrations: in the <code class="docutils literal"><span class="pre">cms/south_migrations</span></code> and <code class="docutils literal"><span class="pre">menus/south_migrations</span></code> directories</li>
</ul>
</div></blockquote>
<div class="section" id="id3">
<h4>Action required<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>South 1.0.2 or newer is required to handle the new layout correctly, so make sure you have that
installed.</p>
<p>If you are upgrading from django CMS 3.0.x running on Django 1.7 you need to remove the old
migration path from <a class="reference external" href="https://docs.djangoproject.com/en/1.7/ref/settings/#migration-modules">MIGRATION_MODULES</a> settings.</p>
</div>
</div>
<div class="section" id="plugins-migrations-moving-process">
<h3>Plugins migrations moving process<a class="headerlink" href="#plugins-migrations-moving-process" title="Permalink to this headline">¶</a></h3>
<p>Core plugins are being changeed to follow the new convention for the migration modules, starting
with <strong>djangocms_text_ckeditor</strong> 2.5 released together with django CMS 3.1.</p>
<div class="section" id="id4">
<h4>Action required<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Check the readme file of each plugin when upgrading to know the actions required.</p>
</div>
</div>
<div class="section" id="structure-mode-permission">
<h3>Structure mode permission<a class="headerlink" href="#structure-mode-permission" title="Permalink to this headline">¶</a></h3>
<p>A new <a class="reference internal" href="../topics/permissions.html"><em>Can use Structure mode* permission</em></a> has been added.</p>
<p>Without this permission, a non-superuser will no longer have access to structure mode. This makes
possible a more strict workflow, in which certain users are able to edit content but not structure.</p>
<p>This change includes a data migration that adds the new permission to any staff user or group with
<code class="docutils literal"><span class="pre">cms.change_page</span></code> permission.</p>
<div class="section" id="id5">
<h4>Action required<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>You may need to adjust these permissions once you have completed migrating your database.</p>
<p>Note that if you have existing users in your database, but are installing django CMS and running
its migrations for the first time, you will need to grant them these permissions - they will not
acquire them automatically.</p>
</div>
</div>
<div class="section" id="simplified-loading-of-view-restrictions-in-the-menu">
<h3>Simplified loading of view restrictions in the menu<a class="headerlink" href="#simplified-loading-of-view-restrictions-in-the-menu" title="Permalink to this headline">¶</a></h3>
<p>The system that loads page view restrictions into the menu has been improved, simplifying the
queries that are generated, in order to make it faster.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>User feedback required</p>
<p class="last">We require as much feedback as possible about the performance of this feature in this
release. Please let us know your experiences with it, especially if you encounter any problems.</p>
</div>
</div>
<div class="section" id="toolbar-api-extension">
<h3>Toolbar API extension<a class="headerlink" href="#toolbar-api-extension" title="Permalink to this headline">¶</a></h3>
<p>The toolbar API has been extended to permit more powerful use of it in future development,
including the use of &#8220;clipboard-like&#8221; items.</p>
<p>For an example of how this can be used, see the new
<a class="reference external" href="https://github.com/aldryn/aldryn-blueprint/">Aldryn Blueprint</a> application.</p>
</div>
<div class="section" id="per-namespace-apphook-configuration">
<h3>Per-namespace apphook configuration<a class="headerlink" href="#per-namespace-apphook-configuration" title="Permalink to this headline">¶</a></h3>
<p>django CMS provides a new API to define namespaced <a class="reference internal" href="../how_to/apphooks.html"><em>Apphook</em></a> configurations.</p>
<p><a class="reference external" href="https://github.com/aldryn/aldryn-apphooks-config">Aldryn Apphooks Config</a> has
been created and released as a standard implementation to take advantage
of this, but other implementations can be developed.</p>
</div>
<div class="section" id="improvements-to-the-toolbar-user-interface">
<h3>Improvements to the toolbar user interface<a class="headerlink" href="#improvements-to-the-toolbar-user-interface" title="Permalink to this headline">¶</a></h3>
<p>Some minor changes have been implemented to improve the toolbar user interface.
The old <strong>Draft/Live</strong> switch has been replaced to achieve a more clear
distinction between page states, and <strong>Edit</strong> and <strong>Save as draft</strong> buttons are now
available in the toolbar to control the page editing workflow.</p>
</div>
<div class="section" id="placeholder-language-fallback-default-to-true">
<h3>Placeholder language fallback default to True<a class="headerlink" href="#placeholder-language-fallback-default-to-true" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">language_fallback</span></code> in <a class="reference internal" href="../reference/configuration.html#std:setting-CMS_PLACEHOLDER_CONF"><code class="xref std std-setting docutils literal"><span class="pre">CMS_PLACEHOLDER_CONF</span></code></a> is <code class="docutils literal"><span class="pre">True</span></code> by default.</p>
</div>
<div class="section" id="new-templatetags">
<h3>New templatetags<a class="headerlink" href="#new-templatetags" title="Permalink to this headline">¶</a></h3>
<div class="section" id="render-model-add-block">
<h4><code class="docutils literal"><span class="pre">render_model_add_block</span></code><a class="headerlink" href="#render-model-add-block" title="Permalink to this headline">¶</a></h4>
<p>The family of <a class="reference internal" href="../how_to/frontend_models.html#render-model-templatetags"><span>render_model</span></a> templatetags that allow Django
developers to make any Django model editable in the frontend has been extended with
<a class="reference internal" href="../reference/templatetags.html#std:templatetag-render_model_add_block"><code class="xref std std-ttag docutils literal"><span class="pre">render_model_add_block</span></code></a>, which can offer arbitrary markup as the <em>Edit</em> icon (rather than
just an image as previously).</p>
</div>
<div class="section" id="render-plugin-block">
<h4><code class="docutils literal"><span class="pre">render_plugin_block</span></code><a class="headerlink" href="#render-plugin-block" title="Permalink to this headline">¶</a></h4>
<p>Some user interfaces have some plugins hidden from display in edit/preview mode.
<a class="reference internal" href="../reference/templatetags.html#std:templatetag-render_plugin_block"><code class="xref std std-ttag docutils literal"><span class="pre">render_plugin_block</span></code></a> provides a way to expose them for editing, and also more generally
provides an alternative means of triggering a plugin&#8217;s change form.</p>
</div>
</div>
<div class="section" id="plugin-table-naming">
<h3>Plugin table naming<a class="headerlink" href="#plugin-table-naming" title="Permalink to this headline">¶</a></h3>
<p>Old-style plugin table names (for example, <code class="docutils literal"><span class="pre">cmsplugin_&lt;plugin</span> <span class="pre">name&gt;</span></code> are no longer
supported. Relevant code has been removed.</p>
<div class="section" id="id6">
<h4>Action required<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>Any plugin table name must be migrated to the standard (<code class="docutils literal"><span class="pre">&lt;application</span> <span class="pre">name&gt;_&lt;table</span> <span class="pre">name&gt;</span></code> layout.</p>
</div>
</div>
<div class="section" id="cms-context-processors-media-replaced-by-cms-context-processors-cms-settings">
<h3><code class="docutils literal"><span class="pre">cms.context_processors.media</span></code> replaced by <code class="docutils literal"><span class="pre">cms.context_processors.cms_settings</span></code><a class="headerlink" href="#cms-context-processors-media-replaced-by-cms-context-processors-cms-settings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id7">
<h4>Action required<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>Replace the <code class="docutils literal"><span class="pre">cms.context_processors.media</span></code> with <code class="docutils literal"><span class="pre">cms.context_processors.cms_settings</span></code> in
<code class="docutils literal"><span class="pre">settings.py</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="upgrading-django-cms-3-0-to-3-1">
<span id="upgrade-guide-3-1"></span><h2>Upgrading django CMS 3.0 to 3.1<a class="headerlink" href="#upgrading-django-cms-3-0-to-3-1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="preliminary-steps">
<h3>Preliminary steps<a class="headerlink" href="#preliminary-steps" title="Permalink to this headline">¶</a></h3>
<p>Before upgrading, please make sure that your current database is consistent and in a healthy state.</p>
<p>To ensure this, run two commands:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">cms</span> <span class="pre">delete_orphaned_plugins</span></code></li>
<li><code class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">cms</span> <span class="pre">fix-mptt</span></code></li>
</ul>
<p><strong>Make a copy of the database before proceeding further.</strong></p>
</div>
<div class="section" id="settings-update">
<h3>Settings update<a class="headerlink" href="#settings-update" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Change <code class="docutils literal"><span class="pre">cms.context_processors.media</span></code> to <code class="docutils literal"><span class="pre">cms.context_processors.cms_settings</span></code> in
<code class="docutils literal"><span class="pre">TEMPLATE_CONTEXT_PROCESSORS</span></code>.</li>
<li>Add <code class="docutils literal"><span class="pre">treebeard</span></code> to <code class="docutils literal"><span class="pre">INSTALLED_APPS</span></code>, and remove <code class="docutils literal"><span class="pre">mptt</span></code> if not required by other
applications.</li>
<li>If using Django 1.7 remove <code class="docutils literal"><span class="pre">cms</span></code> and <code class="docutils literal"><span class="pre">menus</span></code> from <code class="docutils literal"><span class="pre">MIGRATION_MODULES</span></code> to support
the new migration layout.</li>
<li>If migrating from Django 1.6 and below to Django 1.7, remove <code class="docutils literal"><span class="pre">south</span></code> from <code class="docutils literal"><span class="pre">installed_apps</span></code>.</li>
<li>Eventually set <code class="docutils literal"><span class="pre">language_fallback</span></code> to <code class="docutils literal"><span class="pre">False</span></code> in <a class="reference internal" href="../reference/configuration.html#std:setting-CMS_PLACEHOLDER_CONF"><code class="xref std std-setting docutils literal"><span class="pre">CMS_PLACEHOLDER_CONF</span></code></a> if you do
not want language fallback behavior for placeholders.</li>
</ul>
</div>
<div class="section" id="update-the-database">
<h3>Update the database<a class="headerlink" href="#update-the-database" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Rename the custom plugin table names, either by applying relevant migrations (if any) or
renaming the tables manually;</p>
</li>
<li><p class="first">The migration for MPTT to <code class="docutils literal"><span class="pre">django-treebeard</span></code> is handled by the django CMS migrations,
thus apply migrations to update your database:</p>
<div class="highlight-python"><div class="highlight"><pre>python manage.py migrate
</pre></div>
</div>
</li>
</ul>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="3.0.14.html" class="btn btn-neutral float-right" title="3.0.14 release notes">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="3.1.1.html" class="btn btn-neutral" title="3.1.1 release notes"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2009-2015, Patrick Lauber.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>