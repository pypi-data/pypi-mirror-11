
=====================================
**tlu** - trigger logic unit
=====================================

EUDAQ Telescope/TLU communication module. Received IDs are propagated to FIFO data interface.

NOTE:
 1. TRIGGER_ENABLE has to be asserted to allow triggering.
 2. If no TRIGGER_ACKNOWLEDGE signal is available, connect TRIGGER_ACCEPTED_FLAG output to TRIGGER_ACKNOWLEDGE input.
 3. TRIGGER_ENABLE and TRIGGER_ACKNOWLEDGE needs to be synchronous to TRIGGER_CLOCK.
 4. Data words have the MSB always high to allow identification of data words. The remaining 31 bits are data.
 5. All selected trigger inputs (TRIGGER) are ORed
 6. All selected trigger veto inputs (TRIGGER_VETO) are ORed (and enabled by default)

**Unit test/Example:** 
`test_SimTlu.v <https://github.com/SiLab-Bonn/basil/blob/master/host/tests/test_SimTlu.v>`_ 
`test_SimTlu.py <https://github.com/SiLab-Bonn/basil/blob/master/host/tests/test_SimTlu.py>`_

Parameters
    +--------------+---------------------+-------------------------------------------------------------------------+ 
    | Name         | Default             | Description                                                             | 
    +==============+=====================+=========================================================================+ 
    | DIVISOR      | 8                   | Defines TLU clock speed. TLU clock is divided by Divisor.               | 
    +--------------+---------------------+-------------------------------------------------------------------------+ 

Pins
    +--------------------------+---------------------+-----------------------+------------------------------------------------------+ 
    | Name                     | Size                | Direction             | Description                                          | 
    +==========================+=====================+=======================+======================================================+ 
    | TRIGGER_CLOCK            | 1                   |  input                | clock for module                                     | 
    +--------------------------+---------------------+-----------------------+------------------------------------------------------+ 
    | TRIGGER                  | 8                   |  input (async)        | extenel trigger                                      | 
    +--------------------------+---------------------+-----------------------+------------------------------------------------------+ 
    | TRIGGER_VETO             | 8                   |  input (async)        | external veto                                        | 
    +--------------------------+---------------------+-----------------------+------------------------------------------------------+ 
    | TRIGGER_ENABLE           | 1                   |  input (sync)         | trigger enable input                                 | 
    +--------------------------+---------------------+-----------------------+------------------------------------------------------+ 
    | TRIGGER_ACKNOWLEDGE      | 1                   |  input (sync)         | signal from external devices/modules if ready        | 
    +--------------------------+---------------------+-----------------------+------------------------------------------------------+ 
    | TRIGGER_ACCEPTED_FLAG    | 1                   |  output               | flag for trigger is valid and was accepted           | 
    +--------------------------+---------------------+-----------------------+------------------------------------------------------+ 
    | TLU_TRIGGER              | 1                   |  input (async)        | TLU trigger input                                    | 
    +--------------------------+---------------------+-----------------------+------------------------------------------------------+ 
    | TLU_RESET                | 1                   |  input (async)        | TLU reset input                                      | 
    +--------------------------+---------------------+-----------------------+------------------------------------------------------+
    | TLU_BUSY                 | 1                   |  output               | TLU busy output                                      | 
    +--------------------------+---------------------+-----------------------+------------------------------------------------------+
    | TLU_CLOCK                | 1                   |  output               | TLU clock output                                     | 
    +--------------------------+---------------------+-----------------------+------------------------------------------------------+ 
    | TIMESTAMP                | 32                  |  output               | timestamp counter for external devices/modules       | 
    +--------------------------+---------------------+-----------------------+------------------------------------------------------+ 
Registers
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | Name                       | Address                          | Bits   | r/w   | Default     | Description                                 | 
    +============================+==================================+========+=======+=============+=============================================+ 
    | RESET                      | 0                                |        | wo    |             | reset                                       | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | VERSION                    | 0                                | [7:0]  | ro    | 0           | version                                     | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | TRIGGER_MODE               | 1                                | [1:0]  | r/w   | 0           | external/TLU trigger mode                   | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | TRIGGER_DATA_MSB_FIRST     | 1                                | [2]    | r/w   | 0           | TLU trigger number MSB                      | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | TRIGGER_DATA_DELAY         | 1                                | [7:4]  | r/w   | 0           | additional TLU data delay for longer cables | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | TRIGGER_CLOCK_CYCLES       | 2                                | [4:0]  | r/w   | 0           | TLU trigger number clocks(0=32 clock cycles)| 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | EN_TLU_RESET_TIMESTAMP     | 2                                | [5]    | r/w   | 0           | reset time stamp to 0 on TLU reset          | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | EN_TLU_VETO                | 2                                | [6]    | r/w   | 0           | assert TLU veto when external veto          | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | EN_WRITE_TIMESTAMP         | 2                                | [7]    | r/w   | 0           | write time stamp instead trigger counter    | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | TRIGGER_LOW_TIMEOUT        | 3                                | [7:0]  | r/w   | 255         | max. wait cycles for TLU trigger low (0=off)| 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | CURRENT_TLU_TRIGGER_NUMBER | 7 - 4                            | [31:0] | ro    |             | latest TLU trigger number                   | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | TRIGGER_COUNTER            | 11 - 8                           | [31:0] | r/w   | 0           | trigger counter value                       | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | LOST_DATA_COUNTER          | 12                               | [7:0]  | ro    |             | lost data counter                           | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+
    | TRIGGER_SELECT             | 13                               | [7:0]  | r/w   | 0           | selecting trigger input                     | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+
    | TRIGGER_VETO_SELECT        | 14                               | [7:0]  | r/w   | 255         | selecting veto input                        | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | TRIGGER_INVERT             | 15                               | [7:0]  | r/w   | 0           | selecting trigger invert                    | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    | MAX_TRIGGERS               | 16 - 19                          | [31:0] | r/w   | 0           | maximum triggers, use 0 for unltd. triggers | 
    +----------------------------+----------------------------------+--------+-------+-------------+---------------------------------------------+ 
    