<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Testing the code &mdash; ASE  documentation</title>
    <link rel="stylesheet" href="../_static/ase.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/ase.ico"/>
    <link rel="contents" title="Global table of contents" href="../contents.html" />
    <link rel="index" title="Global index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="ASE  documentation" href="../index.html" />
    <link rel="up" title="ASE development" href="development.html" />
    <link rel="next" title="Buildbot" href="buildbot.html" />
    <link rel="prev" title="New release" href="newrelease.html" />
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>



        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>



        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             accesskey="">modules</a> |</li>
        <a href="../index.html"><img class="logo" src="../_static/ase.ico" alt="Logo" align="absmiddle"/></a>
          <li><a href="development.html" accesskey="U">ASE development</a> &raquo;</li>
      </ul>
    </div>
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="module-ase.test"></span><div class="section" id="testing-the-code">
<h1>Testing the code<a class="headerlink" href="#testing-the-code" title="Permalink to this headline">¶</a></h1>
<p>All additions and modifications to ASE should be tested.</p>
<p id="index-0">Test scripts should be put in the <a class="reference external" href="http://trac.fysik.dtu.dk/projects/ase/browser/trunk/ase/test">ase/test</a> directory.
Run all tests with:</p>
<div class="highlight-python"><div class="highlight"><pre>python -c &quot;from ase.test import test; test(2)&quot;
</pre></div>
</div>
<p>It is using the function:</p>
<dl class="function">
<dt id="ase.test.test.test">
<tt class="descclassname">test.</tt><tt class="descname">test</tt><big>(</big><em>verbosity=1</em>, <em>dir=None</em><big>)</big><a class="headerlink" href="#ase.test.test.test" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the test scripts in <a class="reference external" href="http://trac.fysik.dtu.dk/projects/ase/browser/trunk/ase/test">ase/test</a>.</p>
</dd></dl>

<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">When you fix a bug, add a test to the test suite checking that it is
truly fixed.  Bugs sometimes come back, do not give it a second
chance!</p>
</div>
<div class="section" id="how-to-fail-successfully">
<h2>How to fail successfully<a class="headerlink" href="#how-to-fail-successfully" title="Permalink to this headline">¶</a></h2>
<p>The test suite provided by <a class="reference internal" href="#ase.test.test.test" title="ase.test.test.test"><tt class="xref py py-func docutils literal"><span class="pre">test.test()</span></tt></a> automatically runs all test
scripts in the <a class="reference external" href="http://trac.fysik.dtu.dk/projects/ase/browser/trunk/ase/test">ase/test</a> directory and summarizes the results.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Test scripts are run from within Python using the <a class="reference external" href="http://docs.python.org/2.7/library/functions.html#execfile" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">execfile()</span></tt></a> function.
Among other things, this provides the test scripts with an specialized global
<a class="reference internal" href="../glossary.html#term-namespace"><em class="xref std std-term">namespace</em></a>, which means they may fail or behave differently if you try
to run them directly e.g. using <strong class="command">python testscript.py</strong>.</p>
</div>
<p>If a test script causes an exception to be thrown, or otherwise terminates
in an unexpected way, it will show up in this summary. This is the most
effective way of raising awareness about emerging conflicts and bugs during
the development cycle of the <a class="reference internal" href="../download.html#latest-development-release"><em>latest revision</em></a>.</p>
<p>Remember, great tests should serve a dual purpose:</p>
<dl class="docutils">
<dt><strong>Working interface</strong></dt>
<dd>To ensure that the <a class="reference internal" href="../glossary.html#term-class"><em class="xref std std-term">class</em></a>&#8216;es and <a class="reference internal" href="../glossary.html#term-method"><em class="xref std std-term">method</em></a>&#8216;s in ASE are
functional and provide the expected interface. Empirically speaking, code
which is not covered by a test script tends to stop working over time.</dd>
<dt><strong>Replicable results</strong></dt>
<dd>Even if a calculation makes it to the end without crashing, you can never
be too sure that the numerical results are consistent. Don&#8217;t just assume
they are, <a class="reference internal" href="#ase.test.assert" title="ase.test.assert"><tt class="xref py py-func docutils literal"><span class="pre">assert()</span></tt></a> it!</dd>
</dl>
<dl class="function">
<dt id="ase.test.assert">
<tt class="descclassname">ase.test.</tt><tt class="descname">assert</tt><big>(</big><em>expression</em><big>)</big><a class="headerlink" href="#ase.test.assert" title="Permalink to this definition">¶</a></dt>
<dd><p>Raises an <tt class="docutils literal"><span class="pre">AssertionError</span></tt> if the <tt class="docutils literal"><span class="pre">expression</span></tt> does not
evaluate to <tt class="docutils literal"><span class="pre">True</span></tt>.</p>
</dd></dl>

<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ase</span> <span class="kn">import</span> <span class="n">molecule</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">molecule</span><span class="p">(</span><span class="s">&#39;C60&#39;</span><span class="p">)</span>
<span class="n">atoms</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">vacuum</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">expected</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">atoms</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="mf">1e-4</span>
<span class="k">assert</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">result</span> <span class="o">-</span> <span class="n">expected</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<p>Using functions to repeat calculations with different parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">parameter</span><span class="p">):</span>
    <span class="c"># setup atoms here...</span>
    <span class="n">atoms</span><span class="o">.</span><span class="n">set_something</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
    <span class="c"># calculations here...</span>
    <span class="k">assert</span> <span class="n">everything_is_going_to_be_alright</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;__main__&#39;</span><span class="p">,</span> <span class="s">&#39;__builtin__&#39;</span><span class="p">]:</span>
    <span class="n">test</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">test</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">test</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Unlike normally, the module <em>__name__</em> will be set to <tt class="docutils literal"><span class="pre">'__builtin__'</span></tt>
when a test script is run by the test suite.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">

          <h3>ASE</h3>
          <ul class="this-page-menu">
            <li><a href="../overview.html">
              Overview</a></li>
            <li><a href="../download.html">
              Installation</a></li>
            <li><a href="../tutorials/tutorials.html">
              Tutorials</em></a></li>
            <li><a href="../ase/ase.html">
              Documentation</a></li>
            <li><a href="../faq.html">FAQ</a></li>
            <li><a href="../mailinglists.html">Mailing lists</a></li>
            <li><a href="releasenotes.html">Release notes</a></li>
            <li><a href="../licenseinfo.html">License info</a></li>
           </ul>
           <h3>Development</h3>
           <ul class="this-page-menu">
            <li><a href="development.html">
              Development</a></li>
            <li><a href="http://wiki.fysik.dtu.dk/ase/epydoc/ase-module.html">
              Epydoc</a></li>
            <li><a href="http://trac.fysik.dtu.dk/projects/ase/browser/trunk/">
              Source code (svn)</a></li>
            <li><a href="../bugs.html">Bugs!</a></li>
            <li><a href="http://trac.fysik.dtu.dk/projects/ase/report/1">
              Bug Tracker</a></li>
            <li><a href="https://ase-buildbot.fysik.dtu.dk/waterfall">
              BuildBot</a></li>
          </ul>
            <h3>This Page</h3>
            <ul>
<li><a class="reference internal" href="#">Testing the code</a><ul>
<li><a class="reference internal" href="#how-to-fail-successfully">How to fail successfully</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="newrelease.html" title="previous chapter">New release</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="buildbot.html" title="next chapter">Buildbot</a></p>
            <ul class="this-page-menu">
              <li><a href="../_sources/development/tests.txt">Show Source</a></li>
            </ul>
            <h3>Quick search</h3>
            <form class="search" action="../search.html" method="get">
              <input type="text" name="q" size="18" /> <input type="submit" value="Go" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>



        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>



        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             accesskey="">modules</a> |</li>
        <a href="../index.html"><img class="logo" src="../_static/ase.ico" alt="Logo" align="absmiddle"/></a>
          <li><a href="development.html" accesskey="U">ASE development</a> &raquo;</li>
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2015, CAMd.
      Last updated on Tue, 21 Jul 2015 11:00:40.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>