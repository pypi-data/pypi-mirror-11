<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Manipulating atoms &mdash; ASE  documentation</title>
    <link rel="stylesheet" href="../_static/ase.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/ase.ico"/>
    <link rel="contents" title="Global table of contents" href="../contents.html" />
    <link rel="index" title="Global index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="ASE  documentation" href="../index.html" />
    <link rel="up" title="Tutorials" href="tutorials.html" />
    <link rel="next" title="Atomization energy" href="atomization.html" />
    <link rel="prev" title="Introduction: Nitrogen on copper" href="surface.html" />
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>



        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>



        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             accesskey="">modules</a> |</li>
        <a href="../index.html"><img class="logo" src="../_static/ase.ico" alt="Logo" align="absmiddle"/></a>
          <li><a href="tutorials.html" accesskey="U">Tutorials</a> &raquo;</li>
      </ul>
    </div>
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="manipulating-atoms">
<span id="atommanip"></span><h1>Manipulating atoms<a class="headerlink" href="#manipulating-atoms" title="Permalink to this headline">¶</a></h1>
<p><strong>XXX rewrite this:  use fcc111() function and do some relaxation ...</strong></p>
<p>We will set up a one layer slab of Ni atoms with one Ag adatom.</p>
<p>Define the slab atoms:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ase</span> <span class="kn">import</span> <span class="n">Atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span> <span class="o">=</span> <span class="n">Atoms</span><span class="p">(</span><span class="s">&#39;Ni4&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>                      <span class="p">(</span><span class="mf">0.45</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>                      <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>                      <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
</pre></div>
</div>
<p>Have a look at the individual atoms:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Atom(&#39;Ni&#39;, [0.0, 0.0, 0.0], atoms=..., index=0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">Atom(&#39;Ni&#39;, [0.45, 0.0, 0.0], atoms=..., index=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">Atom(&#39;Ni&#39;, [0.0, 0.5, 0.0], atoms=..., index=2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">Atom(&#39;Ni&#39;, [0.5, 0.5, 0.0], atoms=..., index=3)</span>
</pre></div>
</div>
<p>Let us assume we forgot how many atoms we set up:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;&gt;&gt; atoms[4]
Traceback (most recent call last):
File &quot;&lt;stdin&gt;&quot;, line 1, in ?
IndexError: list index out of range
</pre></div>
</div>
<p>Wrong because we only have four atoms</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Change the position of the 2nd atom in the list</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
<span class="go">array([[ 0. ,  0. ,  0. ],</span>
<span class="go">       [ 0.5,  0. ,  0. ],</span>
<span class="go">       [ 0. ,  0.5,  0. ],</span>
<span class="go">       [ 0.5,  0.5,  0. ]])</span>
</pre></div>
</div>
<p>What is the unit cell so far?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span>
<span class="go">array([[ 1.,  0.,  0.],</span>
<span class="go">       [ 0.,  1.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.]])</span>
</pre></div>
</div>
<p>Now, setup a p(2x2) cell in a hexagonal surface.
Here, <em>a</em> is the fcc lattice constant, the cell is 10 layers high:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">3.55</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">3.</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.</span><span class="p">)</span><span class="o">/</span><span class="mf">3.</span><span class="o">*</span><span class="n">a</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span>
<span class="go">[(5.0204581464244864, 0, 0),</span>
<span class="go">(2.5102290732122432, 4.3478442934401409, 0),</span>
<span class="go">(0, 0, 20.495934556231713)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span><span class="o">.</span><span class="n">set_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">scale_atoms</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The argument <em>scale_atoms=True</em> indicates that the atomic positions should be
scaled with the unit cell. The default is <em>scale_atoms=False</em> indicating that
the cartesian coordinates remain the same when the cell is changed.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
<span class="go">array([[ 0.        ,  0.        ,  0.        ],</span>
<span class="go">       [ 2.51022907,  0.        ,  0.        ],</span>
<span class="go">       [ 1.25511454,  2.17392215,  0.        ],</span>
<span class="go">       [ 3.76534361,  2.17392215,  0.        ]])</span>
</pre></div>
</div>
<p>Plot the whole system by bringing up the <a class="reference internal" href="../ase/gui/gui.html#module-ase.gui" title="ase.gui: Simple graphical user-interface for ASE."><tt class="xref py py-mod docutils literal"><span class="pre">ase.gui</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ase.visualize</span> <span class="kn">import</span> <span class="n">view</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/a11.png"><img alt="../_images/a11.png" src="../_images/a11.png" style="width: 64.4px; height: 162.4px;" /></a>
<p>Within the viewer (called <a class="reference internal" href="../ase/gui/gui.html#module-ase.gui" title="ase.gui: Simple graphical user-interface for ASE."><tt class="xref py py-mod docutils literal"><span class="pre">ase-gui</span></tt></a>) it is possible to repeat
the unit cell in all three directions (using the <em class="menuselection">Repeat ‣
View</em> window).</p>
<a class="reference internal image-reference" href="../_images/a21.png"><img alt="../_images/a21.png" src="../_images/a21.png" style="width: 156.45px; height: 185.5px;" /></a>
<p>We now add an adatom.  Since the supercell is now declared as the unit
cell for our atoms we can either add the atom using its cartesian
coordinates in Angstrom or rescale the unit cell and use scaled
coordinates. We try the latter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ase</span> <span class="kn">import</span> <span class="n">Atom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyzcell</span> <span class="o">=</span> <span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c"># The 3x3 unit matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span><span class="o">.</span><span class="n">set_cell</span><span class="p">(</span><span class="n">xyzcell</span><span class="p">,</span> <span class="n">scale_atoms</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># Set the unit cell and rescale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Atom</span><span class="p">(</span><span class="s">&#39;Ni&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span><span class="o">.</span><span class="n">set_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">scale_atoms</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># Set the unit cell and scale back</span>
</pre></div>
</div>
<p>The structure now looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/a31.png"><img alt="../_images/a31.png" src="../_images/a31.png" style="width: 156.45px; height: 98.0px;" /></a>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">

          <h3>ASE</h3>
          <ul class="this-page-menu">
            <li><a href="../overview.html">
              Overview</a></li>
            <li><a href="../download.html">
              Installation</a></li>
            <li><a href="tutorials.html">
              Tutorials</em></a></li>
            <li><a href="../ase/ase.html">
              Documentation</a></li>
            <li><a href="../faq.html">FAQ</a></li>
            <li><a href="../mailinglists.html">Mailing lists</a></li>
            <li><a href="../development/releasenotes.html">Release notes</a></li>
            <li><a href="../licenseinfo.html">License info</a></li>
           </ul>
           <h3>Development</h3>
           <ul class="this-page-menu">
            <li><a href="../development/development.html">
              Development</a></li>
            <li><a href="http://wiki.fysik.dtu.dk/ase/epydoc/ase-module.html">
              Epydoc</a></li>
            <li><a href="http://trac.fysik.dtu.dk/projects/ase/browser/trunk/">
              Source code (svn)</a></li>
            <li><a href="../bugs.html">Bugs!</a></li>
            <li><a href="http://trac.fysik.dtu.dk/projects/ase/report/1">
              Bug Tracker</a></li>
            <li><a href="https://ase-buildbot.fysik.dtu.dk/waterfall">
              BuildBot</a></li>
          </ul>
            <h4>Previous topic</h4>
            <p class="topless"><a href="surface.html" title="previous chapter">Introduction: Nitrogen on copper</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="atomization.html" title="next chapter">Atomization energy</a></p>
            <ul class="this-page-menu">
              <li><a href="../_sources/tutorials/manipulating_atoms.txt">Show Source</a></li>
            </ul>
            <h3>Quick search</h3>
            <form class="search" action="../search.html" method="get">
              <input type="text" name="q" size="18" /> <input type="submit" value="Go" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>



        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>



        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             accesskey="">modules</a> |</li>
        <a href="../index.html"><img class="logo" src="../_static/ase.ico" alt="Logo" align="absmiddle"/></a>
          <li><a href="tutorials.html" accesskey="U">Tutorials</a> &raquo;</li>
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2015, CAMd.
      Last updated on Tue, 21 Jul 2015 11:00:40.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>