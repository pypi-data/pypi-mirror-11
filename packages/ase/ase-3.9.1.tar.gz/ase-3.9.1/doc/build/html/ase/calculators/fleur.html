<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>FLEUR &mdash; ASE  documentation</title>
    <link rel="stylesheet" href="../../_static/ase.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../../',
          VERSION:     '',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/ase.ico"/>
    <link rel="contents" title="Global table of contents" href="../../contents.html" />
    <link rel="index" title="Global index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="top" title="ASE  documentation" href="../../index.html" />
    <link rel="up" title="Calculators" href="calculators.html" />
    <link rel="next" title="Gromacs" href="gromacs.html" />
    <link rel="prev" title="FHI-aims" href="FHI-aims.html" />
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>



        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>



        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             accesskey="">modules</a> |</li>
        <a href="../../index.html"><img class="logo" src="../../_static/ase.ico" alt="Logo" align="absmiddle"/></a>
          <li><a href="../ase.html" accesskey="U">Documentation for modules in ASE</a> &raquo;</li>
          <li><a href="calculators.html" accesskey="U">Calculators</a> &raquo;</li>
      </ul>
    </div>
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="module-ase.calculators.fleur"></span><div class="section" id="fleur">
<h1>FLEUR<a class="headerlink" href="#fleur" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://www.flapw.de">FLEUR</a> is a density-functional theory code which uses the full
potential linearized augmented plane-wave (FLAPW) method. <a class="reference external" href="http://www.flapw.de">FLEUR</a> can
be applied to any element in the periodic table, and the code is well
suited especially to surfaces and magnetic materials.</p>
</div>
<div class="section" id="environment-variables">
<h2>Environment variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h2>
<p>In order to use FLEUR through ASE, two environment variables have to
be set. <span class="target" id="index-0"></span><tt class="xref std std-envvar docutils literal"><span class="pre">FLEUR_INPGEN</span></tt> should point to the simple input
generator of FLEUR, and <span class="target" id="index-1"></span><tt class="xref std std-envvar docutils literal"><span class="pre">FLEUR</span></tt> to the actual executable. Note
that FLEUR has different executables e.g. for cases with and without
inversion symmetry, so the environment variable has to be set accordingly.
As an example, the variables could be set like:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">export </span><span class="nv">FLEUR_INPGEN</span><span class="o">=</span><span class="nv">$HOME</span>/fleur/v25/inpgen.x
<span class="nv">$ </span><span class="nb">export </span><span class="nv">FLEUR</span><span class="o">=</span><span class="nv">$HOME</span>/fleur/v25/fleur.x
</pre></div>
</div>
<p>or:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">export </span><span class="nv">FLEUR</span><span class="o">=</span><span class="s2">&quot;mpirun -np 32 </span><span class="nv">$HOME</span><span class="s2">/fleur/v25/fleur.x&quot;</span>
</pre></div>
</div>
<p>for parallel calculations.</p>
</div>
<div class="section" id="fleur-calculator">
<h2>FLEUR Calculator<a class="headerlink" href="#fleur-calculator" title="Permalink to this headline">¶</a></h2>
<p>Currently, limited number of FLEUR parameters can be set via the ASE interface
Below follows a list of supported parameters</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="14%" />
<col width="21%" />
<col width="42%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">keyword</th>
<th class="head">type</th>
<th class="head">default value</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">xc</span></tt></td>
<td><tt class="docutils literal"><span class="pre">str</span></tt></td>
<td><tt class="docutils literal"><span class="pre">'LDA'</span></tt></td>
<td>XC-functional. Must be one
of &#8216;LDA&#8217;, &#8216;PBE&#8217;, &#8216;RPBE&#8217;</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">kpts</span></tt></td>
<td><em>seq</em></td>
<td><span class="math">\(\Gamma\)</span>-point</td>
<td><strong>k</strong>-point sampling</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">convergence</span></tt></td>
<td><em>dict</em></td>
<td><tt class="docutils literal"><span class="pre">{'energy':</span>
<span class="pre">0.0001}</span></tt></td>
<td>Convergence criteria (meV)</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">width</span></tt></td>
<td><tt class="docutils literal"><span class="pre">float</span></tt></td>
<td>&nbsp;</td>
<td>Width of Fermi smearing (eV)</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">kmax</span></tt></td>
<td><tt class="docutils literal"><span class="pre">float</span></tt></td>
<td>&nbsp;</td>
<td>Plane-wave cut-off (a.u.)</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">mixer</span></tt></td>
<td><em>dict</em></td>
<td>&nbsp;</td>
<td>Mixing parameters &#8216;imix&#8217;,
&#8216;alpha&#8217;, and &#8216;spinf&#8217;</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">maxiter</span></tt></td>
<td><tt class="docutils literal"><span class="pre">int</span></tt></td>
<td>40</td>
<td>Maximum number of SCF steps</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">maxrelax</span></tt></td>
<td><tt class="docutils literal"><span class="pre">int</span></tt></td>
<td>20</td>
<td>Maximum number of relaxation
steps</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">workdir</span></tt></td>
<td><tt class="docutils literal"><span class="pre">str</span></tt></td>
<td>Current dir</td>
<td>Working directory for the
calculation</td>
</tr>
</tbody>
</table>
<p><em>seq</em>: A sequence of three <tt class="docutils literal"><span class="pre">int</span></tt>&#8216;s.
<em>dict</em>: A dictionary</p>
</div>
<div class="section" id="spin-polarized-calculation">
<h2>Spin-polarized calculation<a class="headerlink" href="#spin-polarized-calculation" title="Permalink to this headline">¶</a></h2>
<p>If the atoms object has non-zero magnetic moments, a spin-polarized calculation
will be performed by default.</p>
</div>
<div class="section" id="utility-functions">
<h2>Utility functions<a class="headerlink" href="#utility-functions" title="Permalink to this headline">¶</a></h2>
<p>As only a subset of FLEUR parameters can currently be specified
through ASE interface, the interface defines some utility functions
for cases where manual editing of the FLEUR input file <tt class="docutils literal"><span class="pre">inp</span></tt> is
necessary.</p>
<dl class="method">
<dt id="ase.calculators.fleur.FLEUR.write_inp">
<tt class="descclassname">FLEUR.</tt><tt class="descname">write_inp</tt><big>(</big><em>atoms</em><big>)</big><a class="reference internal" href="../../_modules/ase/calculators/fleur.html#FLEUR.write_inp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.calculators.fleur.FLEUR.write_inp" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the <em>inp</em> input file of FLEUR.</p>
<p>First, the information from Atoms is written to the simple input
file and the actual input file <em>inp</em> is then generated with the
FLEUR input generator. The location of input generator is specified
in the environment variable FLEUR_INPGEN.</p>
<p>Finally, the <em>inp</em> file is modified according to the arguments of
the FLEUR calculator object.</p>
</dd></dl>

<dl class="method">
<dt id="ase.calculators.fleur.FLEUR.initialize_density">
<tt class="descclassname">FLEUR.</tt><tt class="descname">initialize_density</tt><big>(</big><em>atoms</em><big>)</big><a class="reference internal" href="../../_modules/ase/calculators/fleur.html#FLEUR.initialize_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.calculators.fleur.FLEUR.initialize_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new starting density.</p>
</dd></dl>

<dl class="method">
<dt id="ase.calculators.fleur.FLEUR.calculate">
<tt class="descclassname">FLEUR.</tt><tt class="descname">calculate</tt><big>(</big><em>atoms</em><big>)</big><a class="reference internal" href="../../_modules/ase/calculators/fleur.html#FLEUR.calculate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.calculators.fleur.FLEUR.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Converge a FLEUR calculation to self-consistency.</p>
<p>Input files should be generated before calling this function
FLEUR performs always fixed number of SCF steps. This function
reduces the number of iterations gradually, however, a minimum
of five SCF steps is always performed.</p>
</dd></dl>

<dl class="method">
<dt id="ase.calculators.fleur.FLEUR.relax">
<tt class="descclassname">FLEUR.</tt><tt class="descname">relax</tt><big>(</big><em>atoms</em><big>)</big><a class="reference internal" href="../../_modules/ase/calculators/fleur.html#FLEUR.relax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.calculators.fleur.FLEUR.relax" title="Permalink to this definition">¶</a></dt>
<dd><p>Currently, user has to manually define relaxation parameters
(atoms to relax, relaxation directions, etc.) in inp file
before calling this function.</p>
</dd></dl>

</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Lattice constant of fcc Ni</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linspace</span>

<span class="kn">from</span> <span class="nn">ase.calculators.fleur</span> <span class="kn">import</span> <span class="n">FLEUR</span>
<span class="kn">from</span> <span class="nn">ase.lattice</span> <span class="kn">import</span> <span class="n">bulk</span>
<span class="kn">from</span> <span class="nn">ase.io.trajectory</span> <span class="kn">import</span> <span class="n">Trajectory</span>

<span class="n">atoms</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s">&#39;Ni&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">3.52</span><span class="p">)</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">FLEUR</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="s">&#39;PBE&#39;</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mf">3.6</span><span class="p">,</span> <span class="n">kpts</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">workdir</span><span class="o">=</span><span class="s">&#39;lat_const&#39;</span><span class="p">)</span>
<span class="n">atoms</span><span class="o">.</span><span class="n">set_calculator</span><span class="p">(</span><span class="n">calc</span><span class="p">)</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s">&#39;Ni.traj&#39;</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="n">atoms</span><span class="p">)</span>
<span class="n">cell0</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">linspace</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">cell0</span> <span class="o">*</span> <span class="n">s</span>
    <span class="n">atoms</span><span class="o">.</span><span class="n">set_cell</span><span class="p">((</span><span class="n">cell</span><span class="p">))</span>
    <span class="n">ene</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">traj</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="../../tutorials/eos/eos.html#eos"><em>equation of states tutorial</em></a> for analysis of the results.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">

          <h3>ASE</h3>
          <ul class="this-page-menu">
            <li><a href="../../overview.html">
              Overview</a></li>
            <li><a href="../../download.html">
              Installation</a></li>
            <li><a href="../../tutorials/tutorials.html">
              Tutorials</em></a></li>
            <li><a href="../ase.html">
              Documentation</a></li>
            <li><a href="../../faq.html">FAQ</a></li>
            <li><a href="../../mailinglists.html">Mailing lists</a></li>
            <li><a href="../../development/releasenotes.html">Release notes</a></li>
            <li><a href="../../licenseinfo.html">License info</a></li>
           </ul>
           <h3>Development</h3>
           <ul class="this-page-menu">
            <li><a href="../../development/development.html">
              Development</a></li>
            <li><a href="http://wiki.fysik.dtu.dk/ase/epydoc/ase-module.html">
              Epydoc</a></li>
            <li><a href="http://trac.fysik.dtu.dk/projects/ase/browser/trunk/">
              Source code (svn)</a></li>
            <li><a href="../../bugs.html">Bugs!</a></li>
            <li><a href="http://trac.fysik.dtu.dk/projects/ase/report/1">
              Bug Tracker</a></li>
            <li><a href="https://ase-buildbot.fysik.dtu.dk/waterfall">
              BuildBot</a></li>
          </ul>
            <h3>This Page</h3>
            <ul>
<li><a class="reference internal" href="#">FLEUR</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#environment-variables">Environment variables</a></li>
<li><a class="reference internal" href="#fleur-calculator">FLEUR Calculator</a></li>
<li><a class="reference internal" href="#spin-polarized-calculation">Spin-polarized calculation</a></li>
<li><a class="reference internal" href="#utility-functions">Utility functions</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="FHI-aims.html" title="previous chapter">FHI-aims</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="gromacs.html" title="next chapter">Gromacs</a></p>
            <ul class="this-page-menu">
              <li><a href="../../_sources/ase/calculators/fleur.txt">Show Source</a></li>
            </ul>
            <h3>Quick search</h3>
            <form class="search" action="../../search.html" method="get">
              <input type="text" name="q" size="18" /> <input type="submit" value="Go" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>



        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>



        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             accesskey="">modules</a> |</li>
        <a href="../../index.html"><img class="logo" src="../../_static/ase.ico" alt="Logo" align="absmiddle"/></a>
          <li><a href="../ase.html" accesskey="U">Documentation for modules in ASE</a> &raquo;</li>
          <li><a href="calculators.html" accesskey="U">Calculators</a> &raquo;</li>
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2015, CAMd.
      Last updated on Tue, 21 Jul 2015 11:00:40.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>