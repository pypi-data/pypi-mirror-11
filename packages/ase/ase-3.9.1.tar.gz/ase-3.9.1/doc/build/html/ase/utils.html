<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Utillity functions and classes &mdash; ASE  documentation</title>
    <link rel="stylesheet" href="../_static/ase.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/ase.ico"/>
    <link rel="contents" title="Global table of contents" href="../contents.html" />
    <link rel="index" title="Global index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="ASE  documentation" href="../index.html" />
    <link rel="up" title="Documentation for modules in ASE" href="ase.html" />
    <link rel="next" title="Building neighbor-lists" href="neighbors.html" />
    <link rel="prev" title="Trajectory files" href="trajectory.html" />
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>



        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>



        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             accesskey="">modules</a> |</li>
        <a href="../index.html"><img class="logo" src="../_static/ase.ico" alt="Logo" align="absmiddle"/></a>
          <li><a href="ase.html" accesskey="U">Documentation for modules in ASE</a> &raquo;</li>
      </ul>
    </div>
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="module-ase.utils"></span><div class="section" id="utillity-functions-and-classes">
<h1>Utillity functions and classes<a class="headerlink" href="#utillity-functions-and-classes" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="ase.utils.opencew">
<tt class="descclassname">ase.utils.</tt><tt class="descname">opencew</tt><big>(</big><em>filename</em>, <em>world=None</em><big>)</big><a class="reference internal" href="../_modules/ase/utils.html#opencew"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.opencew" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and open filename exclusively for writing.</p>
<p>If master cpu gets exclusive write access to filename, a file
descriptor is returned (a dummy file descriptor is returned on the
slaves).  If the master cpu does not get write access, None is
returned on all processors.</p>
</dd></dl>

<dl class="function">
<dt id="ase.utils.gcd">
<tt class="descclassname">ase.utils.</tt><tt class="descname">gcd</tt><big>(</big><em>a</em>, <em>b</em><big>)</big><a class="reference internal" href="../_modules/ase/utils.html#gcd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.gcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Greatest common divisor of a and b.</p>
</dd></dl>

<dl class="class">
<dt id="ase.utils.timing.Timer">
<em class="property">class </em><tt class="descclassname">ase.utils.timing.</tt><tt class="descname">Timer</tt><big>(</big><em>print_levels=1000</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/timing.html#Timer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.timing.Timer" title="Permalink to this definition">¶</a></dt>
<dd><p>Timer object.</p>
<p>Use like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
<span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s">&#39;description&#39;</span><span class="p">)</span>
<span class="c"># do something</span>
<span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre>with timer(&#39;description&#39;):
    # do something
</pre></div>
</div>
<p>To get a summary call:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">timer</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="ase.utils.timing.timer">
<em class="property">class </em><tt class="descclassname">ase.utils.timing.</tt><tt class="descname">timer</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/timing.html#timer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.timing.timer" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator for timing a method call.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ase.utils.timing</span> <span class="kn">import</span> <span class="n">timer</span><span class="p">,</span> <span class="n">Timer</span>

<span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
        
    <span class="nd">@timer</span><span class="p">(</span><span class="s">&#39;Add two numbers&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
</dd></dl>

<div class="section" id="equation-of-state">
<span id="index-0"></span><h2>Equation of state<a class="headerlink" href="#equation-of-state" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#ase.utils.eos.EquationOfState" title="ase.utils.eos.EquationOfState"><tt class="xref py py-class docutils literal"><span class="pre">EquationOfState</span></tt></a> class can be used to find
equilibrium volume, energy, and bulk modulus for solids:</p>
<dl class="class">
<dt id="ase.utils.eos.EquationOfState">
<em class="property">class </em><tt class="descclassname">ase.utils.eos.</tt><tt class="descname">EquationOfState</tt><big>(</big><em>volumes</em>, <em>energies</em>, <em>eos='sjeos'</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/eos.html#EquationOfState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.eos.EquationOfState" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit equation of state for bulk systems.</p>
<p>The following equation is used:</p>
<div class="highlight-python"><div class="highlight"><pre>sjeos (default)
    A third order inverse polynomial fit 10.1103/PhysRevB.67.026103

                    2      3        -1/3
E(V) = c + c t + c t  + c t ,  t = V
        0   1     2      3

taylor
    A third order Taylor series expansion about the minimum volume

murnaghan
    PRB 28, 5480 (1983)

birch
    Intermetallic compounds: Principles and Practice,
    Vol I: Principles. pages 195-210

birchmurnaghan
    PRB 70, 224107

pouriertarantola
    PRB 70, 224107

vinet
    PRB 70, 224107

antonschmidt
    Intermetallics 11, 23-32 (2003)

p3
    A third order polynomial fit
</pre></div>
</div>
<p>Use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eos</span> <span class="o">=</span> <span class="n">EquationOfState</span><span class="p">(</span><span class="n">volumes</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">eos</span><span class="o">=</span><span class="s">&#39;sjeos&#39;</span><span class="p">)</span>
<span class="n">v0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="../tutorials/eos/eos.html#eos"><em>Equation of state</em></a> tutorial.</p>
</div>
</div>
<div class="section" id="module-ase.utils.geometry">
<span id="geometry-tools"></span><h2>Geometry tools<a class="headerlink" href="#module-ase.utils.geometry" title="Permalink to this headline">¶</a></h2>
<dl class="exception">
<dt id="ase.utils.geometry.IncompatibleCellError">
<em class="property">exception </em><tt class="descclassname">ase.utils.geometry.</tt><tt class="descname">IncompatibleCellError</tt><a class="reference internal" href="../_modules/ase/utils/geometry.html#IncompatibleCellError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.geometry.IncompatibleCellError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised if stacking fails due to incompatible cells
between <em>atoms1</em> and <em>atoms2</em>.</p>
</dd></dl>

<dl class="function">
<dt id="ase.utils.geometry.cut">
<tt class="descclassname">ase.utils.geometry.</tt><tt class="descname">cut</tt><big>(</big><em>atoms</em>, <em>a=(1</em>, <em>0</em>, <em>0)</em>, <em>b=(0</em>, <em>1</em>, <em>0)</em>, <em>c=None</em>, <em>clength=None</em>, <em>origo=(0</em>, <em>0</em>, <em>0)</em>, <em>nlayers=None</em>, <em>extend=1.0</em>, <em>tolerance=0.01</em>, <em>maxatoms=None</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/geometry.html#cut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.geometry.cut" title="Permalink to this definition">¶</a></dt>
<dd><p>Cuts out a cell defined by <em>a</em>, <em>b</em>, <em>c</em> and <em>origo</em> from a
sufficiently repeated copy of <em>atoms</em>.</p>
<p>Typically, this function is used to create slabs of different
sizes and orientations. The vectors <em>a</em>, <em>b</em> and <em>c</em> are in scaled
coordinates and defines the returned cell and should normally be
integer-valued in order to end up with a periodic
structure. However, for systems with sub-translations, like fcc,
integer multiples of 1/2 or 1/3 might also make sence for some
directions (and will be treated correctly).</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>atoms: Atoms instance</dt>
<dd>This should correspond to a repeatable unit cell.</dd>
<dt>a: int | 3 floats</dt>
<dd>The a-vector in scaled coordinates of the cell to cut out. If
integer, the a-vector will be the scaled vector from <em>origo</em> to the
atom with index <em>a</em>.</dd>
<dt>b: int | 3 floats</dt>
<dd>The b-vector in scaled coordinates of the cell to cut out. If
integer, the b-vector will be the scaled vector from <em>origo</em> to the
atom with index <em>b</em>.</dd>
<dt>c: None | int | 3 floats</dt>
<dd>The c-vector in scaled coordinates of the cell to cut out.
if integer, the c-vector will be the scaled vector from <em>origo</em> to
the atom with index <em>c</em>.
If <em>None</em> it will be along cross(a, b) converted to real space
and normalised with the cube root of the volume. Note that this
in general is not perpendicular to a and b for non-cubic
systems. For cubic systems however, this is redused to
c = cross(a, b).</dd>
<dt>clength: None | float</dt>
<dd>If not None, the length of the c-vector will be fixed to
<em>clength</em> Angstroms. Should not be used together with
<em>nlayers</em>.</dd>
<dt>origo: int | 3 floats</dt>
<dd>Position of origo of the new cell in scaled coordinates. If
integer, the position of the atom with index <em>origo</em> is used.</dd>
<dt>nlayers: None | int</dt>
<dd>If <em>nlayers</em> is not <em>None</em>, the returned cell will have
<em>nlayers</em> atomic layers in the c-direction.</dd>
<dt>extend: 1 or 3 floats</dt>
<dd>The <em>extend</em> argument scales the effective cell in which atoms
will be included. It must either be three floats or a single
float scaling all 3 directions.  By setting to a value just
above one, e.g. 1.05, it is possible to all the corner and
edge atoms in the returned cell.  This will of cause make the
returned cell non-repeatable, but is very usefull for
visualisation.</dd>
<dt>tolerance: float</dt>
<dd>Determines what is defined as a plane.  All atoms within
<em>tolerance</em> Angstroms from a given plane will be considered to
belong to that plane.</dd>
<dt>maxatoms: None | int</dt>
<dd>This option is used to auto-tune <em>tolerance</em> when <em>nlayers</em> is
given for high zone axis systems.  For high zone axis one
needs to reduce <em>tolerance</em> in order to distinguise the atomic
planes, resulting in the more atoms will be added and
eventually MemoryError.  A too small <em>tolerance</em>, on the other
hand, might result in inproper splitting of atomic planes and
that too few layers are returned.  If <em>maxatoms</em> is not None,
<em>tolerance</em> will automatically be gradually reduced until
<em>nlayers</em> atomic layers is obtained, when the number of atoms
exceeds <em>maxatoms</em>.</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ase.lattice.spacegroup</span> <span class="kn">import</span> <span class="n">crystal</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="go"># Create an aluminium (111) slab with three layers</span>
<span class="go">#</span>
<span class="go"># First an unit cell of Al</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">4.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aluminium</span> <span class="o">=</span> <span class="n">crystal</span><span class="p">(</span><span class="s">&#39;Al&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">spacegroup</span><span class="o">=</span><span class="mi">225</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">cellpar</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="go"># Then cut out the slab</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">al111</span> <span class="o">=</span> <span class="n">cut</span><span class="p">(</span><span class="n">aluminium</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">nlayers</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="go"># Visualisation of the skutterudite unit cell</span>
<span class="go">#</span>
<span class="go"># Again, create a skutterudite unit cell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">9.04</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">skutterudite</span> <span class="o">=</span> <span class="n">crystal</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s">&#39;Co&#39;</span><span class="p">,</span> <span class="s">&#39;Sb&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">basis</span><span class="o">=</span><span class="p">[(</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.25</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.335</span><span class="p">,</span> <span class="mf">0.158</span><span class="p">)],</span>
<span class="gp">... </span>    <span class="n">spacegroup</span><span class="o">=</span><span class="mi">204</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">cellpar</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="go"># Then use *origo* to put &#39;Co&#39; at the corners and *extend* to</span>
<span class="go"># include all corner and edge atoms.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">cut</span><span class="p">(</span><span class="n">skutterudite</span><span class="p">,</span> <span class="n">origo</span><span class="o">=</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="n">extend</span><span class="o">=</span><span class="mf">1.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ase</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ase.utils.geometry.find_mic">
<tt class="descclassname">ase.utils.geometry.</tt><tt class="descname">find_mic</tt><big>(</big><em>D</em>, <em>cell</em>, <em>pbc=True</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/geometry.html#find_mic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.geometry.find_mic" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the minimum-image representation of vector(s) D</p>
</dd></dl>

<dl class="function">
<dt id="ase.utils.geometry.get_layers">
<tt class="descclassname">ase.utils.geometry.</tt><tt class="descname">get_layers</tt><big>(</big><em>atoms</em>, <em>miller</em>, <em>tolerance=0.001</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/geometry.html#get_layers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.geometry.get_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns two arrays describing which layer each atom belongs
to and the distance between the layers and origo.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>miller: 3 integers</dt>
<dd>The Miller indices of the planes. Actually, any direction
in reciprocal space works, so if a and b are two float
vectors spanning an atomic plane, you can get all layers
parallel to this with miller=np.cross(a,b).</dd>
<dt>tolerance: float</dt>
<dd>The maximum distance in Angstrom along the plane normal for
counting two atoms as belonging to the same plane.</dd>
</dl>
<p>Returns:</p>
<dl class="docutils">
<dt>tags: array of integres</dt>
<dd>Array of layer indices for each atom.</dd>
<dt>levels: array of floats</dt>
<dd>Array of distances in Angstrom from each layer to origo.</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ase.lattice.spacegroup</span> <span class="kn">import</span> <span class="n">crystal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span> <span class="o">=</span> <span class="n">crystal</span><span class="p">(</span><span class="s">&#39;Al&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">spacegroup</span><span class="o">=</span><span class="mi">225</span><span class="p">,</span> <span class="n">cellpar</span><span class="o">=</span><span class="mf">4.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">atoms</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">array([[ 0.   ,  0.   ,  0.   ],</span>
<span class="go">       [ 0.   ,  2.025,  2.025],</span>
<span class="go">       [ 2.025,  0.   ,  2.025],</span>
<span class="go">       [ 2.025,  2.025,  0.   ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_layers</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(array([0, 1, 1, 0]), array([ 0.   ,  2.025]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ase.utils.geometry.minimize_tilt">
<tt class="descclassname">ase.utils.geometry.</tt><tt class="descname">minimize_tilt</tt><big>(</big><em>atoms, order=[0, 1, 2], fold_atoms=True</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/geometry.html#minimize_tilt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.geometry.minimize_tilt" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimize the tilt angles of the unit cell.</p>
</dd></dl>

<dl class="function">
<dt id="ase.utils.geometry.minimize_tilt_ij">
<tt class="descclassname">ase.utils.geometry.</tt><tt class="descname">minimize_tilt_ij</tt><big>(</big><em>atoms</em>, <em>modified=1</em>, <em>fixed=0</em>, <em>fold_atoms=True</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/geometry.html#minimize_tilt_ij"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.geometry.minimize_tilt_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimize the tilt angle for two given axes.</p>
<p>The problem is underdetermined. Therefore one can choose one axis
that is kept fixed.</p>
</dd></dl>

<dl class="function">
<dt id="ase.utils.geometry.niggli_reduce">
<tt class="descclassname">ase.utils.geometry.</tt><tt class="descname">niggli_reduce</tt><big>(</big><em>atoms</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/geometry.html#niggli_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.geometry.niggli_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the supplied atoms object&#8217;s unit cell into its
maximally-reduced Niggli unit cell. Even if the unit cell is already
maximally reduced, it will be converted into its unique Niggli unit cell.
This will also wrap all atoms into the new unit cell.</p>
<p>References:</p>
<p>Niggli, P. &#8220;Krystallographische und strukturtheoretische Grundbegriffe.
Handbuch der Experimentalphysik&#8221;, 1928, Vol. 7, Part 1, 108-176.</p>
<p>Krivy, I. and Gruber, B., &#8220;A Unified Algorithm for Determining the
Reduced (Niggli) Cell&#8221;, Acta Cryst. 1976, A32, 297-298.</p>
<p>Grosse-Kunstleve, R.W.; Sauter, N. K.; and Adams, P. D. &#8220;Numerically
stable algorithms for the computation of reduced unit cells&#8221;, Acta Cryst.
2004, A60, 1-6.</p>
</dd></dl>

<dl class="function">
<dt id="ase.utils.geometry.rotate">
<tt class="descclassname">ase.utils.geometry.</tt><tt class="descname">rotate</tt><big>(</big><em>atoms</em>, <em>a1</em>, <em>a2</em>, <em>b1</em>, <em>b2</em>, <em>rotate_cell=True</em>, <em>center=(0</em>, <em>0</em>, <em>0)</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/geometry.html#rotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.geometry.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate <em>atoms</em>, such that <em>a1</em> will be rotated in the direction
of <em>a2</em> and <em>b1</em> in the direction of <em>b2</em>.  The point at <em>center</em>
is fixed.  Use <em>center=&#8217;COM&#8217;</em> to fix the center of mass.  If
<em>rotate_cell</em> is true, the cell will be rotated together with the
atoms.</p>
<p>Note that the 000-corner of the cell is by definition fixed at
origo.  Hence, setting <em>center</em> to something other than (0, 0, 0)
will rotate the atoms out of the cell, even if <em>rotate_cell</em> is
True.</p>
</dd></dl>

<dl class="function">
<dt id="ase.utils.geometry.rotation_matrix">
<tt class="descclassname">ase.utils.geometry.</tt><tt class="descname">rotation_matrix</tt><big>(</big><em>a1</em>, <em>a2</em>, <em>b1</em>, <em>b2</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/geometry.html#rotation_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.geometry.rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a rotation matrix that rotates the vectors <em>a1</em> in the
direction of <em>a2</em> and <em>b1</em> in the direction of <em>b2</em>.</p>
<p>In the case that the angle between <em>a2</em> and <em>b2</em> is not the same
as between <em>a1</em> and <em>b1</em>, a proper rotation matrix will anyway be
constructed by first rotate <em>b2</em> in the <em>b1</em>, <em>b2</em> plane.</p>
</dd></dl>

<dl class="function">
<dt id="ase.utils.geometry.sort">
<tt class="descclassname">ase.utils.geometry.</tt><tt class="descname">sort</tt><big>(</big><em>atoms</em>, <em>tags=None</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/geometry.html#sort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.geometry.sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new Atoms object with sorted atomic order. The default
is to order according to chemical symbols, but if <em>tags</em> is not
None, it will be used instead. A stable sorting algorithm is used.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ase.lattice.spacegroup</span> <span class="kn">import</span> <span class="n">crystal</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="go"># Two unit cells of NaCl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">5.64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nacl</span> <span class="o">=</span> <span class="n">crystal</span><span class="p">([</span><span class="s">&#39;Na&#39;</span><span class="p">,</span> <span class="s">&#39;Cl&#39;</span><span class="p">],</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)],</span>
<span class="gp">... </span><span class="n">spacegroup</span><span class="o">=</span><span class="mi">225</span><span class="p">,</span> <span class="n">cellpar</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span><span class="o">.</span><span class="n">repeat</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nacl</span><span class="o">.</span><span class="n">get_chemical_symbols</span><span class="p">()</span>
<span class="go">[&#39;Na&#39;, &#39;Na&#39;, &#39;Na&#39;, &#39;Na&#39;, &#39;Cl&#39;, &#39;Cl&#39;, &#39;Cl&#39;, &#39;Cl&#39;, &#39;Na&#39;, &#39;Na&#39;, &#39;Na&#39;,</span>
<span class="go">        &#39;Na&#39;, &#39;Cl&#39;, &#39;Cl&#39;, &#39;Cl&#39;, &#39;Cl&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nacl_sorted</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="n">nacl</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nacl_sorted</span><span class="o">.</span><span class="n">get_chemical_symbols</span><span class="p">()</span>
<span class="go">[&#39;Cl&#39;, &#39;Cl&#39;, &#39;Cl&#39;, &#39;Cl&#39;, &#39;Cl&#39;, &#39;Cl&#39;, &#39;Cl&#39;, &#39;Cl&#39;, &#39;Na&#39;, &#39;Na&#39;, &#39;Na&#39;,</span>
<span class="go">        &#39;Na&#39;, &#39;Na&#39;, &#39;Na&#39;, &#39;Na&#39;, &#39;Na&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">nacl_sorted</span><span class="o">.</span><span class="n">cell</span> <span class="o">==</span> <span class="n">nacl</span><span class="o">.</span><span class="n">cell</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ase.utils.geometry.stack">
<tt class="descclassname">ase.utils.geometry.</tt><tt class="descname">stack</tt><big>(</big><em>atoms1</em>, <em>atoms2</em>, <em>axis=2</em>, <em>cell=None</em>, <em>fix=0.5</em>, <em>maxstrain=0.5</em>, <em>distance=None</em>, <em>reorder=False</em>, <em>output_strained=False</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/geometry.html#stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.geometry.stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new Atoms instance with <em>atoms2</em> stacked on top of
<em>atoms1</em> along the given axis. Periodicity in all directions is
ensured.</p>
<p>The size of the final cell is determined by <em>cell</em>, except
that the length alongh <em>axis</em> will be the sum of
<em>atoms1.cell[axis]</em> and <em>atoms2.cell[axis]</em>. If <em>cell</em> is None,
it will be interpolated between <em>atoms1</em> and <em>atoms2</em>, where
<em>fix</em> determines their relative weight. Hence, if <em>fix</em> equals
zero, the final cell will be determined purely from <em>atoms1</em> and
if <em>fix</em> equals one, it will be determined purely from
<em>atoms2</em>.</p>
<p>An ase.geometry.IncompatibleCellError exception is raised if the
cells of <em>atoms1</em> and <em>atoms2</em> are incopatible, e.g. if the far
corner of the unit cell of either <em>atoms1</em> or <em>atoms2</em> is
displaced more than <em>maxstrain</em>. Setting <em>maxstrain</em> to None,
disable this check.</p>
<p>If <em>distance</em> is not None, the size of the final cell, along the
direction perpendicular to the interface, will be adjusted such
that the distance between the closest atoms in <em>atoms1</em> and
<em>atoms2</em> will be equal to <em>distance</em>. This option uses
scipy.optimize.fmin() and hence require scipy to be installed.</p>
<p>If <em>reorder</em> is True, then the atoms will be reordred such that
all atoms with the same symbol will follow sequensially after each
other, eg: &#8216;Al2MnAl10Fe&#8217; -&gt; &#8216;Al12FeMn&#8217;.</p>
<p>If <em>output_strained</em> is True, then the strained versions of
<em>atoms1</em> and <em>atoms2</em> are returned in addition to the stacked
structure.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ase.lattice.spacegroup</span> <span class="kn">import</span> <span class="n">crystal</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="go"># Create an Ag(110)-Si(110) interface with three atomic layers</span>
<span class="go"># on each side.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_ag</span> <span class="o">=</span> <span class="mf">4.09</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span> <span class="o">=</span> <span class="n">crystal</span><span class="p">([</span><span class="s">&#39;Ag&#39;</span><span class="p">],</span> <span class="n">basis</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">spacegroup</span><span class="o">=</span><span class="mi">225</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">cellpar</span><span class="o">=</span><span class="p">[</span><span class="n">a_ag</span><span class="p">,</span> <span class="n">a_ag</span><span class="p">,</span> <span class="n">a_ag</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="mf">90.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag110</span> <span class="o">=</span> <span class="n">cut</span><span class="p">(</span><span class="n">ag</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">nlayers</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_si</span> <span class="o">=</span> <span class="mf">5.43</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span> <span class="o">=</span> <span class="n">crystal</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">],</span> <span class="n">basis</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">spacegroup</span><span class="o">=</span><span class="mi">227</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">cellpar</span><span class="o">=</span><span class="p">[</span><span class="n">a_si</span><span class="p">,</span> <span class="n">a_si</span><span class="p">,</span> <span class="n">a_si</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="mf">90.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si110</span> <span class="o">=</span> <span class="n">cut</span><span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">nlayers</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">stack</span><span class="p">(</span><span class="n">ag110</span><span class="p">,</span> <span class="n">si110</span><span class="p">,</span> <span class="n">maxstrain</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ase</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>  
<span class="go">&gt;&gt;&gt;</span>
<span class="go"># Once more, this time adjusted such that the distance between</span>
<span class="go"># the closest Ag and Si atoms will be 2.3 Angstrom (requires scipy).</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface2</span> <span class="o">=</span> <span class="n">stack</span><span class="p">(</span><span class="n">ag110</span><span class="p">,</span> <span class="n">si110</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">maxstrain</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mf">2.3</span><span class="p">)</span>   
<span class="go">Optimization terminated successfully.</span>
<span class="go">    ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ase</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">interface2</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ase.utils.geometry.wrap_positions">
<tt class="descclassname">ase.utils.geometry.</tt><tt class="descname">wrap_positions</tt><big>(</big><em>positions</em>, <em>cell</em>, <em>pbc=True</em>, <em>center=(0.5</em>, <em>0.5</em>, <em>0.5)</em>, <em>eps=1e-07</em><big>)</big><a class="reference internal" href="../_modules/ase/utils/geometry.html#wrap_positions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.utils.geometry.wrap_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap positions to unit cell.</p>
<p>Returns positions changed by a multiple of the unit cell vectors to
fit inside the space spanned by these vectors.  See also the
<a class="reference internal" href="atoms.html#ase.atoms.Atoms.wrap" title="ase.atoms.Atoms.wrap"><tt class="xref py py-meth docutils literal"><span class="pre">ase.atoms.Atoms.wrap()</span></tt></a> method.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>positions: float ndarray of shape (n, 3)</dt>
<dd>Positions of the atoms</dd>
<dt>cell: float ndarray of shape (3, 3)</dt>
<dd>Unit cell vectors.</dd>
<dt>pbc: one or 3 bool</dt>
<dd>For each axis in the unit cell decides whether the positions
will be moved along this axis.</dd>
<dt>center: three float</dt>
<dd>The positons in fractional coordinates that the new positions
will be nearest possible to.</dd>
<dt>eps: float</dt>
<dd>Small number to prevent slightly negative coordinates from beeing
wrapped.</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ase.utils.geometry</span> <span class="kn">import</span> <span class="n">wrap_positions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wrap_positions</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]],</span>
<span class="gp">... </span>               <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
<span class="gp">... </span>               <span class="n">pbc</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">array([[ 0.9 ,  0.01, -0.5 ]])</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="symmetry-analysis">
<h2>Symmetry analysis<a class="headerlink" href="#symmetry-analysis" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://spglib.sourceforge.net/pyspglibForASE/">http://spglib.sourceforge.net/pyspglibForASE/</a></p>
</div>
<div class="section" id="phonons">
<h2>Phonons<a class="headerlink" href="#phonons" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://phonopy.sourceforge.net/">http://phonopy.sourceforge.net/</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">

          <h3>ASE</h3>
          <ul class="this-page-menu">
            <li><a href="../overview.html">
              Overview</a></li>
            <li><a href="../download.html">
              Installation</a></li>
            <li><a href="../tutorials/tutorials.html">
              Tutorials</em></a></li>
            <li><a href="ase.html">
              Documentation</a></li>
            <li><a href="../faq.html">FAQ</a></li>
            <li><a href="../mailinglists.html">Mailing lists</a></li>
            <li><a href="../development/releasenotes.html">Release notes</a></li>
            <li><a href="../licenseinfo.html">License info</a></li>
           </ul>
           <h3>Development</h3>
           <ul class="this-page-menu">
            <li><a href="../development/development.html">
              Development</a></li>
            <li><a href="http://wiki.fysik.dtu.dk/ase/epydoc/ase-module.html">
              Epydoc</a></li>
            <li><a href="http://trac.fysik.dtu.dk/projects/ase/browser/trunk/">
              Source code (svn)</a></li>
            <li><a href="../bugs.html">Bugs!</a></li>
            <li><a href="http://trac.fysik.dtu.dk/projects/ase/report/1">
              Bug Tracker</a></li>
            <li><a href="https://ase-buildbot.fysik.dtu.dk/waterfall">
              BuildBot</a></li>
          </ul>
            <h3>This Page</h3>
            <ul>
<li><a class="reference internal" href="#">Utillity functions and classes</a><ul>
<li><a class="reference internal" href="#equation-of-state">Equation of state</a></li>
<li><a class="reference internal" href="#module-ase.utils.geometry">Geometry tools</a></li>
<li><a class="reference internal" href="#symmetry-analysis">Symmetry analysis</a></li>
<li><a class="reference internal" href="#phonons">Phonons</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="trajectory.html" title="previous chapter">Trajectory files</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="neighbors.html" title="next chapter">Building neighbor-lists</a></p>
            <ul class="this-page-menu">
              <li><a href="../_sources/ase/utils.txt">Show Source</a></li>
            </ul>
            <h3>Quick search</h3>
            <form class="search" action="../search.html" method="get">
              <input type="text" name="q" size="18" /> <input type="submit" value="Go" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>



        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>



        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             accesskey="">modules</a> |</li>
        <a href="../index.html"><img class="logo" src="../_static/ase.ico" alt="Logo" align="absmiddle"/></a>
          <li><a href="ase.html" accesskey="U">Documentation for modules in ASE</a> &raquo;</li>
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2015, CAMd.
      Last updated on Tue, 21 Jul 2015 11:00:40.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>