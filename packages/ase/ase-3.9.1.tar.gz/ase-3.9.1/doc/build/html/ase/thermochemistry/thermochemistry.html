<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Thermochemistry &mdash; ASE  documentation</title>
    <link rel="stylesheet" href="../../_static/ase.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../../',
          VERSION:     '',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/ase.ico"/>
    <link rel="contents" title="Global table of contents" href="../../contents.html" />
    <link rel="index" title="Global index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="top" title="ASE  documentation" href="../../index.html" />
    <link rel="up" title="Documentation for modules in ASE" href="../ase.html" />
    <link rel="next" title="Infrared intensities" href="../infrared.html" />
    <link rel="prev" title="Phase diagrams and Pourbaix diagrams" href="../phasediagram/phasediagram.html" />
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>



        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>



        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             accesskey="">modules</a> |</li>
        <a href="../../index.html"><img class="logo" src="../../_static/ase.ico" alt="Logo" align="absmiddle"/></a>
          <li><a href="../ase.html" accesskey="U">Documentation for modules in ASE</a> &raquo;</li>
      </ul>
    </div>
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="module-ase.thermochemistry"></span><div class="section" id="thermochemistry">
<h1>Thermochemistry<a class="headerlink" href="#thermochemistry" title="Permalink to this headline">¶</a></h1>
<p>ASE contains a <a class="reference internal" href="#module-ase.thermochemistry" title="ase.thermochemistry: Thermochemistry module"><tt class="xref py py-mod docutils literal"><span class="pre">ase.thermochemistry</span></tt></a> module that lets the user derive
commonly desired thermodynamic quantities of molecules and crystalline solids
from ASE output and some user-specified parameters. Three cases are currently
handled by this module: the ideal-gas limit (in which translational and
rotational degrees of freedom are taken into account), the harmonic limit
(generally used for adsorbates, in which all degrees of freedom are treated
harmonically), and a crystalline solid model (in which a lattice of N atoms
is treated as a system of 3N independent harmonic oscillators). The first two
cases rely on good vibrational energies being fed to the calculators, which
can be calculated with the <a class="reference internal" href="../vibrations.html#module-ase.vibrations" title="ase.vibrations"><tt class="xref py py-mod docutils literal"><span class="pre">ase.vibrations</span></tt></a> module. Likewise, the
crystalline solid model depends on an accurate phonon density of states; this
is readily calculated using the <a class="reference internal" href="../phonons.html#module-ase.phonons" title="ase.phonons"><tt class="xref py py-mod docutils literal"><span class="pre">ase.phonons</span></tt></a> module.</p>
<div class="section" id="ideal-gas-limit">
<h2>Ideal-gas limit<a class="headerlink" href="#ideal-gas-limit" title="Permalink to this headline">¶</a></h2>
<p>The thermodynamic quantities of ideal gases are calculated by assuming that
all spatial degrees of freedom are independent and separable into
translational, rotational, and vibrational degrees of freedom. The
<a class="reference internal" href="#ase.thermochemistry.IdealGasThermo" title="ase.thermochemistry.IdealGasThermo"><tt class="xref py py-class docutils literal"><span class="pre">IdealGasThermo</span></tt></a> class supports calculation of
enthalpy (<span class="math">\(H\)</span>), entropy (<span class="math">\(S\)</span>), and Gibbs free energy (<span class="math">\(G\)</span>),
and has the interface listed below.</p>
<dl class="class">
<dt id="ase.thermochemistry.IdealGasThermo">
<em class="property">class </em><tt class="descclassname">ase.thermochemistry.</tt><tt class="descname">IdealGasThermo</tt><big>(</big><em>vib_energies</em>, <em>geometry</em>, <em>electronicenergy=None</em>, <em>atoms=None</em>, <em>symmetrynumber=None</em>, <em>spin=None</em>, <em>natoms=None</em><big>)</big><a class="reference internal" href="../../_modules/ase/thermochemistry.html#IdealGasThermo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.thermochemistry.IdealGasThermo" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for calculating thermodynamic properties of a molecule
based on statistical mechanical treatments in the ideal gas
approximation.</p>
<p>Inputs for enthalpy calculations:</p>
<dl class="docutils">
<dt>vib_energies <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>a list of the vibrational energies of the molecule (e.g., from
ase.vibrations.Vibrations.get_energies). The number of vibrations
used is automatically calculated by the geometry and the number of
atoms. If more are specified than are needed, then the lowest
numbered vibrations are neglected. If either atoms or natoms is
unspecified, then uses the entire list. Units are eV.</dd>
<dt>geometry <span class="classifier-delimiter">:</span> <span class="classifier">&#8216;monatomic&#8217;, &#8216;linear&#8217;, or &#8216;nonlinear&#8217;</span></dt>
<dd>geometry of the molecule</dd>
<dt>electronicenergy <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>the electronic energy in eV
(if electronicenergy is unspecified, then the methods of this
class can be interpreted as the enthalpy and free energy
corrections)</dd>
<dt>natoms <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>the number of atoms, used along with &#8216;geometry&#8217; to determine how
many vibrations to use. (Not needed if an atoms object is supplied
in &#8216;atoms&#8217; or if the user desires the entire list of vibrations
to be used.)</dd>
</dl>
<p>Extra inputs needed for for entropy / free energy calculations:</p>
<dl class="docutils">
<dt>atoms <span class="classifier-delimiter">:</span> <span class="classifier">an ASE atoms object</span></dt>
<dd>used to calculate rotational moments of inertia and molecular mass</dd>
<dt>symmetrynumber <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>symmetry number of the molecule. See, for example, Table 10.1 and
Appendix B of C. Cramer &#8220;Essentials of Computational Chemistry&#8221;,
2nd Ed.</dd>
<dt>spin <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>the total electronic spin. (0 for molecules in which all electrons
are paired, 0.5 for a free radical with a single unpaired electron,
1.0 for a triplet with two unpaired electrons, such as O_2.)</dd>
</dl>
<dl class="method">
<dt id="ase.thermochemistry.IdealGasThermo.get_enthalpy">
<tt class="descname">get_enthalpy</tt><big>(</big><em>temperature</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../../_modules/ase/thermochemistry.html#IdealGasThermo.get_enthalpy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.thermochemistry.IdealGasThermo.get_enthalpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the enthalpy, in eV, in the ideal gas approximation
at a specified temperature (K).</p>
</dd></dl>

<dl class="method">
<dt id="ase.thermochemistry.IdealGasThermo.get_entropy">
<tt class="descname">get_entropy</tt><big>(</big><em>temperature</em>, <em>pressure</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../../_modules/ase/thermochemistry.html#IdealGasThermo.get_entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.thermochemistry.IdealGasThermo.get_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the entropy, in eV/K, in the ideal gas approximation
at a specified temperature (K) and pressure (Pa).</p>
</dd></dl>

<dl class="method">
<dt id="ase.thermochemistry.IdealGasThermo.get_gibbs_energy">
<tt class="descname">get_gibbs_energy</tt><big>(</big><em>temperature</em>, <em>pressure</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../../_modules/ase/thermochemistry.html#IdealGasThermo.get_gibbs_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.thermochemistry.IdealGasThermo.get_gibbs_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Gibbs free energy, in eV, in the ideal gas
approximation at a specified temperature (K) and pressure (Pa).</p>
</dd></dl>

</dd></dl>

<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#ase.thermochemistry.IdealGasThermo" title="ase.thermochemistry.IdealGasThermo"><tt class="xref py py-class docutils literal"><span class="pre">IdealGasThermo</span></tt></a> class would generally be called after an energy
optimization and a vibrational analysis. The user needs to supply certain
parameters if the entropy or free energy are desired, such as the geometry
and symmetry number. An example on the nitrogen molecule is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ase.structure</span> <span class="kn">import</span> <span class="n">molecule</span>
<span class="kn">from</span> <span class="nn">ase.calculators.emt</span> <span class="kn">import</span> <span class="n">EMT</span>
<span class="kn">from</span> <span class="nn">ase.optimize</span> <span class="kn">import</span> <span class="n">QuasiNewton</span>
<span class="kn">from</span> <span class="nn">ase.vibrations</span> <span class="kn">import</span> <span class="n">Vibrations</span>
<span class="kn">from</span> <span class="nn">ase.thermochemistry</span> <span class="kn">import</span> <span class="n">IdealGasThermo</span>

<span class="n">atoms</span> <span class="o">=</span> <span class="n">molecule</span><span class="p">(</span><span class="s">&#39;N2&#39;</span><span class="p">)</span>
<span class="n">atoms</span><span class="o">.</span><span class="n">set_calculator</span><span class="p">(</span><span class="n">EMT</span><span class="p">())</span>
<span class="n">dyn</span> <span class="o">=</span> <span class="n">QuasiNewton</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
<span class="n">dyn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">electronicenergy</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>

<span class="n">vib</span> <span class="o">=</span> <span class="n">Vibrations</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
<span class="n">vib</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">vib_energies</span> <span class="o">=</span> <span class="n">vib</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>

<span class="n">thermo</span> <span class="o">=</span> <span class="n">IdealGasThermo</span><span class="p">(</span><span class="n">vib_energies</span><span class="o">=</span><span class="n">vib_energies</span><span class="p">,</span>
                        <span class="n">electronicenergy</span><span class="o">=</span><span class="n">electronicenergy</span><span class="p">,</span>
                        <span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span>
                        <span class="n">geometry</span><span class="o">=</span><span class="s">&#39;linear&#39;</span><span class="p">,</span>
                        <span class="n">symmetrynumber</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">get_gibbs_energy</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">101325.</span><span class="p">)</span>
</pre></div>
</div>
<p>This will give the thermodynamic summary output:</p>
<div class="highlight-python"><div class="highlight"><pre>Enthalpy components at T = 298.15 K:
===============================
E_elec                 0.263 eV
E_ZPE                  0.076 eV
Cv_trans (0-&gt;T)        0.039 eV
Cv_rot (0-&gt;T)          0.026 eV
Cv_vib (0-&gt;T)          0.000 eV
(C_v -&gt; C_p)           0.026 eV
-------------------------------
H                      0.429 eV
===============================

Entropy components at T = 298.15 K and P = 101325.0 Pa:
=================================================
                           S               T*S
S_trans (1 atm)    0.0015579 eV/K        0.464 eV
S_rot              0.0004101 eV/K        0.122 eV
S_elec             0.0000000 eV/K        0.000 eV
S_vib              0.0000016 eV/K        0.000 eV
S (1 atm -&gt; P)    -0.0000000 eV/K       -0.000 eV
-------------------------------------------------
S                  0.0019695 eV/K        0.587 eV
=================================================

Free energy components at T = 298.15 K and P = 101325.0 Pa:
=======================
    H          0.429 eV
 -T*S         -0.587 eV
-----------------------
    G         -0.158 eV
=======================
</pre></div>
</div>
</div>
</div>
<div class="section" id="harmonic-limit">
<h2>Harmonic limit<a class="headerlink" href="#harmonic-limit" title="Permalink to this headline">¶</a></h2>
<p>In the harmonic limit, all degrees of freedom are treated harmonically. The
<a class="reference internal" href="#ase.thermochemistry.HarmonicThermo" title="ase.thermochemistry.HarmonicThermo"><tt class="xref py py-class docutils literal"><span class="pre">HarmonicThermo</span></tt></a> class supports the calculation of internal energy,
entropy, and Gibbs free energy. This class uses all of the energies given to
it in the vib_energies list; this is a list as can be generated with the
.get_energies() method of <a class="reference internal" href="../vibrations.html#ase.vibrations.Vibrations" title="ase.vibrations.Vibrations"><tt class="xref py py-class docutils literal"><span class="pre">ase.vibrations.Vibrations</span></tt></a>, but the user
should take care that all of these energies are real (non-imaginary). The
class <a class="reference internal" href="#ase.thermochemistry.HarmonicThermo" title="ase.thermochemistry.HarmonicThermo"><tt class="xref py py-class docutils literal"><span class="pre">HarmonicThermo</span></tt></a> has the interface described below.</p>
<dl class="class">
<dt id="ase.thermochemistry.HarmonicThermo">
<em class="property">class </em><tt class="descclassname">ase.thermochemistry.</tt><tt class="descname">HarmonicThermo</tt><big>(</big><em>vib_energies</em>, <em>electronicenergy=None</em><big>)</big><a class="reference internal" href="../../_modules/ase/thermochemistry.html#HarmonicThermo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.thermochemistry.HarmonicThermo" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for calculating thermodynamic properties in the approximation
that all degrees of freedom are treated harmonically. Often used for
adsorbates.</p>
<p>Inputs:</p>
<dl class="docutils">
<dt>vib_energies <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>a list of the harmonic energies of the adsorbate (e.g., from
ase.vibrations.Vibrations.get_energies). The number of
energies should match the number of degrees of freedom of the
adsorbate; i.e., 3*n, where n is the number of atoms. Note that
this class does not check that the user has supplied the correct
number of energies. Units of energies are eV.</dd>
<dt>electronicenergy <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>the electronic energy in eV
(if electronicenergy is unspecified, then the methods of this
class can be interpreted as the energy corrections)</dd>
</dl>
<dl class="method">
<dt id="ase.thermochemistry.HarmonicThermo.get_entropy">
<tt class="descname">get_entropy</tt><big>(</big><em>temperature</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../../_modules/ase/thermochemistry.html#HarmonicThermo.get_entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.thermochemistry.HarmonicThermo.get_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the entropy, in eV/K, in the harmonic approximation
at a specified temperature (K).</p>
</dd></dl>

<dl class="method">
<dt id="ase.thermochemistry.HarmonicThermo.get_gibbs_energy">
<tt class="descname">get_gibbs_energy</tt><big>(</big><em>temperature</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../../_modules/ase/thermochemistry.html#HarmonicThermo.get_gibbs_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.thermochemistry.HarmonicThermo.get_gibbs_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Gibbs free energy, in eV, in the harmonic
approximation at a specified temperature (K).</p>
</dd></dl>

<dl class="method">
<dt id="ase.thermochemistry.HarmonicThermo.get_internal_energy">
<tt class="descname">get_internal_energy</tt><big>(</big><em>temperature</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../../_modules/ase/thermochemistry.html#HarmonicThermo.get_internal_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.thermochemistry.HarmonicThermo.get_internal_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the internal energy, in eV, in the harmonic approximation
at a specified temperature (K).</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="crystals">
<h2>Crystals<a class="headerlink" href="#crystals" title="Permalink to this headline">¶</a></h2>
<p>In this model a crystalline solid is treated as a periodic system of
independent harmonic oscillators. The <a class="reference internal" href="#ase.thermochemistry.CrystalThermo" title="ase.thermochemistry.CrystalThermo"><tt class="xref py py-class docutils literal"><span class="pre">CrystalThermo</span></tt></a> class supports
the calculation of internal energy (<span class="math">\(U\)</span>), entropy (<span class="math">\(S\)</span>) and
Helmholtz free energy (<span class="math">\(F\)</span>), and has the interface listed below.</p>
<dl class="class">
<dt id="ase.thermochemistry.CrystalThermo">
<em class="property">class </em><tt class="descclassname">ase.thermochemistry.</tt><tt class="descname">CrystalThermo</tt><big>(</big><em>phonon_DOS</em>, <em>phonon_energies</em>, <em>formula_units=None</em>, <em>electronicenergy=None</em><big>)</big><a class="reference internal" href="../../_modules/ase/thermochemistry.html#CrystalThermo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.thermochemistry.CrystalThermo" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for calculating thermodynamic properties of a crystalline
solid in the approximation that a lattice of N atoms behaves as a
system of 3N independent harmonic oscillators.</p>
<p>Inputs:</p>
<dl class="docutils">
<dt>phonon_DOS <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>a list of the phonon density of states,
where each value represents the phonon DOS at the vibrational energy
value of the corresponding index in phonon_energies.</dd>
<dt>phonon_energies <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>a list of the range of vibrational energies (hbar*omega) over which
the phonon density of states has been evaluated. This list should be
the same length as phonon_DOS and integrating phonon_DOS over
phonon_energies should yield approximately 3N, where N is the number
of atoms per unit cell. If the first element of this list is
zero-valued it will be deleted along with the first element of
phonon_DOS. Units of vibrational energies are eV.</dd>
<dt>electronicenergy <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>the electronic energy in eV
(if electronicenergy is unspecified, then the methods of this
class can be interpreted as the phonon energy corrections.)</dd>
<dt>formula_units <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>the number of formula units per unit cell. If unspecified, the
thermodynamic quantities calculated will be listed on a
per-unit-cell basis.</dd>
</dl>
<dl class="method">
<dt id="ase.thermochemistry.CrystalThermo.get_entropy">
<tt class="descname">get_entropy</tt><big>(</big><em>temperature</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../../_modules/ase/thermochemistry.html#CrystalThermo.get_entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.thermochemistry.CrystalThermo.get_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the entropy, in eV/K, of crystalline solid
at a specified temperature (K).</p>
</dd></dl>

<dl class="method">
<dt id="ase.thermochemistry.CrystalThermo.get_helmholtz_energy">
<tt class="descname">get_helmholtz_energy</tt><big>(</big><em>temperature</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../../_modules/ase/thermochemistry.html#CrystalThermo.get_helmholtz_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.thermochemistry.CrystalThermo.get_helmholtz_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Helmholtz free energy, in eV, of crystalline solid
at a specified temperature (K).</p>
</dd></dl>

<dl class="method">
<dt id="ase.thermochemistry.CrystalThermo.get_internal_energy">
<tt class="descname">get_internal_energy</tt><big>(</big><em>temperature</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../../_modules/ase/thermochemistry.html#CrystalThermo.get_internal_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ase.thermochemistry.CrystalThermo.get_internal_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the internal energy, in eV, of crystalline solid
at a specified temperature (K).</p>
</dd></dl>

</dd></dl>

<div class="section" id="id1">
<h3>Example<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#ase.thermochemistry.CrystalThermo" title="ase.thermochemistry.CrystalThermo"><tt class="xref py py-class docutils literal"><span class="pre">CrystalThermo</span></tt></a> class will generally be called after an energy
optimization and a phonon vibrational analysis of the crystal. An example for
bulk gold is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ase.lattice.spacegroup</span> <span class="kn">import</span> <span class="n">crystal</span>
<span class="kn">from</span> <span class="nn">ase.calculators.emt</span> <span class="kn">import</span> <span class="n">EMT</span>
<span class="kn">from</span> <span class="nn">ase.optimize</span> <span class="kn">import</span> <span class="n">QuasiNewton</span>
<span class="kn">from</span> <span class="nn">ase.phonons</span> <span class="kn">import</span> <span class="n">Phonons</span>
<span class="kn">from</span> <span class="nn">ase.thermochemistry</span> <span class="kn">import</span> <span class="n">CrystalThermo</span>

<span class="c"># Set up gold bulk and attach EMT calculator</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">4.078</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">crystal</span><span class="p">(</span><span class="s">&#39;Au&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span>
                <span class="n">spacegroup</span> <span class="o">=</span> <span class="mi">225</span><span class="p">,</span>
                <span class="n">cellpar</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
                <span class="n">pbc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">EMT</span><span class="p">()</span>
<span class="n">atoms</span><span class="o">.</span><span class="n">set_calculator</span><span class="p">(</span><span class="n">calc</span><span class="p">)</span>
<span class="n">qn</span> <span class="o">=</span> <span class="n">QuasiNewton</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
<span class="n">qn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">electronicenergy</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>

<span class="c"># Phonon analysis</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">ph</span> <span class="o">=</span> <span class="n">Phonons</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">calc</span><span class="p">,</span> <span class="n">supercell</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">ph</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">ph</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">acoustic</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">phonon_energies</span><span class="p">,</span> <span class="n">phonon_DOS</span> <span class="o">=</span> <span class="n">ph</span><span class="o">.</span><span class="n">dos</span><span class="p">(</span><span class="n">kpts</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">npts</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span>
                                     <span class="n">delta</span><span class="o">=</span><span class="mf">5e-4</span><span class="p">)</span>

<span class="c"># Calculate the Helmholtz free energy</span>
<span class="n">thermo</span> <span class="o">=</span> <span class="n">CrystalThermo</span><span class="p">(</span><span class="n">phonon_energies</span><span class="o">=</span><span class="n">phonon_energies</span><span class="p">,</span>
                       <span class="n">phonon_DOS</span> <span class="o">=</span> <span class="n">phonon_DOS</span><span class="p">,</span>
                       <span class="n">electronicenergy</span> <span class="o">=</span> <span class="n">electronicenergy</span><span class="p">,</span>
                       <span class="n">formula_units</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">get_helmholtz_energy</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mf">298.15</span><span class="p">)</span>
</pre></div>
</div>
<p>This will give the thermodynamic summary output:</p>
<div class="highlight-python"><div class="highlight"><pre>Internal energy components at T = 298.15 K,
on a per-formula-unit basis:
===============================
E_elec                0.0022 eV
E_ZPE                 0.0135 eV
E_phonon              0.0629 eV
-------------------------------
U                     0.0786 eV
===============================

Entropy components at T = 298.15 K,
on a per-formula-unit basis:
=================================================
                           S               T*S
-------------------------------------------------
S                  0.0005316 eV/K       0.1585 eV
=================================================

Helmholtz free energy components at T = 298.15 K,
on a per-formula-unit basis:
=======================
    U         0.0786 eV
 -T*S        -0.1585 eV
-----------------------
    F        -0.0799 eV
=======================
</pre></div>
</div>
</div>
</div>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p><strong>Ideal gas.</strong> The conversion of electronic structure calculations to
thermodynamic properties in the ideal-gas limit is well documented; see, for
example, Chapter 10 of Cramer, 2004. The key equations used in the
<a class="reference internal" href="#ase.thermochemistry.IdealGasThermo" title="ase.thermochemistry.IdealGasThermo"><tt class="xref py py-class docutils literal"><span class="pre">IdealGasThermo</span></tt></a> class are summarized here.</p>
<blockquote>
<div>C.J. Cramer. <em>Essentials of Computational Chemistry</em>, Second Edition.
Wiley, 2004.</div></blockquote>
<p>The ideal-gas enthalpy is calculated from extrapolation of the energy at 0 K
to the relevant temperature (for an ideal gas, the enthalpy is not a function
of pressure):</p>
<div class="math">
\[H(T) = E_\text{elec} + E_\text{ZPE} + \int_0^\text{T} C_P \, \text{d}T\]</div>
<p>where the first two terms are the electronic energy and the zero-point energy, and the integral is over the constant-pressure heat capacity. The heat capacity is separable into translational, rotational, vibrational, and electronic parts (plus a term of <span class="math">\(k_\text{B}\)</span> to switch from constant-volume to constant-pressure):</p>
<div class="math">
\[C_P = k_\text{B} + C_{V\text{,trans}} + C_{V\text{,rot}} + C_{V\text{,vib}} + C_{V\text{,elec}}\]</div>
<p>The translational heat capacity is 3/2 <span class="math">\(k_\text{B}\)</span> for a 3-dimensional
gas. The rotational heat capacity is 0 for a monatomic species,
<span class="math">\(k_\text{B}\)</span> for a linear molecule, and 3/2 <span class="math">\(k_\text{B}\)</span> for a
nonlinear molecule. In this module, the electronic component of the heat
capacity is assumed to be 0. The vibrational heat capacity contains
<span class="math">\(3N-6\)</span> degrees of freedom for nonlinear molecules and <span class="math">\(3N-5\)</span>
degrees of freedom for linear molecules (where <span class="math">\(N\)</span> is the number of
atoms). The integrated form of the vibrational heat capacity is:</p>
<div class="math">
\[\int_0^T C_{V,\text{vib}} \text{d}T = \sum_i^\text{vib DOF}
\frac{\epsilon_i}{e^{\epsilon_i / k_\text{B} T} - 1 }\]</div>
<p>where <span class="math">\(\epsilon_i\)</span> are the energies associated with the vibrational
frequencies, <span class="math">\(\epsilon_i = h \omega_i\)</span>.</p>
<p>The ideal gas entropy can be calculated as a function of temperature and
pressure as:</p>
<div class="math">
\[\begin{split}S(T,P) &amp;= S(T,P^\circ) - k_\text{B} \ln \frac{P}{P^\circ} \\
       &amp;= S_\text{trans} + S_\text{rot} + S_\text{elec} + S_\text{vib} - k_\text{B} \ln \frac{P}{P^\circ}\end{split}\]</div>
<p>where the translational, rotational, electronic, and vibrational components
are calculated as below. (Note that the translational component also includes
components from the Stirling approximation, and that the vibrational degrees
of freedom are enumerated the same as in the above.)</p>
<div class="math">
\[S_\text{trans} = k_\text{B} \left\{ \ln \left[ \left(
\frac{2 \pi M k_\text{B} T}{h^2} \right)^{3/2}
\frac{k_\text{B} T}{P^\circ} \right] + \frac{5}{2} \right\}\]</div>
<div class="math">
\[\begin{split}S_\text{rot} = \left\{  \begin{array}{ll}
0 &amp; \text{, if monatomic} \\
k_\text{B} \left[ \ln \left( \frac{8\pi^2 I k_\text{B}T}{\sigma h^2}\right) + 1 \right] &amp; \text{, if linear} \\
k_\text{B} \left\{ \ln \left[ \frac{\sqrt{\pi I_\text{A} I_\text{B} I_\text{C}}}{\sigma} \left(\frac{8\pi^2 k_\text{B} T}{h^2}\right)^{3/2}\right] + \frac{3}{2} \right\} &amp; \text{, if nonlinear} \\
\end{array}
\right.\end{split}\]</div>
<div class="math">
\[S_\text{vib} = k_\text{B} \sum_i^\text{vib DOF}
\left[ \frac{\epsilon_i}{k_\text{B}T\left(e^{\epsilon_i/k_\text{B}T}-1\right)} - \ln \left( 1 - e^{-\epsilon_i/k_\text{B}T} \right)\right]\]</div>
<div class="math">
\[S_\text{elec} = k_\text{B} \ln \left[
2 \times \left(\text{spin multiplicity}\right) + 1\right]\]</div>
<p><span class="math">\(I_\text{A}\)</span> through <span class="math">\(I_\text{C}\)</span> are the three principle moments
of inertia for a non-linear molecule. <span class="math">\(I\)</span> is the degenerate moment of
inertia for a linear molecule. <span class="math">\(\sigma\)</span> is the symmetry number of the
molecule.</p>
<p>The ideal-gas Gibbs free energy is then just calculated from the combination
of the enthalpy and entropy:</p>
<div class="math">
\[G(T,P) = H(T) - T\, S(T,P)\]</div>
<p><strong>Harmonic limit.</strong> The conversion of electronic structure calculation
information into thermodynamic properties is less established for adsorbates.
However, the simplest approach often taken is to treat all <span class="math">\(3N\)</span> degrees
of freedom of the adsorbate harmonically since the adsorbate often has no
real translational or rotational degrees of freedom. This is the approach
implemented in the <a class="reference internal" href="#ase.thermochemistry.HarmonicThermo" title="ase.thermochemistry.HarmonicThermo"><tt class="xref py py-class docutils literal"><span class="pre">HarmonicThermo</span></tt></a> class. Thus,
the internal energy and entropy of the adsorbate are calculated as</p>
<div class="math">
\[U(T) = E_\text{elec} + E_\text{ZPE} + \sum_i^\text{harm DOF} \frac{\epsilon_i}{e^{\epsilon_i / k_\text{B} T} - 1 }\]</div>
<div class="math">
\[S = k_\text{B} \sum_i^\text{harm DOF}
\left[ \frac{\epsilon_i}{k_\text{B}T\left(e^{\epsilon_i/k_\text{B}T}-1\right)} - \ln \left( 1 - e^{-\epsilon_i/k_\text{B}T} \right)\right]\]</div>
<p>and the Gibbs free energy is calculated as</p>
<div class="math">
\[G(T) = U(T) - T\, S(T)\]</div>
<p>In this case, the number of harmonic energies (<span class="math">\(\epsilon_i\)</span>) used in
the summation is generally <span class="math">\(3N\)</span>, where <span class="math">\(N\)</span> is the number of atoms
in the adsorbate.</p>
<p><strong>Crystalline solid</strong></p>
<p>The derivation of the partition function for a crystalline solid is fairly
straight-forward and can be found, for example, in Chapter 11 of McQuarrie,
2000.</p>
<blockquote>
<div>D.A. McQuarrie. <em>Statistical Mechanics</em>. University Science Books, 2000.</div></blockquote>
<p>The treatment implemented in the <a class="reference internal" href="#ase.thermochemistry.CrystalThermo" title="ase.thermochemistry.CrystalThermo"><tt class="xref py py-class docutils literal"><span class="pre">CrystalThermo</span></tt></a> class depends on
introducing normal coordinates to the entire crystal and treating each atom
in the lattice as an independent harmonic oscillator. This yields the
partition function</p>
<div class="math">
\[Z = \prod_{j=1}^\text{3N} \left( \frac{e^{-\frac{1}{2}\hbar\omega_j\beta}}{1 - e^{-\hbar\omega_j\beta}} \right) e^{-E_\text{elec} \beta}\]</div>
<p>where <span class="math">\(\omega_j\)</span> are the <span class="math">\(3N\)</span> vibrational frequencies,
<span class="math">\(E_\text{elec}\)</span> is the electronic energy of the crystalline solid, and
<span class="math">\(\beta = \frac{1}{k_\text{B} T}\)</span>. Now, taking the logarithm of the
partition function and replacing the resulting sum with an integral (assuming
that the energy level spacing is essentially continuous) gives</p>
<div class="math">
\[-\ln Z = E_\text{elec}\beta + \int_0^\infty \left[ \ln \left( 1 - e^{-\hbar\omega\beta} \right) + \frac{\hbar\omega\beta}{2} \right]\sigma (\omega) \text{d}\omega\]</div>
<p>Here <span class="math">\(\sigma (\omega)\)</span> represents the degeneracy or phonon density of
states as a function of vibrational frequency. Once this function has been
determined (i.e. using the <a class="reference internal" href="../phonons.html#module-ase.phonons" title="ase.phonons"><tt class="xref py py-mod docutils literal"><span class="pre">ase.phonons</span></tt></a> module), it is a simple matter to
calculate the canonical ensemble thermodynamic quantities; namely the
internal energy, the entropy and the Helmholtz free energy.</p>
<div class="math">
\[\begin{split}U(T) &amp;= -\left( \frac{\partial \ln Z}{\partial \beta} \right)_\text{N,V} \\
     &amp;= E_\text{elec} + \int_0^\infty \left[ \frac{\hbar \omega}{e^{\hbar \omega \beta} - 1} + \frac{\hbar \omega}{2} \right]\sigma (\omega) \text{d}\omega\end{split}\]</div>
<div class="math">
\[\begin{split}S(T) &amp;= \frac{U}{T} + k_\text{B} \ln Z \\
     &amp;= \int_0^\infty \left[ \frac{\hbar \omega}{T} \frac{1}{e^{\hbar \omega \beta} - 1} - k_\text{B} \ln \left(1 - e^{-\hbar \omega \beta} \right) \right]\sigma (\omega) \text{d}\omega\end{split}\]</div>
<div class="math">
\[F(T) = U(T) - T\, S(T,P)\]</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">

          <h3>ASE</h3>
          <ul class="this-page-menu">
            <li><a href="../../overview.html">
              Overview</a></li>
            <li><a href="../../download.html">
              Installation</a></li>
            <li><a href="../../tutorials/tutorials.html">
              Tutorials</em></a></li>
            <li><a href="../ase.html">
              Documentation</a></li>
            <li><a href="../../faq.html">FAQ</a></li>
            <li><a href="../../mailinglists.html">Mailing lists</a></li>
            <li><a href="../../development/releasenotes.html">Release notes</a></li>
            <li><a href="../../licenseinfo.html">License info</a></li>
           </ul>
           <h3>Development</h3>
           <ul class="this-page-menu">
            <li><a href="../../development/development.html">
              Development</a></li>
            <li><a href="http://wiki.fysik.dtu.dk/ase/epydoc/ase-module.html">
              Epydoc</a></li>
            <li><a href="http://trac.fysik.dtu.dk/projects/ase/browser/trunk/">
              Source code (svn)</a></li>
            <li><a href="../../bugs.html">Bugs!</a></li>
            <li><a href="http://trac.fysik.dtu.dk/projects/ase/report/1">
              Bug Tracker</a></li>
            <li><a href="https://ase-buildbot.fysik.dtu.dk/waterfall">
              BuildBot</a></li>
          </ul>
            <h3>This Page</h3>
            <ul>
<li><a class="reference internal" href="#">Thermochemistry</a><ul>
<li><a class="reference internal" href="#ideal-gas-limit">Ideal-gas limit</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#harmonic-limit">Harmonic limit</a></li>
<li><a class="reference internal" href="#crystals">Crystals</a><ul>
<li><a class="reference internal" href="#id1">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#background">Background</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="../phasediagram/phasediagram.html" title="previous chapter">Phase diagrams and Pourbaix diagrams</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../infrared.html" title="next chapter">Infrared intensities</a></p>
            <ul class="this-page-menu">
              <li><a href="../../_sources/ase/thermochemistry/thermochemistry.txt">Show Source</a></li>
            </ul>
            <h3>Quick search</h3>
            <form class="search" action="../../search.html" method="get">
              <input type="text" name="q" size="18" /> <input type="submit" value="Go" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>



        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>



        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             accesskey="">modules</a> |</li>
        <a href="../../index.html"><img class="logo" src="../../_static/ase.ico" alt="Logo" align="absmiddle"/></a>
          <li><a href="../ase.html" accesskey="U">Documentation for modules in ASE</a> &raquo;</li>
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2015, CAMd.
      Last updated on Tue, 21 Jul 2015 11:00:40.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>