<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7614 2013-02-21 15:55:51Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document">


<div class="section" id="ulif-openoffice">
<h1><a class="toc-backref" href="#id9">ulif.openoffice</a></h1>
<p>Convert office docs with LibreOffice/OpenOffice via Python,
Commandline, or HTTP (including XMLRPC).</p>
<p><a class="reference external" href="https://travis-ci.org/ulif/ulif.openoffice"><img alt="build-status" src="https://travis-ci.org/ulif/ulif.openoffice.png?branch=master" /></a></p>
<p>This package provides tools like WSGI apps, cache managers, and
commandline converters to ease access to LibreOffice/OpenOffice
installations for Python programmers. Beside basic converting it
provides 'document processors' for further finetuning of generated
docs (mainly HTML).</p>
<p>Out of the box these processors allow extracting CSS from HTML
conversions, removal of LibreOffice-specific tags, zipping, unzipping,
etc.</p>
<p>If the given processors are not enough for you, or you want some
special handling of results (say, sign generated docs
cryptographically, add watermarks, or whatever), you can define own
additional document processors in your own packages by using the
Python entry-point API. <cite>ulif.openoffice</cite> will integrate them
automatically during document processing and provide them in
webservices, commandline clients and Python API.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>ulif.openoffice</cite> trusts <cite>unoconv</cite> to do the actual
conversions. So you must have the <cite>unoconv</cite> script installed
on your system.</p>
</div>
<div class="section" id="resources">
<h2><a class="toc-backref" href="#id10">Resources</a></h2>
<p><cite>ulif.openoffice</cite> sources are hosted on</p>
<blockquote>
<a class="reference external" href="https://github.com/ulif/ulif.openoffice">https://github.com/ulif/ulif.openoffice</a></blockquote>
<p>The complete documentation can be found at</p>
<blockquote>
<a class="reference external" href="https://ulif-openoffice.readthedocs.org/en/latest/">https://ulif-openoffice.readthedocs.org/en/latest/</a></blockquote>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#ulif-openoffice" id="id9">ulif.openoffice</a><ul>
<li><a class="reference internal" href="#resources" id="id10">Resources</a></li>
<li><a class="reference internal" href="#examples" id="id11">Examples</a><ul>
<li><a class="reference internal" href="#conversion-via-python" id="id12">Conversion via Python</a></li>
<li><a class="reference internal" href="#conversion-via-commandline" id="id13">Conversion via Commandline</a></li>
<li><a class="reference internal" href="#conversion-via-web-xmlrpc-or-restful" id="id14">Conversion via Web (XMLRPC or RESTful)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install" id="id15">Install</a><ul>
<li><a class="reference internal" href="#user-install" id="id16">User Install</a></li>
<li><a class="reference internal" href="#developer-install" id="id17">Developer Install</a></li>
</ul>
</li>
<li><a class="reference internal" href="#license" id="id18">License</a></li>
<li><a class="reference internal" href="#author" id="id19">Author</a></li>
</ul>
</li>
<li><a class="reference internal" href="#changes" id="id20">CHANGES</a><ul>
<li><a class="reference internal" href="#id1" id="id21">1.1.1 (2015-07-23)</a></li>
<li><a class="reference internal" href="#id2" id="id22">1.1 (2015-07-12)</a></li>
<li><a class="reference internal" href="#id3" id="id23">1.0 (2013-09-02)</a></li>
<li><a class="reference internal" href="#id4" id="id24">0.4 (2011-02-11)</a></li>
<li><a class="reference internal" href="#id5" id="id25">0.3 (2010-11-17)</a></li>
<li><a class="reference internal" href="#id6" id="id26">0.2.1 (2010-06-13)</a></li>
<li><a class="reference internal" href="#id7" id="id27">0.2 (2010-05-20)</a></li>
<li><a class="reference internal" href="#id8" id="id28">0.1 (2010-03-02)</a></li>
</ul>
</li>
</ul>
</div>
<!-- >>> from ulif.openoffice.testing import (
...     doctest_setup, doctest_teardown, doctest_rm_resultdir)
>>> doctest_setup()
>>> from pprint import pprint -->
</div>
<div class="section" id="examples">
<h2><a class="toc-backref" href="#id11">Examples</a></h2>
<div class="section" id="conversion-via-python">
<h3><a class="toc-backref" href="#id12">Conversion via Python</a></h3>
<p>A .doc to .html conversion via the Python API can be done like this:</p>
<pre class="literal-block">
&gt;&gt;&gt; from ulif.openoffice.client import Client
&gt;&gt;&gt; client = Client()
&gt;&gt;&gt; result = client.convert('document.doc')
&gt;&gt;&gt; pprint(result)
('.../document.html.zip', None, {'error': False, 'oocp_status': 0})
</pre>
<!-- >>> doctest_rm_resultdir(result[0])         # clean up -->
<p>The generated document is by default brushed up HTML with separate
stylesheets and images all put into a single .zip document.</p>
<p>You can configure the document conversion via various options. This
way you can set the output type (at least PDF, HTML, XHTML and TXT are
supported), tell whether separate CSS stylesheets should be extracted,
which PDF format should be generated (1.3 aka PDF/A or 1.4), and many,
many things more.</p>
</div>
<div class="section" id="conversion-via-commandline">
<h3><a class="toc-backref" href="#id13">Conversion via Commandline</a></h3>
<p>We also provide a handy commandline tool to perform conversions:</p>
<pre class="literal-block">
$ oooclient document.doc
RESULT in /tmp/.../document.html.zip
</pre>
<p>As you can see, the result is put in a freshly created directory.</p>
<p>The commandline client also provides help to display all supported
options, document processors, etc.:</p>
<pre class="literal-block">
$ oooclient --help
</pre>
<p>will give you the comprehensive list.</p>
</div>
<div class="section" id="conversion-via-web-xmlrpc-or-restful">
<h3><a class="toc-backref" href="#id14">Conversion via Web (XMLRPC or RESTful)</a></h3>
<p><cite>ulif.openoffice</cite> comes with two WSGI applications that provide
document conversion services to web clients. One is a RESTful document
conversion service, the other is a WSGI based XMLRPC server. With one
of these applications running you can send office documents to a
server and will receive the converted document.</p>
<p>All WSGI document converters supports (optional) local caching which
will store conversion results and deliver it (bypassing new
conversion) if a document was requested to be converted already.</p>
<p>The package comes with prepared configuration files to setup and start
such a web-based document converter in minutes.</p>
<p>See the extended docs under</p>
<blockquote>
<a class="reference external" href="https://ulif-openoffice.readthedocs.org/en/latest/">https://ulif-openoffice.readthedocs.org/en/latest/</a></blockquote>
<p>for details.</p>
</div>
</div>
<div class="section" id="install">
<h2><a class="toc-backref" href="#id15">Install</a></h2>
<div class="section" id="user-install">
<h3><a class="toc-backref" href="#id16">User Install</a></h3>
<p><cite>ulif.openoffice</cite> can be installed via <cite>pip</cite>:</p>
<pre class="literal-block">
$ pip install ulif.openoffice
</pre>
<p>Afterwards all commandline tools should be available.</p>
</div>
<div class="section" id="developer-install">
<h3><a class="toc-backref" href="#id17">Developer Install</a></h3>
<p>It is recommended to setup sources in a virtual environment:</p>
<pre class="literal-block">
$ virtualenv py27      # Python 2.6, 2.7 are supported
$ source py27/bin/activate
(py27) $
</pre>
<p>Get the sources:</p>
<pre class="literal-block">
(py27) $ git clone https://github.com/ulif/ulif.openoffice.git
(py27) $ cd ulif.openoffice
</pre>
<p>Install packages for testing:</p>
<pre class="literal-block">
(py27) $ python setup.py dev
</pre>
<p>It is recommended to start the <tt class="docutils literal">oooctl</tt> daemon before running
tests:</p>
<pre class="literal-block">
(py27) $ oooctl start
</pre>
<p>This will make LibreOffice listen in background and reduce
runtime of tests significantly.</p>
<p>Running tests:</p>
<pre class="literal-block">
(py27) $ py.test
</pre>
<p>We also support <cite>tox</cite> to run tests for all supported Python versions:</p>
<pre class="literal-block">
(py27) $ pip install tox
(py27) $ tox
</pre>
<p>Of course you must have the respective Python versions installed
(currently: Python 2.6, 2.7).</p>
<p>Running coverage detector:</p>
<pre class="literal-block">
(py27) $ py.test --cov=ulif.openoffice    # for cmdline results
(py27) $ py.test --cov=ulif.openoffice --cov-report=html
</pre>
<p>The latter will generate HTML coverage reports in a subdirectory.</p>
<p>Install packages for Sphinx-base documentation:</p>
<pre class="literal-block">
(py27) $ python setup.py docs
(py27) $ cd doc
(py27) $ make html
</pre>
<p>Will generate the documentation in a subdirectory.</p>
</div>
</div>
<div class="section" id="license">
<h2><a class="toc-backref" href="#id18">License</a></h2>
<p><cite>ulif.openoffice</cite> is covered by the GPL version 2.</p>
</div>
<div class="section" id="author">
<h2><a class="toc-backref" href="#id19">Author</a></h2>
<p>By Uli Fouquet (uli at gnufix dot de). Please do not hesitate to
contact me for wishes, requests, suggestions, or other questions.</p>
<!-- >>> doctest_teardown() -->
</div>
</div>
<div class="section" id="changes">
<h1><a class="toc-backref" href="#id20">CHANGES</a></h1>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id21">1.1.1 (2015-07-23)</a></h2>
<ul class="simple">
<li>Close file handles properly.</li>
<li>The commandline client now only handles one input file and does not
copy whole directory contents any more.</li>
</ul>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id22">1.1 (2015-07-12)</a></h2>
<ul class="simple">
<li>Added a WSGI-based XMLRPC application to trigger conversion via
XMLRPC.</li>
<li>Added <cite>get_cached</cite> method for client and XMLRPC client to retrieve
docs stored in cache.</li>
<li>Added <cite>get_cached_file_by_source</cite> method for cachemanager. This method
is expensive but allows finding cached files without a cache key.</li>
<li>Fixed bug: OOCP processor returned wrong result file path for XHTML
output.</li>
<li>Fixed bug: Remove temporary dir if converting fails in client.</li>
<li>Modified tests to accept also docs generated on Ubuntu 14.04.</li>
<li>Fixed bug: Catch shutil.Error in copytree() [thanks to: sbywater]</li>
<li>Added new option: <cite>--css-cleaner-prettify-html</cite> prettifies generated
HTML code. This was done automatically  in previous releases and can
lead to gaps in rendered output. This option, when set (disabled by
default) enables the old behaviour. Fixes #3.</li>
</ul>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id23">1.0 (2013-09-02)</a></h2>
<p>Major rewrite of the whole package.</p>
<ul class="simple">
<li><cite>convert</cite> now uses the commandline tool <cite>unoconv</cite>. You need this
tool to use the package.</li>
<li>As <cite>unoconv</cite> has all you want from the package script <cite>convert</cite> (and
much more!), the <cite>convert</cite> script is not provided as a script any
more. Simply use <cite>unoconv</cite> instead.</li>
<li><cite>oooctl</cite> is now a daemonizer for <tt class="docutils literal">unoconv <span class="pre">-l</span></tt>.</li>
<li>Apply PEP 8 rules to cachemanager.py.</li>
<li>Moved unittests to dedicated <tt class="docutils literal">tests/</tt> dir in package root.</li>
<li>Switched from Zope testing to <cite>py.test</cite>.</li>
<li>Removed <cite>pyuno</cite> server, clients and related components.</li>
<li>Removed <cite>find</cite> functionality as it is based on direct <cite>pyuno</cite> access.</li>
<li>Removed <cite>zc.buildout</cite> support.</li>
<li>Removed cherrypy-based restserver. The new WSGI app is the replacement.</li>
<li>Added WSGI based document converter.</li>
<li>Added simple htaccess WSGI filter for web authentication.</li>
<li>Replaced cachemanager with a more robust and lightweight
version. Old caches do not work any more with this new
implementation.</li>
<li>Introduced a new central <cite>Options</cite> component to manage supported
options for all other components.</li>
</ul>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id24">0.4 (2011-02-11)</a></h2>
<ul class="simple">
<li>Added functionality to find text in documents. Many thanks to sig at
akasig.org for the patch!</li>
</ul>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id25">0.3 (2010-11-17)</a></h2>
<ul class="simple">
<li>Added option to disable caching completely: set <tt class="docutils literal"><span class="pre">--cache-dir</span></tt> to
empty string to disable caching [Thanks to Adama Groszer for
patches!]</li>
<li>Removed unwanted output when running in foreground mode.</li>
<li>Cachemanager now supports listing all sources contained in cache
dir.</li>
<li>Fixed bug in cachemanager: under rare circumstances (two different
input files with same MD5 hash digest <em>and</em> identical file stats
were considered to be identical by the cachemanager and thus led to
inconsistencies in cache). We now check thoroughly whether two such
files differ.</li>
<li>Lots of test fixes [Thanks to Adam Groszer for patches!]</li>
</ul>
</div>
<div class="section" id="id6">
<h2><a class="toc-backref" href="#id26">0.2.1 (2010-06-13)</a></h2>
<ul class="simple">
<li>Fixed fix to cope with pyuno monkey-patching standard __import__
function. More recent pyuno versions do not do that kind of stuff
any more (which is an improvement).</li>
<li>Fixed foreground start of <tt class="docutils literal">`oooctl`</tt> server. It didn't work
correctly with more recent OpenOffice.org/pyuno installs. You now
don't have to press CTRL-C two times anymore when trying to stop a
oooctl server running in foreground.</li>
</ul>
</div>
<div class="section" id="id7">
<h2><a class="toc-backref" href="#id27">0.2 (2010-05-20)</a></h2>
<ul class="simple">
<li>Added license and copyright file to comply with policy of major
Linux distributors.</li>
<li>Added sphinx docs.</li>
<li>Fixed wrong result path when returning cached HTML results.</li>
<li>Added mode <tt class="docutils literal">fg</tt> for <tt class="docutils literal">oooctl</tt>. Using <tt class="docutils literal">oooctl fg</tt> one can start
<tt class="docutils literal">oooctl</tt> in foreground now.</li>
<li>Added mode <tt class="docutils literal">fg</tt> for <tt class="docutils literal">pyunoctl</tt>. Using <tt class="docutils literal">pyunoctl fg</tt> one can start
<tt class="docutils literal">pyunoctl</tt> in foreground now.</li>
<li>Added state check for <tt class="docutils literal">oooctl</tt>: when OpenOffice.org server is down
during runtime it is restarted automatically. The check happens
every second.</li>
<li>Use standard lib <cite>doctest</cite> instead of <cite>zope.testing.doctest</cite>.</li>
<li>Changed PDF creation: by default now normal PDF (and not PDF/A) is
created when converting to PDF. This is due to an endianess bug in
many recent OpenOffice.org binaries running on 64-bit platforms.</li>
</ul>
</div>
<div class="section" id="id8">
<h2><a class="toc-backref" href="#id28">0.1 (2010-03-02)</a></h2>
<ul class="simple">
<li>Initial implementation.</li>
</ul>
</div>
</div>
</div>
</body>
</html>
