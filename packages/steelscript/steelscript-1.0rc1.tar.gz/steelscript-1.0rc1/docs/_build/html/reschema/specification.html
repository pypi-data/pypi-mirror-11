<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Service Definition Specification &mdash; steelscript  documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/extra.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="steelscript  documentation" href="../index.html" />
    <script type="text/javascript" src="//nexus.ensighten.com/riverbed/rvbss/Bootstrap.js"></script>
     

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">steelscript  documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="service-definition-specification">
<h1>Service Definition Specification<a class="headerlink" href="#service-definition-specification" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This document describes a schema for defining a REST API.  This schema,
also known as a service definition, is designed with the following goals
in mind:</p>
<ul class="simple">
<li>Web-browsable and searchable documentation across all products and
versions</li>
<li>Product / service specific REST APIs</li>
<li>Uniform structure for all resource calls</li>
<li>Support for automated document generation</li>
<li>Allow definition of hyperlinks between services</li>
<li>Enable validation and simplified REST usage via language specific
libraries</li>
</ul>
</div>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>REST APIs provide a popular and convenient menas of access to configuration
and monitoring of servers and services, but they are only as good as they
are usable by clients.  First and foremost, good documentation is required
and gives an important first impression that the APIs are well engineered
and supported.  Beyond good documentation, good supporting client libraries
further enhance the programmer&#8217;s experience in interacting with an API.</p>
<div class="section" id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h3>
<p>REST API documentation, like documenting SOAP or SNMP, is often a painful
and laborious process.  A fully featured API for a product may involve hundreds
of calls that need to be properly documented, with more calls added with
each release.  For each call, the list of acceptable parameters must be
documented, as well as the format of request and response objects.</p>
<p>In addition, documenting the individual calls is often insufficient, as
accomplishing a task may requiring the caller to issue a series of calls.
For example, running a report on Profiler involves connecting to the device,
creating a report object with the appropriate criteria, polling for status
until the report is done, then retrieving the results.  Documenting such
tasks will often be the first place users will look to get an understanding
of how to interact with a device via REST APIs.</p>
<p>In products using v2.0 or later of our API definition schema, the documentation
strings are embedded directly in the schema, or referenced from the schema
in external files.  The schema also includes type information and value
constraints, all of which can be leveraged to produce documentation or
validate data.  Due to the standardized location of documentation within
the schema, documentation is generated automatically rather than
manually transferred into an external format.</p>
</div>
<div class="section" id="supporting-client-libraries">
<h3>Supporting Client Libraries<a class="headerlink" href="#supporting-client-libraries" title="Permalink to this headline">¶</a></h3>
<p>Working directly with REST APIs is a great improvement over technologies
like SNMP and SOAP.  It is possible to make REST calls directly with command
line tools such as <code class="docutils literal"><span class="pre">curl</span></code> and <code class="docutils literal"><span class="pre">wget</span></code>, or in many cases simply with a web
browser.</p>
<p>However, writing extensive programs by manually coding support for REST
can quickly get out of hand.  In particular, hand-crafting the URLs of
REST resources is similar to embedding magic numbers in code.  It&#8217;s doable
on a small scale, but it is error prone and difficult to maintain as the
application changes in size and the resource definitions change.</p>
<p>Many services that offer a REST API also provide client-side libraries that
mirror the REST API.  These libraries are often provided in multiple languages,
allowing client developers choice.  Use of the libraries enables developers
to work with interfaces and objects that are more native to the language
they are developing in, abstracting away the REST-ness of the API being
programmed against.</p>
<p>However, development and maintenance of the client libraries themselves can
become a burden on the server-side developers.  An out-of-date or incomplete
library is of no use to client developers.</p>
<p>As such, it is critical to enable the development of client-side
libraries that need minimal or perhaps <em>no</em> changes at all as APIs
change or new APIs become available.  This is made possible by the schema
supporting Hypertext As the Engine of Application State (HATEOAS) through
link and relationship definitions.</p>
</div>
</div>
<div class="section" id="specification">
<h2>Specification<a class="headerlink" href="#specification" title="Permalink to this headline">¶</a></h2>
<p>This specification defines a JSON object that fully describes the REST
resources associated with a single version of a service.  This JSON
object is referred to as the <code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code> is used to generate REST API documentation as well as
enable the development of client-side libraries that can parse the
schema and eliminate the hand-coding of resource URLs and links.</p>
<p>This schema will cover the following topics:</p>
<ul class="simple">
<li>Full resource specification</li>
<li>Specification for a distinct API version</li>
<li>Tasks that involve a series REST calls</li>
<li>Examples, etc.</li>
</ul>
<div class="section" id="documentation-conventions">
<h3>Documentation Conventions<a class="headerlink" href="#documentation-conventions" title="Permalink to this headline">¶</a></h3>
<p>This document uses <a class="reference external" href="https://tools.ietf.org/html/rfc2119">RFC 2119</a>-style
terminology, with the following specifics:</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>MUST</strong>:</dt>
<dd>Indicates that implementations MUST return an error if the condition
is not met.</dd>
<dt><strong>SHOULD</strong>:</dt>
<dd>Means that implementations MUST allow deviations from the condition,
but MAY issue a warning.  Tools supporting best practices such as
a linter MUST report non-conformance as a warning if non-conformance
can be detected (some conditions relay on outside knowledge of
the system such as whether combinations of fields create unique keys,
and therefore cannot be detected programmatically).</dd>
</dl>
</div></blockquote>
<p>In practice, MUST means that <code class="docutils literal"><span class="pre">reschema</span></code> requires it, and SHOULD
means that <code class="docutils literal"><span class="pre">reschema</span></code> does not require it but <code class="docutils literal"><span class="pre">relint</span></code> (the linter
for reschema) will complain about it if it possibly can.</p>
</div>
<div class="section" id="json-schema">
<h3>JSON Schema<a class="headerlink" href="#json-schema" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code> heavily relies on <a class="reference internal" href="jsonschema.html"><em>JSON Schema primer</em></a>
for describing data types.  Similar to C <code class="docutils literal"><span class="pre">struct</span></code>, at
a minimum a <code class="docutils literal"><span class="pre">json-schema</span></code> lays out all the elements and types of a
JSON object.</p>
<p>This representation is used to describe both simple strings and numbers as well
as complex data types in JSON.  The schema may also include documentation for
each attribute, as well as constraints on data values.</p>
<p>For example, the following simple <code class="docutils literal"><span class="pre">json-schema</span></code> defines a JSON object
representing an <code class="docutils literal"><span class="pre">address</span></code>:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;address&quot;</span><span class="p">,</span>
    <span class="nt">&quot;properties&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;street&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Street Address&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;city&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;City&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;state&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;State&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;[A-Z][A-Z]&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;zip&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Zip Code (5-digit)&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;[0-9][0-9][0-9][0-9][0-9]&quot;</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A JSON object conforming to this schema:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;street&quot;</span> <span class="p">:</span> <span class="s2">&quot;123 High Street&quot;</span><span class="p">,</span>
    <span class="nt">&quot;city&quot;</span> <span class="p">:</span> <span class="s2">&quot;Springfield&quot;</span><span class="p">,</span>
    <span class="nt">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;IL&quot;</span><span class="p">,</span>
    <span class="nt">&quot;zip&quot;</span><span class="p">:</span> <span class="s2">&quot;12345&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The examples in this document are presented in YAML format rather than JSON,
as YAML is easier to read and is close enough to JSON that there is no ambiguity
in meaning.  The YAML equivalent of the above examples is shown below:</p>
<p>Address schema in YAML:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
<span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">street</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span><span class="p-Indicator">,</span> <span class="nv">description</span><span class="p-Indicator">:</span> <span class="s">&quot;Street</span><span class="nv"> </span><span class="s">Address&quot;</span> <span class="p-Indicator">}</span>
   <span class="l-Scalar-Plain">city</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span><span class="p-Indicator">,</span> <span class="nv">description</span><span class="p-Indicator">:</span> <span class="s">&quot;City&quot;</span> <span class="p-Indicator">}</span>
   <span class="l-Scalar-Plain">state</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span><span class="p-Indicator">,</span> <span class="nv">description</span><span class="p-Indicator">:</span> <span class="s">&quot;State&quot;</span><span class="p-Indicator">,</span> <span class="nv">pattern</span><span class="p-Indicator">:</span> <span class="s">&quot;[A-Z][A-Z]&quot;</span> <span class="p-Indicator">}</span>
   <span class="l-Scalar-Plain">zip</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span><span class="p-Indicator">,</span> <span class="nv">description</span><span class="p-Indicator">:</span> <span class="s">&quot;Zip</span><span class="nv"> </span><span class="s">Code</span><span class="nv"> </span><span class="s">(5-digit)&quot;</span><span class="p-Indicator">,</span> <span class="nv">pattern</span><span class="p-Indicator">:</span> <span class="s">&quot;[0-9][0-9][0-9][0-9][0-9]&quot;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>Address object in YAML:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">street</span><span class="p-Indicator">:</span> <span class="s">&quot;123</span><span class="nv"> </span><span class="s">High</span><span class="nv"> </span><span class="s">Street&quot;</span>
<span class="l-Scalar-Plain">city</span><span class="p-Indicator">:</span> <span class="s">&quot;Springfield&quot;</span>
<span class="l-Scalar-Plain">state</span><span class="p-Indicator">:</span> <span class="s">&quot;IL&quot;</span>
<span class="l-Scalar-Plain">zip</span><span class="p-Indicator">:</span> <span class="s">&quot;12345&quot;</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="jsonschema.html"><em>JSON Schema primer</em></a> for a brief introduction and pointers to the IETF drafts.</p>
</div>
<div class="section" id="rest-api-service-definition-object-service-definition">
<h3>REST API Service Definition Object (<code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code>)<a class="headerlink" href="#rest-api-service-definition-object-service-definition" title="Permalink to this headline">¶</a></h3>
<p>This section describes the <code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code> object in detail.</p>
<div class="section" id="service-definition-object">
<h4>Service Definition Object<a class="headerlink" href="#service-definition-object" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code> object has the following structure:</p>
<div class="highlight-yaml"><div class="highlight"><pre>$schema: &lt;string&gt;,
id: &lt;string&gt;,
provider: &lt;provider&gt;
name: &lt;string&gt;,
version: &lt;string&gt;,
title: &lt;string&gt;,
description: &lt;string&gt;,
defaultAuthorization: &lt;string&gt;,
documentationLink: &lt;string&gt;,
types: { ... },
resources: { ... },
errors: [ ... ],
tasks: [ ... ],
</pre></div>
</div>
<p>The properties are defined as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">property</th>
<th class="head">type</th>
<th class="head">description</th>
<th class="head">notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>$schema</td>
<td>string</td>
<td>URI of the JSON Schema describing the format of this document</td>
<td>This document describes <a class="reference external" href="http://support.riverbed.com/api/service_def/2.3">http://support.riverbed.com/api/service_def/2.3</a></td>
</tr>
<tr class="row-odd"><td>id</td>
<td>string</td>
<td>URI where the official copy of this document can be found</td>
<td>Serves as the unique identifier for the service definition</td>
</tr>
<tr class="row-even"><td>provider</td>
<td>string</td>
<td>Identifier of the organization that authored this document</td>
<td>Riverbed service definitions use &#8216;riverbed&#8217;, other organizations must
use a globally unique identifier</td>
</tr>
<tr class="row-odd"><td>name</td>
<td>string</td>
<td>Name of the service provided by this REST API</td>
<td>Unique name within the namespace of the provider</td>
</tr>
<tr class="row-even"><td>version</td>
<td>string</td>
<td>Version string of the REST API described</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>title</td>
<td>string</td>
<td>One line description</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>description</td>
<td>string</td>
<td>More verbose description of the API</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>defaultAuthorization</td>
<td>string</td>
<td>Default authorization for all resources and links if not specified.</td>
<td>Valid values: required, optional, none</td>
</tr>
<tr class="row-even"><td>documentationLink</td>
<td>string</td>
<td>URL for online documentation for this API</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>types</td>
<td>object</td>
<td>common data types used by resource requests and/or responses</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>resources</td>
<td>object</td>
<td>resources schemas defined for the various REST resources supported</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>errors</td>
<td>array</td>
<td>documentation of possible error codes when resource requests fail</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>tasks</td>
<td>array</td>
<td>documentation of more complex tasks involving multiple resource calls</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p>The heart of the <code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code> object is in the <code class="docutils literal"><span class="pre">resources</span></code> section.</p>
</div>
<div class="section" id="service-definition-id">
<h4>Service definition &#8216;id&#8217;<a class="headerlink" href="#service-definition-id" title="Permalink to this headline">¶</a></h4>
<p>The &#8216;id&#8217; property serves two purposes:</p>
<blockquote>
<div><ol class="arabic simple">
<li>URI where the official copy of the service definition document can be found</li>
<li>Globally unique identifier for the service definition</li>
</ol>
</div></blockquote>
<p>As a unique identifier, the &#8216;id&#8217; is used when defining links and relations
to other services via the &#8216;$ref&#8217; or &#8216;resource&#8217; properties.</p>
<p>The Riverbed format for the &#8216;id&#8217; is show below:</p>
<blockquote>
<div><a class="reference external" href="http://support.riverbed.com/apis">http://support.riverbed.com/apis</a>/&lt;name&gt;/&lt;version&gt;</div></blockquote>
</div>
<div class="section" id="service-path">
<h4>Service Path<a class="headerlink" href="#service-path" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal"><span class="pre">service</span> <span class="pre">path</span></code> is the fully qualified path (URI) that is the base for all
REST resources of the same hosted service.</p>
<p>As a simple example, the following is the service path for a &#8216;bookstore&#8217;
service hosted by a server 10.1.2.3:</p>
<div class="highlight-python"><div class="highlight"><pre>https://10.1.2.3/api/bookstore/1.0
</pre></div>
</div>
<p>The service <em>path</em> is implementation specific and thus fully separate
from the service <em>definition</em>.  For this reason, the fully qualified
service <em>path</em> is not specified as part of the definition and is instead
replaced with the &#8216;$&#8217; character when defining the templates for building
URIs for the various resources that make up the service.</p>
<p>As will be described in more detail in later sections, each resource
definition includes a &#8216;self&#8217; link that defines the URI template for
this resource.  A &#8216;books&#8217; resource in the &#8216;bookstore&#8217; service might have the
following self link:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">books</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="s">&#39;$/books&#39;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>The &#8216;$&#8217; in the path must be replaced at runtime based with the fully qualified
service path.</p>
<p>Note that within a single network, a single service <em>definition</em> may
be implemented multiple times as different services, each with a unique service
<em>path</em>.  The <em>path</em> itself has a {server} component and a {relpath}:</p>
<div class="highlight-python"><div class="highlight"><pre>{server}{relpath}

https://10.1.2.3/api/bookstore/1.0

server := &#39;https://10.1.2.3&#39;
relpath := &#39;/api/bookstore/1.0&#39;
</pre></div>
</div>
<p>For example:</p>
<dl class="docutils">
<dt><strong>multiple instances on the same server</strong></dt>
<dd>The {relpath} component must be different for each instantiation of the service.</dd>
<dt><strong>one instance per server, but multiple servers</strong></dt>
<dd>Since the service definition is implemented on different servers, the {server} component of the service path will be unique.  The {relpath} component therefore may (but need not) be the same across all servers.</dd>
<dt><strong>multiple instances on multiple servers</strong></dt>
<dd>A generalization of the above two cases.</dd>
</dl>
<p>The breakdown of the {relpath} component is {server}
(ie. implementation) specific, meaning that two different servers may
actually assign different paths for implementing the same service
<em>definition</em>.</p>
<p>Note that the full generalization of this means that some servers may
implement a single instance and others may implement multiple
instances.  In this generalization, a client that is attempting to
access multiple services in the network, the client must be able to
determine the service path for any service that it might connect to.</p>
<p>See the section on service path resolution below for further details.</p>
</div>
<div class="section" id="types">
<h4>Types<a class="headerlink" href="#types" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal"><span class="pre">types</span></code> property is used to define common data types that are
used by request or response objects.  The <code class="docutils literal"><span class="pre">types</span></code> value is a
JSON object where each property name defines a unique type.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">types</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">&lt;type-name&gt;</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;json-schema&gt;</span>
   <span class="l-Scalar-Plain">&lt;type-name&gt;</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;json-schema&gt;</span>
</pre></div>
</div>
<p>For example, the following defines two types, &#8220;address&#8221; and &#8220;phone&#8221;:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">types</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">address</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>

      <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">street</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string</span>
            <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="s">&quot;Street</span><span class="nv"> </span><span class="s">Address&quot;</span>
         <span class="l-Scalar-Plain">city</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string</span>
            <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="s">&quot;City&quot;</span>
         <span class="l-Scalar-Plain">state</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string</span>
            <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="s">&quot;State&quot;</span>
            <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span> <span class="s">&quot;[A-Z][A-Z]&quot;</span>
         <span class="l-Scalar-Plain">zip</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string</span>
            <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="s">&quot;Zip</span><span class="nv"> </span><span class="s">Code</span><span class="nv"> </span><span class="s">(5-digit)&quot;</span>
            <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span> <span class="s">&quot;[0-9][0-9][0-9][0-9][0-9]&quot;</span>

   <span class="l-Scalar-Plain">phone</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string</span>
      <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span> <span class="s">&quot;[0-9]{3}-[0-9]{3}-[0-9]{4}&quot;</span>
</pre></div>
</div>
<p>A <code class="docutils literal"><span class="pre">type</span></code> defines only the structure of a data object, it does not have any
associated behaviors.  Defining types allows the same fundamental data types
to be referenced by other types and resources, in this service definition
as well as in others.</p>
</div>
<div class="section" id="resources">
<h4>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal"><span class="pre">resources</span></code> section defines a schema for each REST resource
exposed by the service.  Note that a <em>resource schema</em> defined in the
schema may map to multiple <em>concrete resources</em> supported by the
server.  This relationship is analogous to <em>classes</em> and <em>objects</em>.
For example, the <code class="docutils literal"><span class="pre">book</span></code> resource schema defines the properties
associated with a book resource, including the data type as well as
the behaviors associated with a book.  The server will have multiple
actual instances, or books, all described by this resource schema.</p>
<p>Whereas a <em>type</em> defines only the structure of a data object, a
<em>resource</em> binds a data object to a resource as supported by a server
via the <code class="docutils literal"><span class="pre">self</span></code> link and allows the definition of related actions that
can be performed via additional links, as well as relations to other resources.</p>
<p>A <code class="docutils literal"><span class="pre">resource</span></code> definition is an extension of a <code class="docutils literal"><span class="pre">json-schema</span></code>, adding <code class="docutils literal"><span class="pre">links</span></code>
and <code class="docutils literal"><span class="pre">relations</span></code>.  The following properties are used to describe a <code class="docutils literal"><span class="pre">resource</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">property</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>type</td>
<td>json-schema type: object, string, array, number</td>
</tr>
<tr class="row-odd"><td>description</td>
<td>text description of this resource</td>
</tr>
<tr class="row-even"><td>links</td>
<td>one or more named links applicable to this resource</td>
</tr>
<tr class="row-odd"><td>links.self</td>
<td>required link providing the URI template for an instance of this resource</td>
</tr>
<tr class="row-even"><td>relations</td>
<td>one or more named relations to other resources applicable to this resource</td>
</tr>
</tbody>
</table>
<p>When in the context of a resource, additional nested schemas are
defined when the <code class="docutils literal"><span class="pre">type</span></code> is <code class="docutils literal"><span class="pre">object</span></code> or an <code class="docutils literal"><span class="pre">array</span></code>.  These <em>nested</em>
schemas do not have a self link, however they may have other
links and relations defined.  This is described in more detail in later sections.</p>
<p>A simple resource schema for <code class="docutils literal"><span class="pre">book</span></code> is shown below:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">book</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="s">&quot;Defines</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">book</span><span class="nv"> </span><span class="s">resource&quot;</span>

      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
      <span class="l-Scalar-Plain">additionalProperties</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">False</span>
      <span class="l-Scalar-Plain">required</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span> <span class="nv">id</span><span class="p-Indicator">,</span> <span class="nv">title</span> <span class="p-Indicator">]</span>
      <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">number</span>
            <span class="l-Scalar-Plain">readOnly</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
         <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">publisher_id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">author_ids</span><span class="p-Indicator">:</span>
            <span class="c1"># Array of author ids, associated with this book</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">array</span>
            <span class="l-Scalar-Plain">items</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>

         <span class="l-Scalar-Plain">chapters</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">array</span>
            <span class="l-Scalar-Plain">items</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
               <span class="l-Scalar-Plain">additionalProperties</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">False</span>
               <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
                  <span class="l-Scalar-Plain">num</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
                  <span class="l-Scalar-Plain">heading</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>

      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span>
            <span class="c1"># Base URI for an instance of a book</span>
            <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/books/items/{id}&quot;</span>

         <span class="l-Scalar-Plain">get</span><span class="p-Indicator">:</span>
            <span class="c1"># Get the current data representation of a book</span>
            <span class="c1"># path defaults to &quot;self&quot; at /books/items{id}</span>
            <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">GET</span>
            <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/book&#39;</span> <span class="p-Indicator">}</span>

         <span class="l-Scalar-Plain">set</span><span class="p-Indicator">:</span>
            <span class="c1"># Replace the data representation for a book</span>
            <span class="c1"># path defaults to &quot;self&quot; at /books/items/{id}</span>
            <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">PUT</span>
            <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/book&#39;</span> <span class="p-Indicator">}</span>
            <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/book&#39;</span> <span class="p-Indicator">}</span>

         <span class="l-Scalar-Plain">delete</span><span class="p-Indicator">:</span>
            <span class="c1"># Link to delete a book instance</span>
            <span class="c1"># path defaults to &quot;self&quot;</span>
            <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">DELETE</span>

         <span class="l-Scalar-Plain">purchase</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/books/items/{id}/purchase&quot;</span>
            <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">POST</span>
            <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
               <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
                  <span class="l-Scalar-Plain">num_copies</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
                  <span class="l-Scalar-Plain">shipping_address</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/types/address&#39;</span> <span class="p-Indicator">}</span>

            <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
               <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
                  <span class="l-Scalar-Plain">delivery_date</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
                  <span class="l-Scalar-Plain">final_cost</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>

      <span class="l-Scalar-Plain">relations</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">publisher</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/publisher&#39;</span>
            <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">id</span><span class="p-Indicator">:</span> <span class="s">&#39;0/publisher_id&#39;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<div class="section" id="links">
<h5>Links<a class="headerlink" href="#links" title="Permalink to this headline">¶</a></h5>
<p>A link defines the set of actions and other resources that are related
to an instance of a resource schema (a concrete resource).  For
example, the <code class="docutils literal"><span class="pre">book</span></code> resource defines the <code class="docutils literal"><span class="pre">get</span></code> link which describes how
a client retrieves a copy of the data representation for a particular
book instance.</p>
<p>A link may have the follow properties:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">property</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>path</td>
<td>URI template for the address of an instance of this resource</td>
</tr>
<tr class="row-odd"><td>description</td>
<td>Description of the purpose of this link</td>
</tr>
<tr class="row-even"><td>method</td>
<td>Applicable HTTP method used to exercise this link</td>
</tr>
<tr class="row-odd"><td>request</td>
<td>json-schema for parameters associated with a GET, or the body of a POST</td>
</tr>
<tr class="row-even"><td>response</td>
<td>json-schema for the response from a server for this link</td>
</tr>
</tbody>
</table>
<p>There are several possible combinations of the above properties that
have slightly different meanings.</p>
<p>If the &#8220;path&#8221; is omitted, the &#8220;path&#8221; associated with the &#8220;self&#8221; link is
used.</p>
<p>The link <code class="docutils literal"><span class="pre">path</span></code> may include one or more variables in the base URL:</p>
<ul class="simple">
<li>/books/items/{id} - one variable {id}</li>
<li>/books/items/{bookid}/chapter/{num} - two variable {bookid} and {num}</li>
</ul>
<p>All variables must be resolved to values in order to exercise the
link.  Variables are first resolved from the data associated with a
resource.</p>
<p>For example, the <code class="docutils literal"><span class="pre">book</span></code> resource is defined as follows (abbreviated):</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">book</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="s">&quot;Defines</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">book</span><span class="nv"> </span><span class="s">resource&quot;</span>

      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
      <span class="l-Scalar-Plain">additionalProperties</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">False</span>
      <span class="l-Scalar-Plain">required</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span> <span class="nv">id</span><span class="p-Indicator">,</span> <span class="nv">title</span> <span class="p-Indicator">]</span>
      <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">publisher_id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">author_ids</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">...</span>
         <span class="l-Scalar-Plain">chapters</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">...</span>

      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="s">&quot;Base</span><span class="nv"> </span><span class="s">URI</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">an</span><span class="nv"> </span><span class="s">instance</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">book&quot;</span>
            <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/books/items/{id}&quot;</span>

         <span class="l-Scalar-Plain">get</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="s">&quot;Get</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">current</span><span class="nv"> </span><span class="s">data</span><span class="nv"> </span><span class="s">representation</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">book&quot;</span>
            <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">GET</span>
            <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/book&#39;</span> <span class="p-Indicator">}</span>

         <span class="l-Scalar-Plain">set</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="s">&quot;Update</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">book</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">data</span><span class="nv"> </span><span class="s">representation&quot;</span>
            <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">PUT</span>
            <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/book&#39;</span> <span class="p-Indicator">}</span>
            <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/book&#39;</span> <span class="p-Indicator">}</span>

         <span class="l-Scalar-Plain">purchase</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/books/items/{id}/purchase&quot;</span>
            <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">POST</span>
            <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
               <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
                  <span class="l-Scalar-Plain">num_copies</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
                  <span class="l-Scalar-Plain">shipping_address</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/types/address&#39;</span> <span class="p-Indicator">}</span>

            <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
               <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
                  <span class="l-Scalar-Plain">delivery_date</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
                  <span class="l-Scalar-Plain">final_cost</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">links</span></code> section above defines four links:</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">self</span></code></dt>
<dd>defines the path for accessing a book resource.  Note that the path defines a single variable {id} which refers to the property in the book resource definition <code class="docutils literal"><span class="pre">resources.book.properties.id</span></code>.</dd>
<dt><code class="docutils literal"><span class="pre">get</span></code></dt>
<dd>retrieve the data representation for a book using the GET method.</dd>
<dt><code class="docutils literal"><span class="pre">set</span></code></dt>
<dd>update a book from a data representation using the PUT method.  An updated data representation is returned.</dd>
<dt><code class="docutils literal"><span class="pre">purchase</span></code></dt>
<dd>initiate a book purchase using the POST method at the URL &#8220;$/books/items/{id}/purchase&#8221;.  Since this link is defined on a <code class="docutils literal"><span class="pre">book</span></code> resource, the {id} in the URL is filled based upon a specific book data representation.</dd>
</dl>
</div></blockquote>
<div class="section" id="the-ref-syntax">
<h6>The <code class="docutils literal"><span class="pre">$ref</span></code> syntax<a class="headerlink" href="#the-ref-syntax" title="Permalink to this headline">¶</a></h6>
<p>Links frequently use <code class="docutils literal"><span class="pre">$ref</span></code> to refer to resources and types defined
elsewhere in this or other service definitions.  The syntax of a fully
qualified reference is simply the <code class="docutils literal"><span class="pre">id</span></code> of the service definition (a
URL) followed by a fragment that is a JSON pointer to some JSON
schema within the service definition at that <code class="docutils literal"><span class="pre">id</span></code>.</p>
<p>There are three supported formats of the reference, which mirrors standard
URL page resolution:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Local</strong></td>
<td><code class="docutils literal"><span class="pre">#{jsonpointer}</span></code></td>
<td>Same service definition</td>
</tr>
<tr class="row-even"><td><strong>Provider</strong></td>
<td><code class="docutils literal"><span class="pre">/{name}/{version}#{jsonpointer}</span></code></td>
<td>Same provider, different service</td>
</tr>
<tr class="row-odd"><td><strong>Full</strong></td>
<td><code class="docutils literal"><span class="pre">{id}#{jsonpointer}</span></code></td>
<td>Fully qualified reference</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-self-link">
<h6>The <code class="docutils literal"><span class="pre">self</span></code> link<a class="headerlink" href="#the-self-link" title="Permalink to this headline">¶</a></h6>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">path</th>
<th class="head">params</th>
<th class="head">method</th>
<th class="head">request</th>
<th class="head">response</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>required</td>
<td>optional</td>
<td>n/a</td>
<td>n/a</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal"><span class="pre">self</span></code> link documents the address of a resource described by this
resource schema.  It must be defined for every resource schema and includes
the <code class="docutils literal"><span class="pre">path</span></code> property which defines a URI template.</p>
<p>If the URI template includes variables, the variables should match properties
in the resource&#8217;s data representation.  For example, in the book self link
below, the <code class="docutils literal"><span class="pre">{id}</span></code> variable matches the book&#8217;s <code class="docutils literal"><span class="pre">id</span></code> property.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">info</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="c1"># No variables in this resource</span>
         <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/info&quot;</span> <span class="p-Indicator">}</span>

   <span class="l-Scalar-Plain">book</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">...</span>
      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="c1"># {id} matches the resource property defined at book.properties.id</span>
         <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/books/items/{id}&quot;</span> <span class="p-Indicator">}</span>

   <span class="l-Scalar-Plain">book_chapter</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">bookid</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">num</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">...</span>
      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="c1"># {bookid} matches the resource property book_chapter.properties.bookid</span>
         <span class="c1"># {num} matches the resource property book_chapter.properties.num</span>
         <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/books/items/{bookid}/chapter/{num}&quot;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>Self links are only allowed at the root of a resource schema.</p>
<p>The <code class="docutils literal"><span class="pre">params</span></code> property of the link defines additional qualifiers when
addressing a resource.  These qualifiers are typically filter parameters
that select a subset of a collection, or restricited set of fields.</p>
<p>For example, the <code class="docutils literal"><span class="pre">books</span></code> resource is shown below (<code class="docutils literal"><span class="pre">books</span></code> is the plural
collection not to be confused with the singular <code class="docutils literal"><span class="pre">book</span></code> resource):</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">books</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">array</span>
      <span class="l-Scalar-Plain">items</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
         <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span><span class="p-Indicator">,</span> <span class="nv">readOnly</span><span class="p-Indicator">:</span> <span class="nv">true</span> <span class="p-Indicator">}</span>
            <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>

      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/books&quot;</span>
            <span class="l-Scalar-Plain">params</span><span class="p-Indicator">:</span>
               <span class="c1"># Allow filtering by author id or title</span>
               <span class="l-Scalar-Plain">author</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
               <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>Parameters are expressed as URI parameters.</p>
<p>Retrieve only books written by author id 1:</p>
<div class="highlight-python"><div class="highlight"><pre>GET /books?author=1
</pre></div>
</div>
<p>Retrieve only books written by author id 1 and have &#8220;Bunnies&#8221; in the title:</p>
<div class="highlight-python"><div class="highlight"><pre>GET /books?author=1&amp;title=Bunnies
</pre></div>
</div>
<p>Note that the interpretation of the parameters is dependent
on the server implementation.  The meaning of the <code class="docutils literal"><span class="pre">title</span></code> parameter
could be an exact match or a substring match.  The schema should
document such details that are relevant to client developers.</p>
<p>Note also that <code class="docutils literal"><span class="pre">/books</span></code> is the collection, not <code class="docutils literal"><span class="pre">/books/items</span></code>, so
the parameters apply to <code class="docutils literal"><span class="pre">/books</span></code>.  The <code class="docutils literal"><span class="pre">/books/items</span></code> path only
appears when a specific element of the collection&#8217;s URI is constructed.</p>
</div>
<div class="section" id="standard-links-get-set-create-delete">
<h6>Standard links: get, set, create, delete<a class="headerlink" href="#standard-links-get-set-create-delete" title="Permalink to this headline">¶</a></h6>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">path</th>
<th class="head">method</th>
<th class="head">request</th>
<th class="head">response</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>n/a</td>
<td>required</td>
<td>optional</td>
<td>optional</td>
</tr>
</tbody>
</table>
<p>The standard resource operations of <code class="docutils literal"><span class="pre">get</span></code>, <code class="docutils literal"><span class="pre">set</span></code>, <code class="docutils literal"><span class="pre">create</span></code>, and
<code class="docutils literal"><span class="pre">delete</span></code> are all defined as links with an HTTP <code class="docutils literal"><span class="pre">method</span></code> and <code class="docutils literal"><span class="pre">path</span></code>
equal to the path of the <code class="docutils literal"><span class="pre">self</span></code> link.  The <code class="docutils literal"><span class="pre">path</span></code> property is not
provided as these operations are always relative to the resource in
question, thus are available at the self link path.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">info</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">get</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">GET</span>
            <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/info&#39;</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">set</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">PUT</span>
            <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/info&#39;</span> <span class="p-Indicator">}</span>
            <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/info&#39;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">request</span></code> schema is used to pass data to the server.  For a <code class="docutils literal"><span class="pre">GET</span></code>, the
<code class="docutils literal"><span class="pre">request</span></code> must be a flat object whose properties define the valid URL parameters.
For a <code class="docutils literal"><span class="pre">POST</span></code>, the <code class="docutils literal"><span class="pre">request</span></code> may be any valid <code class="docutils literal"><span class="pre">json-schema</span></code> and is provided
in the body of the message.</p>
<p>The <code class="docutils literal"><span class="pre">response</span></code> schema defines the expected response on success.  Errors
are handled separately (see the section on Errors).</p>
</div>
<div class="section" id="verbs">
<h6>Verbs<a class="headerlink" href="#verbs" title="Permalink to this headline">¶</a></h6>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">path</th>
<th class="head">method</th>
<th class="head">request</th>
<th class="head">response</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>required</td>
<td>required</td>
<td>optional</td>
<td>optional</td>
</tr>
</tbody>
</table>
<p>This type of link is commonly used for verbs like &#8220;reboot&#8221;, where it
is difficult to map normal REST resource (noun) semantics to the URI.
The action is performed using the defined &#8220;method&#8221; at the &#8220;path&#8221;
provided.  The &#8220;path&#8221; must define a unique resource (by URI template)
and must be prefixed by the &#8220;path&#8221; of the &#8220;self&#8221; link.</p>
<p>The method will normally be a POST:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">book</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">purchase</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/books/items/{id}/purchase&quot;</span>
            <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">POST</span>
            <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
               <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
                  <span class="l-Scalar-Plain">num_copies</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
                  <span class="l-Scalar-Plain">shipping_address</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/types/address&#39;</span> <span class="p-Indicator">}</span>

            <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
               <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
                  <span class="l-Scalar-Plain">delivery_date</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
                  <span class="l-Scalar-Plain">final_cost</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</div>
<div class="section" id="merge-syntax">
<h6><code class="docutils literal"><span class="pre">$merge</span></code> syntax<a class="headerlink" href="#merge-syntax" title="Permalink to this headline">¶</a></h6>
<p>Services may leverage <code class="docutils literal"><span class="pre">$merge</span></code> as a means for combining two schemas.  This should
be regarded as a preprocessing step that results in a valid JSON schema.</p>
<p>The syntax is as follows:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">$merge</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;object&gt;</span>
   <span class="l-Scalar-Plain">with</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;object&gt;</span>
</pre></div>
</div>
<p>The source and with are objects that are combined to form a new object
in it&#8217;s place.  The with object is merged into the source object according to the
following rules:</p>
<dl class="docutils">
<dt>For each property in with:</dt>
<dd><ol class="first last arabic simple">
<li>If either source or with is a $ref, dereference the target first</li>
<li>If a property is in source and the value of with is None, the
property is removed from the final object.</li>
<li>If a property is in source, and both values are in turn objects,
recurse into the objects and merge recursively</li>
<li>Otherwise, set store the value of with in the final object</li>
</ol>
</dd>
</dl>
<p>As an example:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">$merge</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">x</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">1</span>
      <span class="l-Scalar-Plain">y</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">2</span>
      <span class="l-Scalar-Plain">sub</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">a</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">10</span>
         <span class="l-Scalar-Plain">b</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">20</span>
   <span class="l-Scalar-Plain">with</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">x</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0</span>
      <span class="l-Scalar-Plain">z</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">3</span>
      <span class="l-Scalar-Plain">sub</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">a</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">5</span>
</pre></div>
</div>
<p>Results in:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">x</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0</span>
<span class="l-Scalar-Plain">y</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">2</span>
<span class="l-Scalar-Plain">z</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">3</span>
<span class="l-Scalar-Plain">sub</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">a</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">5</span>
   <span class="l-Scalar-Plain">b</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">20</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="relations">
<h5>Relations<a class="headerlink" href="#relations" title="Permalink to this headline">¶</a></h5>
<p>A relation defines another resource that is related to the given resource,
usually based on the data representation of the given resource.  A relation
is essentially a pointer to another resource that may be followed to get
to the other resource.</p>
<p>The primary use of defining relations is to explicitly define
relations based on a given resource data representation, rather than
implying relationships via documentation.  For example, in the <code class="docutils literal"><span class="pre">book</span></code>
resource, the <code class="docutils literal"><span class="pre">publisher</span></code> relation explicitly
describes that the <code class="docutils literal"><span class="pre">publisher_id</span></code> property of a book resource can be
used to reach the associated publisher resource:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">book</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="s">&quot;Defines</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">book</span><span class="nv"> </span><span class="s">resource&quot;</span>

      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
      <span class="l-Scalar-Plain">additionalProperties</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">False</span>
      <span class="l-Scalar-Plain">required</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span> <span class="nv">id</span><span class="p-Indicator">,</span> <span class="nv">title</span> <span class="p-Indicator">]</span>
      <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">publisher_id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">...</span>

      <span class="l-Scalar-Plain">relations</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">publisher</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/publisher&#39;</span>
            <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">id</span><span class="p-Indicator">:</span> <span class="s">&#39;0/publisher_id&#39;</span> <span class="p-Indicator">}</span>

   <span class="l-Scalar-Plain">publisher</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
      <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>

      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/publishers/{id}&quot;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>As another example, the <code class="docutils literal"><span class="pre">author</span></code> resource defines the <code class="docutils literal"><span class="pre">books</span></code> relation
that fills in the <code class="docutils literal"><span class="pre">author</span></code> parameter that is supported by the <code class="docutils literal"><span class="pre">books</span></code> self
link:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">author</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
      <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>

      <span class="l-Scalar-Plain">relations</span><span class="p-Indicator">:</span>
         <span class="c1"># the entire list of authors</span>
         <span class="l-Scalar-Plain">instances</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/authors&#39;</span>

         <span class="c1"># the collection of books written by this author</span>
         <span class="l-Scalar-Plain">books</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/books&#39;</span>
            <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">author</span><span class="p-Indicator">:</span> <span class="s">&quot;0/id&quot;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>Each relation must define the <code class="docutils literal"><span class="pre">resource</span></code> property.  This identifies the related
resource by name.  The <code class="docutils literal"><span class="pre">instances</span></code> relation links to the <code class="docutils literal"><span class="pre">authors</span></code> resource
(note again the singular <code class="docutils literal"><span class="pre">author</span></code> vs the plural <code class="docutils literal"><span class="pre">authors</span></code>, two different
resources).</p>
<p>The phrase &#8220;following a resource relation&#8221; is used to describe the process:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Retrieve the data representation for a known &#8220;source&#8221; resource (say &#8216;/author/3&#8217;)</li>
<li>Examine the schema for the &#8220;target&#8221; resource and parse the desired relation definition (say the &#8216;books&#8217; relation)</li>
<li>Examine the <code class="docutils literal"><span class="pre">self</span></code> link of the target resource and fill in the necessary parameters based on the data representation of the source resource using the relation <code class="docutils literal"><span class="pre">vars</span></code> mapping.</li>
<li>Retrieve the data representation for the target resource using the fully resolved <code class="docutils literal"><span class="pre">self</span></code> link.</li>
</ol>
</div></blockquote>
<div class="section" id="syntax">
<h6>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h6>
<p>A <code class="docutils literal"><span class="pre">relation</span></code> is defined as follows:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">&lt;resource&gt;</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">relations</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">&lt;relation_name&gt;</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;target_resource&gt;</span>
            <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">&lt;target_var&gt;</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;rel_json_pointer&gt;</span>
               <span class="l-Scalar-Plain">&lt;target_var&gt;</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;rel_json_pointer&gt;</span>
               <span class="l-Scalar-Plain">...</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>relation_name</strong></td>
<td>Unique name within this set of relations</td>
</tr>
<tr class="row-even"><td><strong>target_resource</strong></td>
<td>Reference to the target resource, see below</td>
</tr>
<tr class="row-odd"><td><strong>target_var</strong></td>
<td>Variable in the target resource&#8217;s self link</td>
</tr>
<tr class="row-even"><td><strong>rel_json_pointer</strong></td>
<td>Relative JSON pointer to use to fill in the target_var based on a data representation of the source resource</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="resource-references">
<h6><code class="docutils literal"><span class="pre">resource</span></code> references<a class="headerlink" href="#resource-references" title="Permalink to this headline">¶</a></h6>
<p>For relations, the <code class="docutils literal"><span class="pre">resource</span></code> property is similar to link references via
<code class="docutils literal"><span class="pre">$ref</span></code>.  The primary difference is that the target of a <code class="docutils literal"><span class="pre">resource</span></code> property
must point to another resource, it cannot be a type.</p>
<p>When following a resource relation, there are two types of resolution that
must occur:</p>
<dl class="docutils">
<dt><strong>schema resolution</strong></dt>
<dd>identifying the <em>general</em> service definition schema that describes the target resource</dd>
<dt><strong>URI resolution</strong></dt>
<dd>identifying the full URI of the <em>particular</em> target resource in the context of a data representation of the source resource</dd>
</dl>
<p>For example, returning to the author/relations/books example, the schema
and path are resolved as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>source schema</strong></td>
<td><a class="reference external" href="http://support.riverbed.com/apis/bookstore/1.0#/resources/author">http://support.riverbed.com/apis/bookstore/1.0#/resources/author</a></td>
</tr>
<tr class="row-even"><td><strong>source URI</strong></td>
<td><a class="reference external" href="https://10.1.2.3/api/bookstore/1.0/author/12">https://10.1.2.3/api/bookstore/1.0/author/12</a></td>
</tr>
<tr class="row-odd"><td><strong>source data rep</strong></td>
<td><code class="docutils literal"><span class="pre">{</span> <span class="pre">id:</span> <span class="pre">12,</span> <span class="pre">name:</span> <span class="pre">&quot;John</span> <span class="pre">Smith&quot;</span> <span class="pre">}</span></code></td>
</tr>
<tr class="row-even"><td><strong>target schema</strong></td>
<td><a class="reference external" href="http://support.riverbed.com/apis/bookstore/1.0#/resources/books">http://support.riverbed.com/apis/bookstore/1.0#/resources/books</a></td>
</tr>
<tr class="row-odd"><td><strong>target URI</strong></td>
<td><a class="reference external" href="https://10.1.2.3/api/bookstore/1.0/books?author=12">https://10.1.2.3/api/bookstore/1.0/books?author=12</a></td>
</tr>
</tbody>
</table>
<p>The <em>target URI</em> above is based on the data representation of the source
data representation and was built from the self link of the &#8216;books&#8217; resource.</p>
</div>
<div class="section" id="and-uri-resolution-across-services">
<h6><code class="docutils literal"><span class="pre">$</span></code> and URI resolution across services<a class="headerlink" href="#and-uri-resolution-across-services" title="Permalink to this headline">¶</a></h6>
<p>In the simplest case, the &#8216;$&#8217; in the self link of a target resource is
replaced with the service URI of the source resource.  However, it is
possible to support links and relations from one service to another where
some services are potentially on different servers.</p>
<p>TBD</p>
</div>
<div class="section" id="full-and-instances-relations">
<h6><code class="docutils literal"><span class="pre">full</span></code> and <code class="docutils literal"><span class="pre">instances</span></code> relations<a class="headerlink" href="#full-and-instances-relations" title="Permalink to this headline">¶</a></h6>
<p>The <code class="docutils literal"><span class="pre">full</span></code> relation is a special relation that refers to the full
resource associated with a partial representation of that resource.  This is
used most frequently with collections.</p>
<p>Likewise the <code class="docutils literal"><span class="pre">instances</span></code> relation is a special relation that refers
to the full collection of resources of which the given resource is just
one.</p>
<p>For example, consider the <code class="docutils literal"><span class="pre">books</span></code> and <code class="docutils literal"><span class="pre">book</span></code> resources:</p>
<div class="highlight-yaml"><div class="highlight"><pre> <span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">books</span><span class="p-Indicator">:</span>
       <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">array</span>
       <span class="l-Scalar-Plain">items</span><span class="p-Indicator">:</span>
          <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
          <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
             <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span><span class="p-Indicator">,</span> <span class="nv">readOnly</span><span class="p-Indicator">:</span> <span class="nv">true</span> <span class="p-Indicator">}</span>
             <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>

          <span class="l-Scalar-Plain">relations</span><span class="p-Indicator">:</span>
<span class="hll">             <span class="l-Scalar-Plain">full</span><span class="p-Indicator">:</span>                       <span class="c1"># &quot;full&quot; relation on collection</span>
</span>                <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/book&#39;</span>
                <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">id</span><span class="p-Indicator">:</span> <span class="s">&quot;0/id&quot;</span> <span class="p-Indicator">}</span>
       <span class="l-Scalar-Plain">...</span>

    <span class="l-Scalar-Plain">book</span><span class="p-Indicator">:</span>
       <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
       <span class="l-Scalar-Plain">...</span>
       <span class="l-Scalar-Plain">relations</span><span class="p-Indicator">:</span>
<span class="hll">          <span class="l-Scalar-Plain">instances</span><span class="p-Indicator">:</span>                     <span class="c1"># &quot;instances&quot; relation on element</span>
</span>             <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/books&#39;</span>
</pre></div>
</div>
<p>Notice that the <code class="docutils literal"><span class="pre">full</span></code> relation is a nested relation defined on the
array <em>item</em> and leverages the item <code class="docutils literal"><span class="pre">id</span></code> property to link to the full
book resource.</p>
<p>The <code class="docutils literal"><span class="pre">full</span></code> relation may be used in other contexts as well.  For
example, the link from a book to it&#8217;s publisher via the publisher_id
could be represented as follows:</p>
<div class="highlight-yaml"><div class="highlight"><pre> <span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">book</span><span class="p-Indicator">:</span>
       <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
       <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
          <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
          <span class="l-Scalar-Plain">publisher_id</span><span class="p-Indicator">:</span>
             <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">number</span>
             <span class="l-Scalar-Plain">relations</span><span class="p-Indicator">:</span>
<span class="hll">                <span class="l-Scalar-Plain">full</span><span class="p-Indicator">:</span>                    <span class="c1"># &quot;full&quot; relation on a property</span>
</span>                   <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/publisher&#39;</span>
                   <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">id</span><span class="p-Indicator">:</span> <span class="s">&quot;0&quot;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</div>
<div class="section" id="mapping-values-to-self-link-parameters">
<h6>Mapping values to self link parameters<a class="headerlink" href="#mapping-values-to-self-link-parameters" title="Permalink to this headline">¶</a></h6>
<p>The <code class="docutils literal"><span class="pre">vars</span></code> property may be specified to map values from a data
representation of the soruce resource to variables or parameters in the
target resource&#8217;s self link.  This mapping is what makes it possible to
automatically jump from one resource to a related resource.</p>
<p>Let&#8217;s look in detail at the <code class="docutils literal"><span class="pre">author.relations.books</span></code> relation.  The
relation&#8217;s target resource is <code class="docutils literal"><span class="pre">books</span></code>.  The <code class="docutils literal"><span class="pre">books</span></code> self.link is shown
below and was used as an example above in the &#8220;Self link&#8221; section:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">books</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/books&quot;</span>
            <span class="l-Scalar-Plain">params</span><span class="p-Indicator">:</span>
               <span class="c1"># Allow filtering by author id or title</span>
               <span class="l-Scalar-Plain">author</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
               <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>Looking at the list of supported parameters, the <code class="docutils literal"><span class="pre">books</span></code> resource
supports filtering based on the author id via the <code class="docutils literal"><span class="pre">author</span></code> parameter.
So, to get the list of books associated with an <code class="docutils literal"><span class="pre">author</span></code> resource, the
<code class="docutils literal"><span class="pre">id</span></code> properties of the author data representation should be used for the
<code class="docutils literal"><span class="pre">books.links.self.params.author</span></code> parameter.  This is represented in the
<code class="docutils literal"><span class="pre">author.relations.books.vars</span></code> property:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">books</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/books&#39;</span>
   <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">author</span><span class="p-Indicator">:</span> <span class="s">&quot;0/id&quot;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>The above indicates that <code class="docutils literal"><span class="pre">author</span></code> in the <code class="docutils literal"><span class="pre">books</span></code> resource should be
filled in with the <code class="docutils literal"><span class="pre">author</span></code> data representations <code class="docutils literal"><span class="pre">id</span></code> property.
The &#8220;0/id&#8221; is a relative JSON pointer, the &#8220;0&#8221; indicates to start
at the same level as the relation definition, and then traverse using
the &#8220;id&#8221;.  See the appendix on relative JSON pointers for more details
on the syntax.</p>
</div>
<div class="section" id="example-relation-publisher-of-a-book">
<h6>Example relation: publisher of a book<a class="headerlink" href="#example-relation-publisher-of-a-book" title="Permalink to this headline">¶</a></h6>
<p>The following example shows how to define a relation from a book
to the publisher resource for that book:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">book</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">A book object</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
      <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">publisher_id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
         <span class="l-Scalar-Plain">...</span>

      <span class="l-Scalar-Plain">relations</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">publisher</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/publisher&#39;</span>
            <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="s">&#39;0/publisher_id&#39;</span>

<span class="l-Scalar-Plain">publisher</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">...</span>
   <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/publishers/{id}&quot;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>To start, the above defines a relation from a singular <code class="docutils literal"><span class="pre">book</span></code> resource
to the singular <code class="docutils literal"><span class="pre">publisher</span></code> associated with that book based on the
<code class="docutils literal"><span class="pre">publisher_id</span></code> property of a <code class="docutils literal"><span class="pre">book</span></code>.</p>
<p><code class="docutils literal"><span class="pre">relations.publisher.resource</span></code> indicates that the related resource is
called <code class="docutils literal"><span class="pre">publisher</span></code>, and the <code class="docutils literal"><span class="pre">vars</span></code> indicates that the ={id} variable
in the self link path of the target resource should be filled in using
the <code class="docutils literal"><span class="pre">publisher_id</span></code> of a data representation for a book.</p>
</div>
</div>
<div class="section" id="singletons-versus-instances">
<h5>Singletons versus instances<a class="headerlink" href="#singletons-versus-instances" title="Permalink to this headline">¶</a></h5>
<p>A resource schema may define either a single resource instance or
multiple instances depending on the <code class="docutils literal"><span class="pre">self</span></code> relation.  If the <code class="docutils literal"><span class="pre">self</span></code>
path template does not contain any variables, than the resource is a
singleton.  If <code class="docutils literal"><span class="pre">self</span></code> includes one or more variables, than the
resource is multi-instance, with each instance addressable by filling
in all of the variable in the template.</p>
<p>For example:</p>
<ul class="simple">
<li>&#8220;/info&#8221; describes a singleton</li>
<li>&#8220;/books&#8221; describes a singleton, even though the response data
representation is a collection (of books), the resource itself is
a singleton</li>
<li>&#8220;/books/items/{id}&#8221; describes a multi-instance resource indexed by
the variable {id}</li>
<li>&#8220;/books/items/{id}/chapter/{num}&#8221; describes a multi-instance
resource indexed by the tuple {id} and {num}.</li>
</ul>
<p>Note that &#8220;/books/items/1&#8221; is a separate resource from
&#8220;/books/items/1/chapter/2&#8221;, despite the fact that the former is a
prefix of the latter.  Each of these two resources is described by
different resources (<code class="docutils literal"><span class="pre">book</span></code> and <code class="docutils literal"><span class="pre">book_chapter</span></code>, see the appendix).</p>
</div>
<div class="section" id="collections-and-nested-links-and-relations">
<h5>Collections and nested links and relations<a class="headerlink" href="#collections-and-nested-links-and-relations" title="Permalink to this headline">¶</a></h5>
<p>A collection is a common resource pattern that defines two resources,
one for accessing an individual element in the collection, the second
for accessing the collection as an array.  The above &#8220;/books/items/{id}&#8221; is
an example of a collection element and &#8220;/books&#8221; is the matching collection.</p>
<p>In the simplest case, <code class="docutils literal"><span class="pre">links</span></code> and <code class="docutils literal"><span class="pre">relations</span></code> are defined at the same
level as the base &#8220;type&#8221; property of the resource:</p>
<div class="highlight-yaml"><div class="highlight"><pre> <span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
<span class="hll">    <span class="l-Scalar-Plain">info</span><span class="p-Indicator">:</span>                        <span class="c1"># non-collection, non-element resource</span>
</span><span class="hll">       <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>              <span class="c1"># of type object</span>
</span>       <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
          <span class="l-Scalar-Plain">owner</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
          <span class="l-Scalar-Plain">email</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>

<span class="hll">       <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>                    <span class="c1"># Links at top level</span>
</span>          <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/info&quot;</span> <span class="p-Indicator">}</span>
          <span class="l-Scalar-Plain">get</span><span class="p-Indicator">:</span>
             <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">GET</span>
             <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/info&#39;</span> <span class="p-Indicator">}</span>
          <span class="l-Scalar-Plain">set</span><span class="p-Indicator">:</span>
             <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">PUT</span>
             <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/info&#39;</span> <span class="p-Indicator">}</span>
             <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/info&#39;</span> <span class="p-Indicator">}</span>

<span class="hll">       <span class="l-Scalar-Plain">relations</span><span class="p-Indicator">:</span>                <span class="c1"># Relations at top level</span>
</span>          <span class="l-Scalar-Plain">books</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/books&#39;</span> <span class="p-Indicator">}</span>
          <span class="l-Scalar-Plain">authors</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/authors&#39;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>Such top-level links apply to an instance of the resource.  However,
links and relations may also be defined at other locations within the
data.  They are defined at the same level as any <code class="docutils literal"><span class="pre">type</span></code> keyword which begins
the definition of the structure of some subset of the data.</p>
<p>These nested links and relations are necessary to define links and
relations based on a specific item in an array.</p>
<p>Consider the structure of the <code class="docutils literal"><span class="pre">books</span></code> resource:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">books</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">array</span>
      <span class="l-Scalar-Plain">items</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
         <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span><span class="p-Indicator">,</span> <span class="nv">readOnly</span><span class="p-Indicator">:</span> <span class="nv">true</span> <span class="p-Indicator">}</span>
            <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">GET</span> <span class="o">/</span><span class="n">books</span>
<span class="p">[</span> <span class="p">{</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="s">&#39;My favorite book&#39;</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="s">&#39;My other favorite book&#39;</span> <span class="p">}</span> <span class="p">]</span>
</pre></div>
</div>
<p>The data representation for <code class="docutils literal"><span class="pre">books</span></code> returns an array of data, where each
array element includes the book id and the book title.  If the client wants
to examine the authors associated with each book, the full <code class="docutils literal"><span class="pre">book</span></code> resource
must be retrieved for each item in the array, using the <code class="docutils literal"><span class="pre">id</span></code> property of
the array item as the value for {id} in the book self link.  Since
the data represents multiple books (2 in the above example), and the
<code class="docutils literal"><span class="pre">book</span></code> resource can only represent one book, the relation must be described
in a way relative to each array element separately.</p>
<p>This relation can be expressed in the <code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code> in one of two
ways:</p>
<div class="highlight-yaml"><div class="highlight"><pre> <span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">books</span><span class="p-Indicator">:</span>
       <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">array</span>
       <span class="l-Scalar-Plain">items</span><span class="p-Indicator">:</span>
<span class="hll">          <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>               <span class="c1"># type of each individual array item</span>
</span>          <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
             <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span><span class="p-Indicator">,</span> <span class="nv">readOnly</span><span class="p-Indicator">:</span> <span class="nv">true</span> <span class="p-Indicator">}</span>
             <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>

<span class="hll">          <span class="l-Scalar-Plain">relations</span><span class="p-Indicator">:</span>                 <span class="c1"># relation on each array item</span>
</span>             <span class="l-Scalar-Plain">book</span><span class="p-Indicator">:</span>
                <span class="c1"># Build a book link from the &#39;id&#39; property</span>
                <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/book&#39;</span>
                <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span>
<span class="hll">                   <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="s">&quot;0/id&quot;</span>        <span class="c1"># this array item&#39;s &#39;id&#39; property</span>
</span></pre></div>
</div>
<p>In this variation, the relation is defined at the same level as the
<code class="docutils literal"><span class="pre">type:</span> <span class="pre">object</span></code>, thus the value of the target <code class="docutils literal"><span class="pre">id</span></code> is taken from the
array item <code class="docutils literal"><span class="pre">id</span></code> property.</p>
<p>An alternative is to push the relation definition one level deeper:</p>
<div class="highlight-yaml"><div class="highlight"><pre> <span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">books</span><span class="p-Indicator">:</span>
       <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">array</span>
       <span class="l-Scalar-Plain">items</span><span class="p-Indicator">:</span>
          <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
          <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
             <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">number</span>
                <span class="l-Scalar-Plain">readOnly</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="hll">                <span class="l-Scalar-Plain">relations</span><span class="p-Indicator">:</span>           <span class="c1"># Relation on an object property</span>
</span>                   <span class="l-Scalar-Plain">book</span><span class="p-Indicator">:</span>
                      <span class="c1"># Build a book link from the &#39;id&#39; property</span>
                      <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/book&#39;</span>
                      <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span>
<span class="hll">                         <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="s">&quot;0&quot;</span>     <span class="c1"># this number value</span>
</span>             <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>Other than moving the relation definition deeper into the data
representation structure to the same level as the <code class="docutils literal"><span class="pre">type:</span> <span class="pre">number</span></code> for
the id property, the <code class="docutils literal"><span class="pre">vars.id</span></code> value must change to reflect the fact
that the entire data value <em>at this point</em> in the data structure is used.</p>
<p>In general, it is preferable to put the relation definition as close to
the root as possible (the first variation), simply for readability,
but links and relations can be defined</p>
<p>There are 2 possible &#8220;book&#8221; relation links, one for each entry in the response.
To resolve the &#8220;book&#8221; path, first select an entry in the array, then resolve
the path.  For example, selecting &#8220;101&#8221; in the array, the &#8220;book&#8221; path will
be &#8220;/books/items/101&#8221;.  The &#8220;{$}&#8221; indicates that array value should be used.
This is described in more detail in the next section.</p>
</div>
<div class="section" id="paths">
<h5>Paths<a class="headerlink" href="#paths" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;path&#8221; property associated with a link definition defines the URI
template for the link.  The template may be a static path such as
&#8220;$/info&#8221;, or it may be a path with variables such as &#8220;$/books/items/{id}&#8221; or
&#8220;$/books/items/{bookid}/chapter/{num}&#8221;.</p>
<p>A simple static path with no variables:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">info</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span> <span class="s">&quot;$/info&quot;</span>
</pre></div>
</div>
<p>In order to evaluate a link, all variables in the link must be
resolved to values.  The values are taken first either from a data
representation of the associated resource, or provided by the client
when resolving the link.</p>
<p>When resolving variables from a data representation, the relative location of
the link definition within the resource schema definition is taken
into account.  This is discussed further below.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>The following text has never been implemented, and is probably not needed
now that we have JSON relative pointers.  Contact the RTC before using.</p>
<p class="last">DEPRECATED?: &#8220;{$}&#8221; indicates that the value of the instance data
(relative to the link definition).  See the examples below.</p>
</div>
<p>The &#8220;path&#8221; property may take two forms, direct or indirect.  In the
direct form, the &#8220;path&#8221; property is a string defining a URI template
conforming to <a class="reference external" href="http://tools.ietf.org/html/rfc6570">RFC 6750</a>.
Simply put, this is a URI with zero or more variables in curly braces
that must be replaced.  Only variables at the same level as the link definition
can be resolved in the direct form.</p>
<p>Shown below is a path with a single variable taken from instance data.
The &#8220;{id}&#8221; variable is resolve by inspecting the data representation
associated with a given instance of a &#8220;book&#8221; resource:</p>
<div class="highlight-yaml"><div class="highlight"><pre> <span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">book</span><span class="p-Indicator">:</span>
       <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
       <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
<span class="hll">          <span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>               <span class="c1"># Type information for &#39;id&#39;</span>
</span>
       <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
          <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span>
<span class="hll">             <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/books/items/{id}&quot;</span>      <span class="c1"># Use of &#39;id&#39; in the path</span>
</span></pre></div>
</div>
<p>In the <em>indirect</em> form, the path is an object with two properties as follows:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">template</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;string&gt;</span>
   <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">&lt;var&gt;</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;relative JSON Pointer&gt;</span>
      <span class="l-Scalar-Plain">&lt;var&gt;</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;relative JSON Pointer&gt;</span>
      <span class="l-Scalar-Plain">...</span>
</pre></div>
</div>
<p>In this second form, the URI template is defined in the &#8220;template&#8221;
property.  However, the variables are resolved first by looking the in
&#8220;vars&#8221; object, then a resource data representation, then finally to
other sources such as the user.  (This form is necessary since the
allowed characters for variables in a URI template is severely
restricted and does not allow for the &#8220;/&#8221;, thus this layer of
indirection is needed.)</p>
<p>The &#8220;vars&#8221; property defines variables using relative JSON pointers.
This allows referencing instance data at other locations within a complex
JSON data structure.</p>
<p><strong>TODO</strong>: Example for the indirect form.</p>
</div>
</div>
<div class="section" id="errors">
<h4>Errors<a class="headerlink" href="#errors" title="Permalink to this headline">¶</a></h4>
<p>The mechanism for defining errors and the format of the responses closely follows
the Problem Details IETF draft (<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-appsawg-http-problem-00">draft-ietf-appsawg-http-problem</a>).</p>
<div class="section" id="service-defined-errors">
<h5>Service Defined Errors<a class="headerlink" href="#service-defined-errors" title="Permalink to this headline">¶</a></h5>
<p>A service definition may specify a list of errors that the service may generate.
The <code class="docutils literal"><span class="pre">errors</span></code> property occurs at the same level as <code class="docutils literal"><span class="pre">resourcess</span></code>.</p>
<p>Each error definition has the following properties:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">property</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>type</td>
<td><p class="first">An absolute URI that identifies the error type.  When
dereferenced, it SHOULD provide human-readable documentation
for the error type.  Note that the <code class="docutils literal"><span class="pre">type</span></code> URI is not
explicitly defined in the service defintion, it is implied
based on the full service <code class="docutils literal"><span class="pre">id</span></code>.</p>
<p class="last">This MUST be used as the primarly identifier for the error
type.  Clients SHOULD NOT automatically dereference this
URL.</p>
</td>
</tr>
<tr class="row-odd"><td>title</td>
<td>A short, human readable summary of the problem type.</td>
</tr>
<tr class="row-even"><td>description</td>
<td>A detailed description of the error type suitable for
documenation.  This text should describe in detail
what causes the error to occur and identifies steps
the client can take to fix the problem.</td>
</tr>
<tr class="row-odd"><td>properites</td>
<td><p class="first">A dictionary of additional properties that may be
included in the error response.  The value associated
with each name is a schema that defines the structure
of the property value in the response body.</p>
<p class="last">There is one special <code class="docutils literal"><span class="pre">detail-values</span></code> property that SHOULD be
used to JSON schema that describes the structure of the
<code class="docutils literal"><span class="pre">values</span></code> property that may be included in the error response</p>
</td>
</tr>
</tbody>
</table>
<p>An example of an error definition:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="s">&#39;http://support.riverbed.com/apis/bookstore/1.0&#39;</span>

<span class="nn">...</span>

<span class="l-Scalar-Plain">errors</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">invalid_username</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="s">&quot;The</span><span class="nv"> </span><span class="s">specified</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">invalid&quot;</span>
      <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
         <span class="no">An attempt was made to access a resctricted resource</span>
         <span class="no">using a username that is not valid.  This may be</span>
         <span class="no">because there is no such account or because the</span>
         <span class="no">account is disabled.  Check with an adminstrator</span>
         <span class="no">for this device.</span>
      <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">detail-values</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
            <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<p>The full <code class="docutils literal"><span class="pre">type</span></code> for the above error would be
<code class="docutils literal"><span class="pre">http://support.riverbed.com/apis/bookstore/1.0/service.html#/errors/invalid_username</span></code>.
Note that the <code class="docutils literal"><span class="pre">type</span></code> links to the HTML rendering of the service definition, with
an anchor taking the user directly to the error defined within the service.</p>
</div>
<div class="section" id="error-responses">
<h5>Error Responses<a class="headerlink" href="#error-responses" title="Permalink to this headline">¶</a></h5>
<p>If an error occurs while processing a request from a client, a server
will respond with an appropriate HTTP Status Code and the respond body
will provide additional details.</p>
<p>The structure of the error is as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">property</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>id</td>
<td>URI of the JSON schema for this error response.</td>
</tr>
<tr class="row-odd"><td>type</td>
<td>Absolute URI that identifies the error type.  This is the
same as the type in the error definition.</td>
</tr>
<tr class="row-even"><td>title</td>
<td>A short human readable summary of the problem type.  This
text MUST NOT change except for purposes of localization.</td>
</tr>
<tr class="row-odd"><td>detail</td>
<td><p class="first">A human readable explanation specific to this occurrence of the
problem.  The string SHOULD contain dynamic information
providing context for this occurrence.</p>
<p>This SHOULD focus on helping the end user correct the problem,
rather than providing debugging information.</p>
<p class="last">Clients SHOULD NOT attempt to parse this string.  Instead,
extensions (see additionalProperties) should be provided.</p>
</td>
</tr>
<tr class="row-even"><td>detail-values</td>
<td><p class="first">A dictionary of name/values pairs that identify the unique
information for this specific occurrence of the problem.</p>
<p>In general, these values could be plugged into a format
string to generate the <code class="docutils literal"><span class="pre">detail</span></code> above.</p>
<p class="last">The schema for the values SHOULD be defined in the
error definition under &#8220;properties&#8221;</p>
</td>
</tr>
<tr class="row-odd"><td><em>additional properties</em></td>
<td>Other custom properties that may be returned in the error
response.  The schema for these additional properties SHOULD be
defined in the error definition under &#8220;properties&#8221;.</td>
</tr>
</tbody>
</table>
<p>An example error response:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="s">&quot;http://support.riverbed.com/apis/bookstore/1.0/service.html#/errors/invalid_username&quot;</span>
<span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="s">&quot;The</span><span class="nv"> </span><span class="s">specified</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">invalid&quot;</span>
<span class="l-Scalar-Plain">detail</span><span class="p-Indicator">:</span> <span class="s">&quot;&#39;jdoe&#39;</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">valid</span><span class="nv"> </span><span class="s">username&quot;</span>
<span class="l-Scalar-Plain">detail-values</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span> <span class="s">&quot;jdoe&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="additional-properties">
<h5>Additional Properties<a class="headerlink" href="#additional-properties" title="Permalink to this headline">¶</a></h5>
<p>As described above, the error response may contain <em>additional
properties</em> that provide additional information beyond what is
specified here.  For example, a resource that is used to process web
forms may include an addition &#8220;form_fields&#8221; property that allows the
server to enumerate customer error messages for multiple form fields.</p>
<p>The error definition:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">errors</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">invalid_form</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="s">&quot;Form</span><span class="nv"> </span><span class="s">data</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">invalid.&quot;</span>
      <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
         <span class="no">A form was posted that does not satisfy one or more</span>
         <span class="no">constraints.  This may be values out of range, or may</span>
         <span class="no">be an invalid combination of field values.</span>
      <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">detail-values</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
            <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">fields</span><span class="p-Indicator">:</span>
                  <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">array</span>
                  <span class="l-Scalar-Plain">items</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span> <span class="p-Indicator">}</span>

         <span class="l-Scalar-Plain">form-fields</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
            <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
               <span class="no">Dictionary of form fields that failed validation.</span>
               <span class="no">The value for each field is a mesesage describing</span>
               <span class="no">why that field failed validation.</span>
            <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">message</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">string</span><span class="p-Indicator">}</span>
</pre></div>
</div>
<p>An example error response:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="s">&quot;http://support.riverbed.com/apis/bookstore/1.0/service.html#/errors/invalid_form&quot;</span>
<span class="l-Scalar-Plain">title</span><span class="p-Indicator">:</span> <span class="s">&quot;Form</span><span class="nv"> </span><span class="s">data</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">invalid.&quot;</span>
<span class="l-Scalar-Plain">detail</span><span class="p-Indicator">:</span> <span class="s">&quot;The</span><span class="nv"> </span><span class="s">following</span><span class="nv"> </span><span class="s">fields</span><span class="nv"> </span><span class="s">failed</span><span class="nv"> </span><span class="s">validation:</span><span class="nv"> </span><span class="s">SSN,</span><span class="nv"> </span><span class="s">email&quot;</span>
<span class="l-Scalar-Plain">detail-values</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">fields</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span> <span class="s">&quot;SSN&quot;</span><span class="p-Indicator">,</span> <span class="s">&quot;email&quot;</span> <span class="p-Indicator">]</span>
<span class="l-Scalar-Plain">form-fields</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">SSN</span><span class="p-Indicator">:</span> <span class="s">&quot;Social</span><span class="nv"> </span><span class="s">security</span><span class="nv"> </span><span class="s">number</span><span class="nv"> </span><span class="s">must</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">provied&quot;</span>
   <span class="l-Scalar-Plain">email</span><span class="p-Indicator">:</span> <span class="s">&quot;The</span><span class="nv"> </span><span class="s">email</span><span class="nv"> </span><span class="s">address</span><span class="nv"> </span><span class="s">provided</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">valid&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="versioning">
<h3>Versioning<a class="headerlink" href="#versioning" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code> object represents the complete REST API reference for a single
version of a single service.  The top level &#8220;version&#8221; property describes
the version.  Each time the REST API version number is changed, a new
documentation object must be generated.</p>
<p>Two versions of the <code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code> for the same service (describing two versions
of the REST API) may be compared programmatically to produce a change set, including:</p>
<ul class="simple">
<li>added or removed resources / methods</li>
<li>changes to existing methods</li>
<li>changes to descriptions and links</li>
</ul>
</div>
<div class="section" id="schema-best-practices">
<h3>Schema Best Practices<a class="headerlink" href="#schema-best-practices" title="Permalink to this headline">¶</a></h3>
<div class="section" id="always-return-an-object">
<h4>Always return an <code class="docutils literal"><span class="pre">object</span></code><a class="headerlink" href="#always-return-an-object" title="Permalink to this headline">¶</a></h4>
<p>Always return an <code class="docutils literal"><span class="pre">object</span></code>.  If the desired data type is number,
string, or array, wrap this in an <code class="docutils literal"><span class="pre">object</span></code>.  This enables the
inclusion of meta data.</p>
<p>In the case of an array, the property of the <code class="docutils literal"><span class="pre">object</span></code> that is the array
should be named &#8220;items&#8221;, as in:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">things</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
            <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">items</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span><span class="nv">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/thing&#39;</span><span class="p-Indicator">}</span>
</pre></div>
</div>
<p><strong>TODO</strong>:</p>
<ul class="simple">
<li>Arrays and paging XXX</li>
</ul>
<p><strong>TODO</strong> - examples</p>
</div>
<div class="section" id="include-all-link-variables-in-the-data-representation">
<h4>Include all link variables in the data representation<a class="headerlink" href="#include-all-link-variables-in-the-data-representation" title="Permalink to this headline">¶</a></h4>
<p>This is particularly important for the <code class="docutils literal"><span class="pre">self</span></code> link, but applies as a
general rule.  This allows data representations to be
&#8220;self-describing&#8221; &#8211; meaning that a client can determine the address
for a resource given the data representation and the schema for that
representation.</p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">book.links.self</span> <span class="pre">:</span> <span class="pre">{</span> <span class="pre">path:</span> <span class="pre">&quot;$/books/items/{id}&quot;</span> <span class="pre">}</span></code></dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">{id}</span></code> should be in the book data representation</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">book_chapter.links.self:</span> <span class="pre">{</span> <span class="pre">path:</span> <span class="pre">&quot;$/books/items/{bookid}/chapter/{num}&quot;</span> <span class="pre">}</span></code></dt>
<dd><ul class="first last simple">
<li>both <code class="docutils literal"><span class="pre">{bookid}</span></code> and <code class="docutils literal"><span class="pre">{num}</span></code> should be in the book_chapter data representation</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="use-plural-for-uri-of-collections">
<h4>Use plural for URI of collections<a class="headerlink" href="#use-plural-for-uri-of-collections" title="Permalink to this headline">¶</a></h4>
<p>Stylistic consideration, use the plural form for collections:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">books</span></code> schema has a path of &#8220;/books&#8221;</li>
<li><code class="docutils literal"><span class="pre">book</span></code> schema has a path of &#8220;/books/items/{id}&#8221;</li>
<li><code class="docutils literal"><span class="pre">authors</span></code> schema has a path of &#8220;/authors&#8221;</li>
<li><code class="docutils literal"><span class="pre">author</span></code> schema has a path of &#8220;/authors/{id}&#8221;</li>
</ul>
</div>
<div class="section" id="collections">
<h4>Collections<a class="headerlink" href="#collections" title="Permalink to this headline">¶</a></h4>
<p>Most RESTful interfaces provide one or more resources representing collections
of items. These collections can be recognized by one or more of
the following traits:</p>
<ol class="arabic simple">
<li>Using a custom tag (&#8220;tags: {collection: true}&#8221;)</li>
<li>The response object has an &#8220;items&#8221; property which has an array type</li>
<li>The response array items define an &#8220;instances&#8221; relation</li>
</ol>
<p>This guideline provides recommendations for collection resources, to provide
common functionality for manipulating elements and retrieving collection
information.</p>
<div class="section" id="reading-paging">
<h5>Reading &amp; Paging<a class="headerlink" href="#reading-paging" title="Permalink to this headline">¶</a></h5>
<p>To load the collection resource the client MUST send a GET request to the resource URI:</p>
<div class="highlight-python"><div class="highlight"><pre>=&gt; GET /api/bookstore/1.0/books

&lt;= HTTP 200 OK

{
    &quot;items&quot;: [
        { ... },
        { ... },
        ...
        { ... }
    ]
}
</pre></div>
</div>
<p>A collection resource MAY support additional parameters such as:</p>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">limit={N}</span></code> : maximum number of items in the &#8220;items&#8221; array</li>
<li><code class="docutils literal"><span class="pre">offset={N}</span></code> : tells the server to skip N items</li>
<li><code class="docutils literal"><span class="pre">sortby={fields}</span></code> : orders the items in the response according to the
specified field/fields</li>
<li><code class="docutils literal"><span class="pre">sort={directions}</span></code> : sorting direction - &#8216;asc&#8217; or &#8216;desc&#8217; (if sorting
on multiple fields, number of specifiers must match the number of fields)</li>
</ol>
<p>The response schema MAY be extended with a &#8220;meta&#8221; property which is an object
containing additional properties to aid the clients. For example:</p>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">total:</span> <span class="pre">integer</span></code> : total number of items on the server
(regardless of the limit/offset values)</li>
<li><code class="docutils literal"><span class="pre">count:</span> <span class="pre">integer</span></code> : size of the &#8220;items&#8221; collection</li>
<li><code class="docutils literal"><span class="pre">offset:</span> <span class="pre">integer</span></code> : offset used in the request</li>
<li><code class="docutils literal"><span class="pre">next_offset:</span> <span class="pre">integer</span></code> and <code class="docutils literal"><span class="pre">prev_offset:</span> <span class="pre">integer</span></code> : offset of the
next/previous page in a paged collection, which can be used in the
<code class="docutils literal"><span class="pre">next</span></code>/<code class="docutils literal"><span class="pre">prev</span></code> links in the resource definition</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is still considerable debate over the exact structure
of the &#8220;meta&#8221; object.</p>
</div>
<p>If the resource does return the information specified for the &#8220;meta&#8221;
property, its SHOULD use the &#8220;meta&#8221; property and the property names
documented above.  A resource MAY choose to support only some meta fields,
or to not support a &#8220;meta&#8221; section at all.</p>
<p>Example:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">resources</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">books</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
      <span class="l-Scalar-Plain">additionalProperties</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">False</span>
      <span class="l-Scalar-Plain">required</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">items</span><span class="p-Indicator">]</span>
      <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">items</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">array</span>
            <span class="l-Scalar-Plain">items</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">$ref</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/book&#39;</span>
         <span class="l-Scalar-Plain">meta</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">object</span>
            <span class="l-Scalar-Plain">readOnly</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
            <span class="l-Scalar-Plain">additionalProperties</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">False</span>
            <span class="l-Scalar-Plain">properties</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">offset</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">integer</span> <span class="p-Indicator">}</span>
               <span class="l-Scalar-Plain">limit</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">integer</span> <span class="p-Indicator">}</span>
               <span class="l-Scalar-Plain">total</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">integer</span> <span class="p-Indicator">}</span>
               <span class="l-Scalar-Plain">count</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">integer</span> <span class="p-Indicator">}</span>
               <span class="l-Scalar-Plain">next_offset</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">integer</span> <span class="p-Indicator">}</span>
               <span class="l-Scalar-Plain">prev_offset</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">integer</span> <span class="p-Indicator">}</span>
      <span class="l-Scalar-Plain">relations</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">next_page</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/books&#39;</span>
            <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">offset</span><span class="p-Indicator">:</span> <span class="s">&#39;0/meta/next_offset&#39;</span>
               <span class="l-Scalar-Plain">limit</span><span class="p-Indicator">:</span>  <span class="s">&#39;0/meta/limit&#39;</span>
         <span class="l-Scalar-Plain">prev_page</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;#/resources/books&#39;</span>
            <span class="l-Scalar-Plain">vars</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">offset</span><span class="p-Indicator">:</span> <span class="s">&#39;0/meta/prev_offset&#39;</span>
               <span class="l-Scalar-Plain">limit</span><span class="p-Indicator">:</span>  <span class="s">&#39;0/meta/limit&#39;</span>
      <span class="l-Scalar-Plain">links</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">self</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="s">&quot;$/books&quot;</span>
            <span class="l-Scalar-Plain">params</span><span class="p-Indicator">:</span>
               <span class="l-Scalar-Plain">offset</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
               <span class="l-Scalar-Plain">limit</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">type</span><span class="p-Indicator">:</span> <span class="nv">number</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>=&gt; GET /api/bookstore/1.0/books?limit=5&amp;offset=10&amp;sortby=title&amp;sort=asc
&lt;= HTTP 200 OK

{
    &quot;items&quot;: [
        { ... },
        { ... },
        { ... },
        { ... },
        { ... }
    ],
    &quot;meta&quot;: {
        &quot;total&quot;: 1974,
        &quot;count&quot;: 5,
        &quot;offset&quot;: 10,
        &quot;next_offset&quot;: 15,
        &quot;prev_offset&quot;: 5
    }
}
</pre></div>
</div>
</div>
<div class="section" id="creating">
<h5>Creating<a class="headerlink" href="#creating" title="Permalink to this headline">¶</a></h5>
<p>To create an element in a collection the client SHOULD POST the creation data to the collection URI.</p>
<div class="highlight-python"><div class="highlight"><pre>=&gt; POST /api/bookstore/1.0/books
{
    &quot;title&quot;: &quot;YUI Cookbook&quot;,
    &quot;isbn&quot;: &quot;1449304192&quot;
}

&lt;= HTTP 201 Created
Location: /api/bookstore/1.0/books/items/1975
</pre></div>
</div>
<p>The server MUST reply with a 201 code and a <code class="docutils literal"><span class="pre">Location</span></code> header referring to
the URI of the created resource. The server MAY also return a representation
of the created resource.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently Location headers are not supported by either Lumberjack or
sleepwalker, and reschema has no way to enforce anything about them.
In effect, it is not really behaving as a MUST condition at this time.
Need bugs filed on this.</p>
</div>
</div>
<div class="section" id="deleting">
<h5>Deleting<a class="headerlink" href="#deleting" title="Permalink to this headline">¶</a></h5>
<p>To delete a collection element simply send a DELETE request on the resource URI:</p>
<div class="highlight-python"><div class="highlight"><pre>=&gt; DELETE /api/bookstore/1.0/books/items/1975
&lt;= HTTP 204 No Content

=&gt; GET /api/bookstore/1.0/books/items/1975
&lt;= HTTP 404 Not Found
</pre></div>
</div>
</div>
<div class="section" id="updating">
<h5>Updating<a class="headerlink" href="#updating" title="Permalink to this headline">¶</a></h5>
<p>To update a collection element, the client SHOULD send a PUT request on an
element URI with a body containing full resource representation. The server
MAY reply with an updated resource representation (which may contain
updated read-only fields).  If no resource representation is desired due
to concerns such as performance issues with large resources,
the resource MUST return a 204.</p>
<div class="highlight-python"><div class="highlight"><pre>=&gt; PUT /api/bookstore/1.0/books/items/1975
{
    &quot;title&quot;: &quot;YUI3 Cookbook&quot;,
    &quot;isbn&quot;: &quot;1449304192&quot;
}

&lt;= HTTP 200 OK
{
    &quot;title&quot;: &quot;YUI3 Cookbook&quot;,
    &quot;isbn&quot;: &quot;1449304192&quot;
}
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="example-bookstore">
<h2>Example: Bookstore<a class="headerlink" href="#example-bookstore" title="Permalink to this headline">¶</a></h2>
<p>Consider a simple REST API that provides access to a bookstore&#8217;s inventory.</p>
<p>The <code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code> that describes this API: <a class="reference external" href="https://gitlab.lab.nbttech.com/steelscript/reschema/blob/master/examples/bookstore.yaml">bookstore.yaml</a></p>
<p>This example demonstrates most of the capabilities of both the <code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code> schema
as well as JSON Schema itself:</p>
<ul class="simple">
<li>Defines schemas, resources, methods, errors, and tasks</li>
<li>Leverages schemas by &#8220;$ref&#8221;</li>
<li>Examples and tasks by reference to external files</li>
<li>Field constraints: limits, patterns, enumerations</li>
</ul>
</div>
<div class="section" id="appendix-json-pointers">
<h2>Appendix: JSON Pointers<a class="headerlink" href="#appendix-json-pointers" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://tools.ietf.org/html/rfc6901">RFC 7901</a> defines JSON Pointer notation
which allows indexing into an arbitrary JSON object via a string.  The
basic syntax looks very much like traversing a directory structure, using
&#8220;/&#8221; as a delimiter.</p>
<p>Consider the following JSON data:</p>
<div class="highlight-json"><div class="highlight"><pre>{
   &quot;id&quot;: 1,
   &quot;name&quot;: {
      &quot;first&quot;: &quot;John&quot;,
      &quot;last&quot;: Doe
   },
   &quot;age&quot;: 42,
   &quot;children&quot; : [
      { &quot;first&quot;: &quot;Susan&quot;,
        &quot;age&quot;: 4 },
      { &quot;first&quot;: &quot;Bob&quot;,
        &quot;age&quot;: 10 }
   ]
}
</pre></div>
</div>
<p>The following table shows a few JSON Pointers and the resulting data:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">JSON Pointer</th>
<th class="head">Result</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&#8220;&#8221;</td>
<td><code class="docutils literal"><span class="pre">{</span> <span class="pre">'id':</span> <span class="pre">1</span> <span class="pre">....</span> <span class="pre">}</span></code> (The entire data structure)</td>
</tr>
<tr class="row-odd"><td>&#8216;/id&#8217;</td>
<td><code class="docutils literal"><span class="pre">1</span></code></td>
</tr>
<tr class="row-even"><td>&#8216;/name&#8217;</td>
<td><code class="docutils literal"><span class="pre">{</span> <span class="pre">&quot;first&quot;:</span> <span class="pre">&quot;John&quot;,</span> <span class="pre">&quot;last&quot;:</span> <span class="pre">&quot;Doe&quot;</span> <span class="pre">}</span></code></td>
</tr>
<tr class="row-odd"><td>&#8216;/name/first&#8217;</td>
<td><code class="docutils literal"><span class="pre">&quot;John&quot;</span></code></td>
</tr>
<tr class="row-even"><td>&#8216;/children/0/first&#8217;</td>
<td><code class="docutils literal"><span class="pre">&quot;Susan&quot;</span></code></td>
</tr>
<tr class="row-odd"><td>&#8216;/children/1/age&#8217;</td>
<td><code class="docutils literal"><span class="pre">10</span></code></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="appendix-relative-json-pointers">
<h2>Appendix Relative JSON Pointers<a class="headerlink" href="#appendix-relative-json-pointers" title="Permalink to this headline">¶</a></h2>
<p>Relative JSON pointers
<a class="reference external" href="http://datatracker.ietf.org/doc/draft-luff-relative-json-pointer/">IETF draft</a>
allows starting at some arbitrary point in JSON data and then
indexing to some other point in that same data.</p>
<p>The basic syntax of a relative JSON Pointer is &#8220;&lt;scope&gt;/&lt;json pointer&gt;&#8221;,
where scope defines the number of levels to proceed <em>up</em> the data structure
from the current location, then follow the &lt;json pointer&gt; to retrieve the
instance value.</p>
<p>Using the directory structure notation, this is like traversing up
multiple directory levels before iterating back down.</p>
<p>Using the same data object as above, the following table illustrates
the result of a relative JSON pointer based up a starting location:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Starting point</th>
<th class="head">Relative JSON Pointer</th>
<th class="head">Result</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&#8216;/name/first&#8217;</td>
<td>&#8216;1&#8217;</td>
<td><code class="docutils literal"><span class="pre">{</span> <span class="pre">'first':</span> <span class="pre">'John',</span> <span class="pre">'last':</span> <span class="pre">'Doe'</span> <span class="pre">}</span></code></td>
</tr>
<tr class="row-odd"><td>&#8216;/name/first&#8217;</td>
<td>&#8216;1/last&#8217;</td>
<td><code class="docutils literal"><span class="pre">'Doe'</span></code></td>
</tr>
<tr class="row-even"><td>&#8216;/name/first&#8217;</td>
<td>&#8216;2/name/last&#8217;</td>
<td><code class="docutils literal"><span class="pre">'Doe'</span></code></td>
</tr>
<tr class="row-odd"><td>&#8216;/children/0&#8217;</td>
<td>&#8216;0/first&#8217;</td>
<td><code class="docutils literal"><span class="pre">'Susan'</span></code></td>
</tr>
<tr class="row-even"><td>&#8216;/children/0&#8217;</td>
<td>&#8216;1/1/first&#8217;</td>
<td><code class="docutils literal"><span class="pre">'Bob'</span></code></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://tools.ietf.org/html/draft-zyp-json-schema-04">JSON Schema draft 04</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/rb-ss-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="overview.html">reschema</a></h3>
  <ul>
<li><a class="reference internal" href="#">Service Definition Specification</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#background">Background</a><ul>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
<li><a class="reference internal" href="#supporting-client-libraries">Supporting Client Libraries</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#documentation-conventions">Documentation Conventions</a></li>
<li><a class="reference internal" href="#json-schema">JSON Schema</a></li>
<li><a class="reference internal" href="#rest-api-service-definition-object-service-definition">REST API Service Definition Object (<code class="docutils literal"><span class="pre">service</span> <span class="pre">definition</span></code>)</a><ul>
<li><a class="reference internal" href="#service-definition-object">Service Definition Object</a></li>
<li><a class="reference internal" href="#service-definition-id">Service definition &#8216;id&#8217;</a></li>
<li><a class="reference internal" href="#service-path">Service Path</a></li>
<li><a class="reference internal" href="#types">Types</a></li>
<li><a class="reference internal" href="#resources">Resources</a><ul>
<li><a class="reference internal" href="#links">Links</a><ul>
<li><a class="reference internal" href="#the-ref-syntax">The <code class="docutils literal"><span class="pre">$ref</span></code> syntax</a></li>
<li><a class="reference internal" href="#the-self-link">The <code class="docutils literal"><span class="pre">self</span></code> link</a></li>
<li><a class="reference internal" href="#standard-links-get-set-create-delete">Standard links: get, set, create, delete</a></li>
<li><a class="reference internal" href="#verbs">Verbs</a></li>
<li><a class="reference internal" href="#merge-syntax"><code class="docutils literal"><span class="pre">$merge</span></code> syntax</a></li>
</ul>
</li>
<li><a class="reference internal" href="#relations">Relations</a><ul>
<li><a class="reference internal" href="#syntax">Syntax</a></li>
<li><a class="reference internal" href="#resource-references"><code class="docutils literal"><span class="pre">resource</span></code> references</a></li>
<li><a class="reference internal" href="#and-uri-resolution-across-services"><code class="docutils literal"><span class="pre">$</span></code> and URI resolution across services</a></li>
<li><a class="reference internal" href="#full-and-instances-relations"><code class="docutils literal"><span class="pre">full</span></code> and <code class="docutils literal"><span class="pre">instances</span></code> relations</a></li>
<li><a class="reference internal" href="#mapping-values-to-self-link-parameters">Mapping values to self link parameters</a></li>
<li><a class="reference internal" href="#example-relation-publisher-of-a-book">Example relation: publisher of a book</a></li>
</ul>
</li>
<li><a class="reference internal" href="#singletons-versus-instances">Singletons versus instances</a></li>
<li><a class="reference internal" href="#collections-and-nested-links-and-relations">Collections and nested links and relations</a></li>
<li><a class="reference internal" href="#paths">Paths</a></li>
</ul>
</li>
<li><a class="reference internal" href="#errors">Errors</a><ul>
<li><a class="reference internal" href="#service-defined-errors">Service Defined Errors</a></li>
<li><a class="reference internal" href="#error-responses">Error Responses</a></li>
<li><a class="reference internal" href="#additional-properties">Additional Properties</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#versioning">Versioning</a></li>
<li><a class="reference internal" href="#schema-best-practices">Schema Best Practices</a><ul>
<li><a class="reference internal" href="#always-return-an-object">Always return an <code class="docutils literal"><span class="pre">object</span></code></a></li>
<li><a class="reference internal" href="#include-all-link-variables-in-the-data-representation">Include all link variables in the data representation</a></li>
<li><a class="reference internal" href="#use-plural-for-uri-of-collections">Use plural for URI of collections</a></li>
<li><a class="reference internal" href="#collections">Collections</a><ul>
<li><a class="reference internal" href="#reading-paging">Reading &amp; Paging</a></li>
<li><a class="reference internal" href="#creating">Creating</a></li>
<li><a class="reference internal" href="#deleting">Deleting</a></li>
<li><a class="reference internal" href="#updating">Updating</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#example-bookstore">Example: Bookstore</a></li>
<li><a class="reference internal" href="#appendix-json-pointers">Appendix: JSON Pointers</a></li>
<li><a class="reference internal" href="#appendix-relative-json-pointers">Appendix Relative JSON Pointers</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/reschema/specification.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>
<a href="../license.html">License</a>
</h3>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">steelscript  documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015 Riverbed Technology, Inc..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>