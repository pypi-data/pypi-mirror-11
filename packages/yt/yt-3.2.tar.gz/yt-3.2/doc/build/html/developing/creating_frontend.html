<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Creating A New Code Frontend &mdash; The yt Project 3.2-dev documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.4/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.2-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="The yt Project 3.2-dev documentation" href="../index.html" />
    <link rel="up" title="Developing in yt" href="index.html" />
    <link rel="next" title="Using yt with External Analysis Tools" href="external_analysis.html" />
    <link rel="prev" title="Creating Derived Quantities" href="creating_derived_quantities.html" />
    
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-391373-2']);
      _gaq.push(['_setDomainName', 'yt-project.org']);
      _gaq.push(['_setAllowHash', false]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/yt_icon.png">
          The yt Project</a>
        <span class="navbar-text navbar-version pull-left"><b>3.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../help/index.html">How to get help</a></li>
                <li><a href="../quickstart/index.html">Quickstart notebooks</a></li>
                <li><a href="../cookbook/index.html">Cookbook</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Getting and Installing yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installing.html#getting-yt">Getting yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing.html#testing-your-installation">Testing Your Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing.html#switching-between-yt-2-x-and-yt-3-x">Switching between yt-2.x and yt-3.x</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">yt Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/data_inspection.html">Data Inspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/simple_visualization.html">Simple Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/data_objects_and_time_series.html">Data Objects and Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/derived_fields_and_profiles.html">Derived Fields and Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/volume_rendering.html">Volume Rendering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../yt3differences.html">What&#8217;s New and Different in yt 3.0?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../yt3differences.html#updating-to-yt-3-0-from-old-versions-and-going-back">Updating to yt 3.0 from Old Versions (and going back)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../yt3differences.html#converting-old-scripts-to-work-with-yt-3-0">Converting Old Scripts to Work with yt 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../yt3differences.html#cool-new-things">Cool New Things</a></li>
<li class="toctree-l2"><a class="reference internal" href="../yt3differences.html#api-changes">API Changes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook/index.html">The Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/index.html#getting-the-sample-data">Getting the Sample Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/index.html#example-scripts">Example Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/index.html#example-notebooks">Example Notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../visualizing/index.html">Visualizing Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/plots.html">How to Make Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/callbacks.html">Plot Modifications: Overplotting Contours, Velocities, Particles, and More</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/manual_plotting.html">Using the Manual Plotting Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/volume_rendering.html">Volume Rendering: Making 3D Photorealistic Isocontoured Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/hardware_volume_rendering.html">Hardware Volume Rendering on NVidia Graphics cards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/sketchfab.html">3D Surfaces and Sketchfab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/mapserver.html">Mapserver - A Google-Maps-like Interface to your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/streamlines.html">Streamlines: Tracking the Trajectories of Tracers in your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/colormaps/index.html">Colormaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/writing_fits_images.html">Writing FITS Images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../analyzing/index.html">General Data Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/fields.html">Fields in yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating_derived_fields.html">Creating Derived Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/objects.html">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/units/index.html">Symbolic Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/filtering.html">Filtering your Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/generating_processed_data.html">Generating Processed Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/time_series_analysis.html">Time Series Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/parallel_computation.html">Parallel Computation With yt</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../analyzing/analysis_modules/index.html">Topic-Specific Analysis Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/halo_analysis.html">Halo Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/synthetic_observation.html">Synthetic Observation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/exporting.html">Exporting to External Radiation Transport Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/two_point_functions.html">Two Point Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/clump_finding.html">Clump Finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/particle_trajectories.html">Particle Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/ellipsoid_analysis.html">Halo Ellipsoid Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examining/index.html">Loading and Examining Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examining/loading_data.html">Loading Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examining/generic_array_data.html">Loading Generic Array Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examining/generic_particle_data.html">Loading Generic Particle Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examining/spherical_data.html">Loading Spherical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examining/low_level_inspection.html">Low-Level Data Inspection: Accessing Raw Data</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developing in yt</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Getting Involved</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing.html">How to Develop yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="building_the_docs.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugdrive.html">Debugging yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating_datatypes.html">Creating Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating_derived_fields.html">Creating Derived Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating_derived_quantities.html">Creating Derived Quantities</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Creating A New Code Frontend</a></li>
<li class="toctree-l2"><a class="reference internal" href="external_analysis.html">Using yt with External Analysis Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference Materials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/code_support.html">Code Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/command-line.html">Command-Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/api/api.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/configuration.html">Customizing yt: The Configuration and Plugin Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/field_list.html">Field List</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/changelog.html">ChangeLog</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#version-installation">Version &amp; Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#code-errors-and-failures">Code Errors and Failures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#units">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#fields">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#data-objects">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#developing">Developing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../help/index.html">Getting Help</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#don-t-panic-and-don-t-give-up">Don&#8217;t panic and don&#8217;t give up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#update-to-the-latest-version">Update to the latest version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#search-the-documentation-faq-and-mailing-lists">Search the documentation, FAQ, and mailing lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#look-at-the-source-code">Look at the source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#isolate-and-document-your-problem">Isolate and document your problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#go-on-irc-to-ask-a-question">Go on IRC to ask a question</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#ask-the-mailing-list">Ask the mailing list</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#submit-a-bug-report">Submit a bug report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#special-issues">Special Issues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about/index.html#what-is-yt">What is yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/index.html#who-is-yt">Who is yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/index.html#history-of-yt">History of yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/index.html#how-do-i-contact-yt">How do I contact yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/index.html#how-do-i-cite-yt">How do I cite yt?</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Creating A New Code Frontend</a><ul>
<li><a class="reference internal" href="#data-meaning-structures">Data Meaning Structures</a></li>
<li><a class="reference internal" href="#data-localization-structures">Data Localization Structures</a><ul>
<li><a class="reference internal" href="#hierarchy-or-index">Hierarchy or Index</a></li>
<li><a class="reference internal" href="#grids">Grids</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-reading-functions">Data Reading Functions</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="creating-a-new-code-frontend">
<span id="creating-frontend"></span><h1>Creating A New Code Frontend<a class="headerlink" href="#creating-a-new-code-frontend" title="Permalink to this headline">¶</a></h1>
<p>yt is designed to support analysis and visualization of data from
multiple different simulation codes. For a list of codes and the level
of support they enjoy, see <a class="reference internal" href="../reference/code_support.html#code-support"><span>Code Support</span></a>.</p>
<p>We&#8217;d like to support a broad range of codes, both Adaptive Mesh
Refinement (AMR)-based and otherwise. To add support for a new code, a
few things need to be put into place. These necessary structures can
be classified into a couple categories:</p>
<blockquote>
<div><ul class="simple">
<li>Data meaning: This is the set of parameters that convert the data into
physically relevant units; things like spatial and mass conversions, time
units, and so on.</li>
<li>Data localization: These are structures that help make a &#8220;first pass&#8221; at data
loading. Essentially, we need to be able to make a first pass at guessing
where data in a given physical region would be located on disk. With AMR
data, this is typically quite easy: the grid patches are the &#8220;first pass&#8221; at
localization.</li>
<li>Data reading: This is the set of routines that actually perform a read of
either all data in a region or a subset of that data.</li>
</ul>
</div></blockquote>
<div class="section" id="data-meaning-structures">
<h2>Data Meaning Structures<a class="headerlink" href="#data-meaning-structures" title="Permalink to this headline">¶</a></h2>
<p>If you are interested in adding a new code, be sure to drop us a line on
<a class="reference external" href="http://lists.spacepope.org/listinfo.cgi/yt-dev-spacepope.org">yt-dev</a>!</p>
<p>To get started, make a new directory in <code class="docutils literal"><span class="pre">yt/frontends</span></code> with the name
of your code.  Copying the contents of the <code class="docutils literal"><span class="pre">yt/frontends/_skeleton</span></code>
directory will add a lot of boilerplate for the required classes and
methods that are needed.  In particular, you&#8217;ll have to create a
subclass of <code class="docutils literal"><span class="pre">Dataset</span></code> in the data_structures.py file. This subclass
will need to handle conversion between the different physical units
and the code units (typically in the <code class="docutils literal"><span class="pre">_set_code_unit_attributes()</span></code>
method), read in metadata describing the overall data on disk (via the
<code class="docutils literal"><span class="pre">_parse_parameter_file()</span></code> method), and provide a <code class="docutils literal"><span class="pre">classmethod</span></code>
called <code class="docutils literal"><span class="pre">_is_valid()</span></code> that lets the <code class="docutils literal"><span class="pre">yt.load</span></code> method help identify an
input file as belonging to <em>this</em> particular <code class="docutils literal"><span class="pre">Dataset</span></code> subclass.
For the most part, the examples of
<code class="docutils literal"><span class="pre">yt.frontends.boxlib.data_structures.OrionDataset</span></code> and
<code class="docutils literal"><span class="pre">yt.frontends.enzo.data_structures.EnzoDataset</span></code> should be followed,
but <code class="docutils literal"><span class="pre">yt.frontends.chombo.data_structures.ChomboDataset</span></code>, as a
slightly newer addition, can also be used as an instructive example.</p>
<p>A new set of fields must be added in the file <code class="docutils literal"><span class="pre">fields.py</span></code> in your
new directory.  For the most part this means subclassing
<code class="docutils literal"><span class="pre">FieldInfoContainer</span></code> and adding the necessary fields specific to
your code. Here is a snippet from the base BoxLib field container:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">yt.fields.field_info_container</span> <span class="kn">import</span> <span class="n">FieldInfoContainer</span>
<span class="k">class</span> <span class="nc">BoxlibFieldInfo</span><span class="p">(</span><span class="n">FieldInfoContainer</span><span class="p">):</span>
    <span class="n">known_other_fields</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s">&quot;density&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">rho_units</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;density&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;eden&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">eden_units</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;energy_density&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;xmom&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">mom_units</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;momentum_x&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;ymom&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">mom_units</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;momentum_y&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;zmom&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">mom_units</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;momentum_z&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;temperature&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;K&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;temperature&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;Temp&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;K&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;temperature&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;x_velocity&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;cm/s&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;velocity_x&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;y_velocity&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;cm/s&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;velocity_y&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;z_velocity&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;cm/s&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;velocity_z&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;xvel&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;cm/s&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;velocity_x&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;yvel&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;cm/s&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;velocity_y&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;zvel&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;cm/s&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;velocity_z&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
    <span class="p">)</span>

    <span class="n">known_particle_fields</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s">&quot;particle_mass&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;code_mass&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;particle_position_x&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;code_length&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;particle_position_y&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;code_length&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;particle_position_z&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;code_length&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;particle_momentum_x&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">mom_units</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;particle_momentum_y&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">mom_units</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;particle_momentum_z&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">mom_units</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;particle_angmomen_x&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;code_length**2/code_time&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;particle_angmomen_y&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;code_length**2/code_time&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;particle_angmomen_z&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;code_length**2/code_time&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;particle_id&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;particle_index&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">&quot;particle_mdot&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;code_mass/code_time&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">)),</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>The tuples, <code class="docutils literal"><span class="pre">known_other_fields</span></code> and <code class="docutils literal"><span class="pre">known_particle_fields</span></code>
contain entries, which are tuples of the form <code class="docutils literal"><span class="pre">(&quot;name&quot;,</span> <span class="pre">(&quot;units&quot;,</span>
<span class="pre">[&quot;fields&quot;,</span> <span class="pre">&quot;to&quot;,</span> <span class="pre">&quot;alias&quot;],</span> <span class="pre">&quot;display_name&quot;))</span></code>.  <code class="docutils literal"><span class="pre">&quot;name&quot;</span></code> is the name
of a field stored on-disk in the dataset. <code class="docutils literal"><span class="pre">&quot;units&quot;</span></code> corresponds to
the units of that field.  The list <code class="docutils literal"><span class="pre">[&quot;fields&quot;,</span> <span class="pre">&quot;to&quot;,</span> <span class="pre">&quot;alias&quot;]</span></code>
allows you to specify additional aliases to this particular field; for
example, if your on-disk field for the x-direction velocity were
<code class="docutils literal"><span class="pre">&quot;x-direction-velocity&quot;</span></code>, maybe you&#8217;d prefer to alias to the more
terse name of <code class="docutils literal"><span class="pre">&quot;xvel&quot;</span></code>.  <code class="docutils literal"><span class="pre">&quot;display_name&quot;</span></code> is an optional parameter
that can be used to specify how you want the field to be displayed on
a plot; this can be LaTeX code, for example the density field could
have a display name of <code class="docutils literal"><span class="pre">r&quot;\rho&quot;</span></code>.  Omitting the <code class="docutils literal"><span class="pre">&quot;display_name&quot;</span></code>
will result in using a capitalized version of the <code class="docutils literal"><span class="pre">&quot;name&quot;</span></code>.</p>
</div>
<div class="section" id="data-localization-structures">
<h2>Data Localization Structures<a class="headerlink" href="#data-localization-structures" title="Permalink to this headline">¶</a></h2>
<p>These functions and classes let yt know about how the arrangement of
data on disk corresponds to the physical arrangement of data within
the simulation.  yt has grid datastructures for handling both
patch-based and octree-based AMR codes.  The terms &#8216;patch-based&#8217;
and &#8216;octree-based&#8217; are used somewhat loosely here.  For example,
traditionally, the FLASH code used the paramesh AMR library, which is
based on a tree structure, but the FLASH frontend in yt utilizes yt&#8217;s
patch-based datastructures.  It is up to the frontend developer to
determine which yt datastructures best match the datastructures of
their simulation code.</p>
<p>Both approaches &#8211; patch-based and octree-based &#8211; have a concept of a
<em>Hierarchy</em> or <em>Index</em> (used somewhat interchangeably in the code) of
datastructures and something that describes the elements that make up
the Hierarchy or Index.  For patch-based codes, the Index is a
collection of <code class="docutils literal"><span class="pre">AMRGridPatch</span></code> objects that describe a block of zones.
For octree-based codes, the Index contains datastructures that hold
information about the individual octs, namely an <code class="docutils literal"><span class="pre">OctreeContainer</span></code>.</p>
<div class="section" id="hierarchy-or-index">
<h3>Hierarchy or Index<a class="headerlink" href="#hierarchy-or-index" title="Permalink to this headline">¶</a></h3>
<p>To set up data localization, a <code class="docutils literal"><span class="pre">GridIndex</span></code> subclass for patch-based
codes or an <code class="docutils literal"><span class="pre">OctreeIndex</span></code> subclass for octree-based codes must be
added in the file <code class="docutils literal"><span class="pre">data_structures.py</span></code>. Examples of these different
types of <code class="docutils literal"><span class="pre">Index</span></code> can be found in, for example, the
<code class="docutils literal"><span class="pre">yt.frontends.chombo.data_structures.ChomboHierarchy</span></code> for patch-based
codes and <code class="docutils literal"><span class="pre">yt.frontends.ramses.data_structures.RAMSESIndex</span></code> for
octree-based codes.</p>
<p>For the most part, the <code class="docutils literal"><span class="pre">GridIndex</span></code> subclass must override (at a
minimum) the following methods:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">_detect_output_fields()</span></code>: <code class="docutils literal"><span class="pre">self.field_list</span></code> must be populated as a list
of strings corresponding to &#8220;native&#8221; fields in the data files.</li>
<li><code class="docutils literal"><span class="pre">_count_grids()</span></code>: this must set <code class="docutils literal"><span class="pre">self.num_grids</span></code> to be the total number
of grids (equivalently <code class="docutils literal"><span class="pre">AMRGridPatch</span></code>&#8216;es) in the simulation.</li>
<li><code class="docutils literal"><span class="pre">_parse_index()</span></code>: this must fill in <code class="docutils literal"><span class="pre">grid_left_edge</span></code>,
<code class="docutils literal"><span class="pre">grid_right_edge</span></code>, <code class="docutils literal"><span class="pre">grid_particle_count</span></code>, <code class="docutils literal"><span class="pre">grid_dimensions</span></code> and
<code class="docutils literal"><span class="pre">grid_levels</span></code> with the appropriate information.  Each of these variables
is an array, with an entry for each of the <code class="docutils literal"><span class="pre">self.num_grids</span></code> grids.
Additionally, <code class="docutils literal"><span class="pre">grids</span></code>  must be an array of <code class="docutils literal"><span class="pre">AMRGridPatch</span></code> objects that
already know their IDs.</li>
<li><code class="docutils literal"><span class="pre">_populate_grid_objects()</span></code>: this initializes the grids by calling
<code class="docutils literal"><span class="pre">_prepare_grid()</span></code> and <code class="docutils literal"><span class="pre">_setup_dx()</span></code> on all of them.  Additionally, it
should set up <code class="docutils literal"><span class="pre">Children</span></code> and <code class="docutils literal"><span class="pre">Parent</span></code> lists on each grid object.</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal"><span class="pre">OctreeIndex</span></code> has somewhat analogous methods, but often with
different names; both <code class="docutils literal"><span class="pre">OctreeIndex</span></code> and <code class="docutils literal"><span class="pre">GridIndex</span></code> are subclasses
of the <code class="docutils literal"><span class="pre">Index</span></code> class.  In particular, for the <code class="docutils literal"><span class="pre">OctreeIndex</span></code>, the
method <code class="docutils literal"><span class="pre">_initialize_oct_handler()</span></code> setups up much of the oct
metadata that is analogous to the grid metadata created in the
<code class="docutils literal"><span class="pre">GridIndex</span></code> methods <code class="docutils literal"><span class="pre">_count_grids()</span></code>, <code class="docutils literal"><span class="pre">_parse_index()</span></code>, and
<code class="docutils literal"><span class="pre">_populate_grid_objects()</span></code>.</p>
</div>
<div class="section" id="grids">
<h3>Grids<a class="headerlink" href="#grids" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section only applies to the approach using yt&#8217;s patch-based
datastructures.  For the octree-based approach, one does not create
a grid object, but rather an <code class="docutils literal"><span class="pre">OctreeSubset</span></code>, which has methods
for filling out portions of the octree structure.  Again, see the
code in <code class="docutils literal"><span class="pre">yt.frontends.ramses.data_structures</span></code> for an example of
the octree approach.</p>
</div>
<p>A new grid object, subclassing <code class="docutils literal"><span class="pre">AMRGridPatch</span></code>, will also have to be added in
<code class="docutils literal"><span class="pre">data_structures.py</span></code>. For the most part, this may be all
that is needed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ChomboGrid</span><span class="p">(</span><span class="n">AMRGridPatch</span><span class="p">):</span>
    <span class="n">_id_offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;_level_id&quot;</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">AMRGridPatch</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">index_filename</span><span class="p">,</span>
                              <span class="n">index</span> <span class="o">=</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Parent</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Children</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Level</span> <span class="o">=</span> <span class="n">level</span>
</pre></div>
</div>
<p>Even one of the more complex grid objects,
<code class="docutils literal"><span class="pre">yt.frontends.boxlib.BoxlibGrid</span></code>, is still relatively simple.</p>
</div>
</div>
<div class="section" id="data-reading-functions">
<h2>Data Reading Functions<a class="headerlink" href="#data-reading-functions" title="Permalink to this headline">¶</a></h2>
<p>In <code class="docutils literal"><span class="pre">io.py</span></code>, there are a number of IO handlers that handle the
mechanisms by which data is read off disk.  To implement a new data
reader, you must subclass <code class="docutils literal"><span class="pre">BaseIOHandler</span></code>.  The various frontend IO
handlers are stored in an IO registry - essentially a dictionary that
uses the name of the frontend as a key, and the specific IO handler as
a value.  It is important, therefore, to set the <code class="docutils literal"><span class="pre">dataset_type</span></code>
attribute of your subclass, which is what is used as the key in the IO
registry.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">IOHandlerBoxlib</span><span class="p">(</span><span class="n">BaseIOHandler</span><span class="p">):</span>
    <span class="n">_dataset_type</span> <span class="o">=</span> <span class="s">&quot;boxlib_native&quot;</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>At a minimum, one should also override the following methods</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">_read_fluid_selection()</span></code>: this receives a collection of data &#8220;chunks&#8221;, a
selector describing which &#8220;chunks&#8221; you are concerned with, a list of fields,
and the size of the data to read.  It should create and return a dictionary
whose keys are the fields, and whose values are numpy arrays containing the
data.  The data should actually be read via the <code class="docutils literal"><span class="pre">_read_chunk_data()</span></code>
method.</li>
<li><code class="docutils literal"><span class="pre">_read_chunk_data()</span></code>: this method receives a &#8220;chunk&#8221; of data along with a
list of fields we want to read.  It loops over all the grid objects within
the &#8220;chunk&#8221; of data and reads from disk the specific fields, returning a
dictionary whose keys are the fields and whose values are numpy arrays of
the data.</li>
</ul>
<p>If your dataset has particle information, you&#8217;ll want to override the
<code class="docutils literal"><span class="pre">_read_particle_coords()</span></code> and <code class="docutils literal"><span class="pre">read_particle_fields()</span></code> methods as
well.  Each code is going to read data from disk in a different
fashion, but the <code class="docutils literal"><span class="pre">yt.frontends.boxlib.io.IOHandlerBoxlib</span></code> is a
decent place to start.</p>
<p>And that just about covers it. Please feel free to email
<a class="reference external" href="http://lists.spacepope.org/listinfo.cgi/yt-users-spacepope.org">yt-users</a> or
<a class="reference external" href="http://lists.spacepope.org/listinfo.cgi/yt-dev-spacepope.org">yt-dev</a> with
any questions, or to let us know you&#8217;re thinking about adding a new code to yt.</p>
</div>
</div>


    </div>
      
  </div>
</div>
    <div class="footer">
      &copy; Copyright 2013, the yt Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>