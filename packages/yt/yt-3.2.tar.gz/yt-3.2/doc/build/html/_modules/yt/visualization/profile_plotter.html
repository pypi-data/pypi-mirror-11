<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>yt.visualization.profile_plotter &mdash; The yt Project 3.2-dev documentation</title>
    
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootswatch-3.3.4/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '3.2-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="The yt Project 3.2-dev documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" />
    
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-391373-2']);
      _gaq.push(['_setDomainName', 'yt-project.org']);
      _gaq.push(['_setAllowHash', false]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><img src="../../../_static/yt_icon.png">
          The yt Project</a>
        <span class="navbar-text navbar-version pull-left"><b>3.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../help/index.html">How to get help</a></li>
                <li><a href="../../../quickstart/index.html">Quickstart notebooks</a></li>
                <li><a href="../../../cookbook/index.html">Cookbook</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installing.html">Getting and Installing yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installing.html#getting-yt">Getting yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installing.html#testing-your-installation">Testing Your Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installing.html#switching-between-yt-2-x-and-yt-3-x">Switching between yt-2.x and yt-3.x</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/index.html">yt Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart/data_inspection.html">Data Inspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart/simple_visualization.html">Simple Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart/data_objects_and_time_series.html">Data Objects and Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart/derived_fields_and_profiles.html">Derived Fields and Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart/volume_rendering.html">Volume Rendering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../yt3differences.html">What&#8217;s New and Different in yt 3.0?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../yt3differences.html#updating-to-yt-3-0-from-old-versions-and-going-back">Updating to yt 3.0 from Old Versions (and going back)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../yt3differences.html#converting-old-scripts-to-work-with-yt-3-0">Converting Old Scripts to Work with yt 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../yt3differences.html#cool-new-things">Cool New Things</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../yt3differences.html#api-changes">API Changes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cookbook/index.html">The Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cookbook/index.html#getting-the-sample-data">Getting the Sample Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cookbook/index.html#example-scripts">Example Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cookbook/index.html#example-notebooks">Example Notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../visualizing/index.html">Visualizing Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../visualizing/plots.html">How to Make Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualizing/callbacks.html">Plot Modifications: Overplotting Contours, Velocities, Particles, and More</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualizing/manual_plotting.html">Using the Manual Plotting Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualizing/volume_rendering.html">Volume Rendering: Making 3D Photorealistic Isocontoured Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualizing/hardware_volume_rendering.html">Hardware Volume Rendering on NVidia Graphics cards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualizing/sketchfab.html">3D Surfaces and Sketchfab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualizing/mapserver.html">Mapserver - A Google-Maps-like Interface to your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualizing/streamlines.html">Streamlines: Tracking the Trajectories of Tracers in your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualizing/colormaps/index.html">Colormaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualizing/writing_fits_images.html">Writing FITS Images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../analyzing/index.html">General Data Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/fields.html">Fields in yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developing/creating_derived_fields.html">Creating Derived Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/objects.html">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/units/index.html">Symbolic Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/filtering.html">Filtering your Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/generating_processed_data.html">Generating Processed Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/time_series_analysis.html">Time Series Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/parallel_computation.html">Parallel Computation With yt</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../analyzing/analysis_modules/index.html">Topic-Specific Analysis Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/analysis_modules/halo_analysis.html">Halo Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/analysis_modules/synthetic_observation.html">Synthetic Observation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/analysis_modules/exporting.html">Exporting to External Radiation Transport Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/analysis_modules/two_point_functions.html">Two Point Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/analysis_modules/clump_finding.html">Clump Finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/analysis_modules/particle_trajectories.html">Particle Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analyzing/analysis_modules/ellipsoid_analysis.html">Halo Ellipsoid Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../examining/index.html">Loading and Examining Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examining/loading_data.html">Loading Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examining/generic_array_data.html">Loading Generic Array Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examining/generic_particle_data.html">Loading Generic Particle Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examining/spherical_data.html">Loading Spherical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examining/low_level_inspection.html">Low-Level Data Inspection: Accessing Raw Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../developing/index.html">Developing in yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../developing/intro.html">Getting Involved</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developing/developing.html">How to Develop yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developing/building_the_docs.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developing/testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developing/debugdrive.html">Debugging yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developing/creating_datatypes.html">Creating Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developing/creating_derived_fields.html">Creating Derived Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developing/creating_derived_quantities.html">Creating Derived Quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developing/creating_frontend.html">Creating A New Code Frontend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developing/external_analysis.html">Using yt with External Analysis Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">Reference Materials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/code_support.html">Code Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/command-line.html">Command-Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/api/api.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/configuration.html">Customizing yt: The Configuration and Plugin Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/field_list.html">Field List</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/changelog.html">ChangeLog</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../faq/index.html#version-installation">Version &amp; Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../faq/index.html#code-errors-and-failures">Code Errors and Failures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../faq/index.html#units">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../faq/index.html#fields">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../faq/index.html#data-objects">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../faq/index.html#developing">Developing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../faq/index.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../help/index.html">Getting Help</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../help/index.html#don-t-panic-and-don-t-give-up">Don&#8217;t panic and don&#8217;t give up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../help/index.html#update-to-the-latest-version">Update to the latest version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../help/index.html#search-the-documentation-faq-and-mailing-lists">Search the documentation, FAQ, and mailing lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../help/index.html#look-at-the-source-code">Look at the source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../help/index.html#isolate-and-document-your-problem">Isolate and document your problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../help/index.html#go-on-irc-to-ask-a-question">Go on IRC to ask a question</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../help/index.html#ask-the-mailing-list">Ask the mailing list</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../help/index.html#submit-a-bug-report">Submit a bug report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../help/index.html#special-issues">Special Issues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../about/index.html">About yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../about/index.html#what-is-yt">What is yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../about/index.html#who-is-yt">Who is yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../about/index.html#history-of-yt">History of yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../about/index.html#how-do-i-contact-yt">How do I contact yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../about/index.html#how-do-i-cite-yt">How do I cite yt?</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <h1>Source code for yt.visualization.profile_plotter</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This is a simple mechanism for interfacing with Profile and Phase plots</span>



<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>

<span class="c">#-----------------------------------------------------------------------------</span>
<span class="c"># Copyright (c) 2013, yt Development Team.</span>
<span class="c">#</span>
<span class="c"># Distributed under the terms of the Modified BSD License.</span>
<span class="c">#</span>
<span class="c"># The full license is in the file COPYING.txt, distributed with this software.</span>
<span class="c">#-----------------------------------------------------------------------------</span>

<span class="kn">from</span> <span class="nn">yt.extern.six.moves</span> <span class="kn">import</span> <span class="n">builtins</span>
<span class="kn">from</span> <span class="nn">yt.extern.six.moves</span> <span class="kn">import</span> <span class="nb">zip</span> <span class="k">as</span> <span class="n">izip</span>
<span class="kn">from</span> <span class="nn">yt.extern.six</span> <span class="kn">import</span> <span class="n">string_types</span><span class="p">,</span> <span class="n">iteritems</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>


<span class="kn">from</span> <span class="nn">.base_plot_types</span> <span class="kn">import</span> <span class="n">ImagePlotMPL</span>
<span class="kn">from</span> <span class="nn">yt.units.yt_array</span> <span class="kn">import</span> <span class="n">YTArray</span>
<span class="kn">from</span> <span class="nn">.plot_container</span> <span class="kn">import</span> \
    <span class="n">ImagePlotContainer</span><span class="p">,</span> \
    <span class="n">log_transform</span><span class="p">,</span> <span class="n">linear_transform</span><span class="p">,</span> <span class="n">get_log_minorticks</span><span class="p">,</span> \
    <span class="n">validate_plot</span><span class="p">,</span> <span class="n">invalidate_plot</span>
<span class="kn">from</span> <span class="nn">yt.data_objects.profiles</span> <span class="kn">import</span> \
    <span class="n">create_profile</span><span class="p">,</span> \
    <span class="n">sanitize_field_tuple_keys</span>
<span class="kn">from</span> <span class="nn">yt.utilities.exceptions</span> <span class="kn">import</span> \
    <span class="n">YTNotInsideNotebook</span>
<span class="kn">from</span> <span class="nn">yt.utilities.logger</span> <span class="kn">import</span> <span class="n">ytLogger</span> <span class="k">as</span> <span class="n">mylog</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_mpl_imports</span> <span class="k">as</span> <span class="n">mpl</span>
<span class="kn">from</span> <span class="nn">yt.funcs</span> <span class="kn">import</span> \
    <span class="n">ensure_list</span><span class="p">,</span> \
    <span class="n">iterable</span><span class="p">,</span> \
    <span class="n">get_image_suffix</span><span class="p">,</span> \
    <span class="n">get_ipython_api_version</span>

<span class="k">def</span> <span class="nf">get_canvas</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">suffix</span> <span class="o">=</span> <span class="n">get_image_suffix</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">suffix</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="s">&#39;.png&#39;</span>
    <span class="k">if</span> <span class="n">suffix</span> <span class="o">==</span> <span class="s">&quot;.png&quot;</span><span class="p">:</span>
        <span class="n">canvas_cls</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">FigureCanvasAgg</span>
    <span class="k">elif</span> <span class="n">suffix</span> <span class="o">==</span> <span class="s">&quot;.pdf&quot;</span><span class="p">:</span>
        <span class="n">canvas_cls</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">FigureCanvasPdf</span>
    <span class="k">elif</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;.eps&quot;</span><span class="p">,</span> <span class="s">&quot;.ps&quot;</span><span class="p">):</span>
        <span class="n">canvas_cls</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">FigureCanvasPS</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mylog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Unknown suffix </span><span class="si">%s</span><span class="s">, defaulting to Agg&quot;</span><span class="p">,</span> <span class="n">suffix</span><span class="p">)</span>
        <span class="n">canvas_cls</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">FigureCanvasAgg</span>
    <span class="k">return</span> <span class="n">canvas_cls</span>

<span class="k">class</span> <span class="nc">FigureContainer</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FigureContainer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">figure</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">figure</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">AxesContainer</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig_container</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_container</span> <span class="o">=</span> <span class="n">fig_container</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AxesContainer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">figure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_container</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AxesContainer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sanitize_label</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">nprofiles</span><span class="p">):</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">ensure_list</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">label</span> <span class="o">*</span> <span class="n">nprofiles</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">!=</span> <span class="n">nprofiles</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Number of labels must match number of profiles&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">label</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">l</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;All labels must be None or a string&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">label</span>

<div class="viewcode-block" id="ProfilePlot"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.ProfilePlot.html#yt.visualization.profile_plotter.ProfilePlot">[docs]</a><span class="k">class</span> <span class="nc">ProfilePlot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Create a 1d profile plot from a data source or from a list </span>
<span class="sd">    of profile objects.</span>

<span class="sd">    Given a data object (all_data, region, sphere, etc.), an x field, </span>
<span class="sd">    and a y field (or fields), this will create a one-dimensional profile </span>
<span class="sd">    of the average (or total) value of the y field in bins of the x field.</span>

<span class="sd">    This can be used to create profiles from given fields or to plot </span>
<span class="sd">    multiple profiles created from </span>
<span class="sd">    `yt.data_objects.profiles.create_profile`.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_source : YTSelectionContainer Object</span>
<span class="sd">        The data object to be profiled, such as all_data, region, or </span>
<span class="sd">        sphere.</span>
<span class="sd">    x_field : str</span>
<span class="sd">        The binning field for the profile.</span>
<span class="sd">    y_fields : str or list</span>
<span class="sd">        The field or fields to be profiled.</span>
<span class="sd">    weight_field : str</span>
<span class="sd">        The weight field for calculating weighted averages.  If None, </span>
<span class="sd">        the profile values are the sum of the field values within the bin.</span>
<span class="sd">        Otherwise, the values are a weighted average.</span>
<span class="sd">        Default : &quot;cell_mass&quot;.</span>
<span class="sd">    n_bins : int</span>
<span class="sd">        The number of bins in the profile.</span>
<span class="sd">        Default: 64.</span>
<span class="sd">    accumulation : bool</span>
<span class="sd">        If True, the profile values for a bin N are the cumulative sum of </span>
<span class="sd">        all the values from bin 0 to N.</span>
<span class="sd">        Default: False.</span>
<span class="sd">    fractional : If True the profile values are divided by the sum of all </span>
<span class="sd">        the profile data such that the profile represents a probability </span>
<span class="sd">        distribution function.</span>
<span class="sd">    label : str or list of strings</span>
<span class="sd">        If a string, the label to be put on the line plotted.  If a list, </span>
<span class="sd">        this should be a list of labels for each profile to be overplotted.</span>
<span class="sd">        Default: None.</span>
<span class="sd">    plot_spec : dict or list of dicts</span>
<span class="sd">        A dictionary or list of dictionaries containing plot keyword </span>
<span class="sd">        arguments.  For example, dict(color=&quot;red&quot;, linestyle=&quot;:&quot;).</span>
<span class="sd">        Default: None.</span>
<span class="sd">    x_log : bool</span>
<span class="sd">        If not None, whether the x_axis should be plotted with a logarithmic</span>
<span class="sd">        scaling.</span>
<span class="sd">        Default: None</span>
<span class="sd">    y_log : dict</span>
<span class="sd">        A dictionary containing field:boolean pairs, setting the logarithmic</span>
<span class="sd">        property for that field. May be overridden after instantiation using </span>
<span class="sd">        set_log.</span>
<span class="sd">        Default: None</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    This creates profiles of a single dataset.</span>

<span class="sd">    &gt;&gt;&gt; import yt</span>
<span class="sd">    &gt;&gt;&gt; ds = yt.load(&quot;enzo_tiny_cosmology/DD0046/DD0046&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ad = ds.all_data()</span>
<span class="sd">    &gt;&gt;&gt; plot = ProfilePlot(ad, &quot;density&quot;, [&quot;temperature&quot;, &quot;velocity_x&quot;],</span>
<span class="sd">    ...                    weight_field=&quot;cell_mass&quot;,</span>
<span class="sd">    ...                    plot_spec=dict(color=&#39;red&#39;, linestyle=&quot;--&quot;))</span>
<span class="sd">    &gt;&gt;&gt; plot.save()</span>

<span class="sd">    This creates profiles from a time series object.</span>

<span class="sd">    &gt;&gt;&gt; es = yt.simulation(&quot;AMRCosmology.enzo&quot;, &quot;Enzo&quot;)</span>
<span class="sd">    &gt;&gt;&gt; es.get_time_series()</span>

<span class="sd">    &gt;&gt;&gt; profiles = []</span>
<span class="sd">    &gt;&gt;&gt; labels = []</span>
<span class="sd">    &gt;&gt;&gt; plot_specs = []</span>
<span class="sd">    &gt;&gt;&gt; for ds in es[-4:]:</span>
<span class="sd">    ...     ad = ds.all_data()</span>
<span class="sd">    ...     profiles.append(create_profile(ad, [&quot;density&quot;],</span>
<span class="sd">    ...                                    fields=[&quot;temperature&quot;,</span>
<span class="sd">    ...                                            &quot;velocity_x&quot;]))</span>
<span class="sd">    ...     labels.append(ds.current_redshift)</span>
<span class="sd">    ...     plot_specs.append(dict(linestyle=&quot;--&quot;, alpha=0.7))</span>
<span class="sd">    &gt;&gt;&gt;</span>
<span class="sd">    &gt;&gt;&gt; plot = ProfilePlot.from_profiles(profiles, labels=labels,</span>
<span class="sd">    ...                                  plot_specs=plot_specs)</span>
<span class="sd">    &gt;&gt;&gt; plot.save()</span>

<span class="sd">    Use set_line_property to change line properties of one or all profiles.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x_log</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">y_log</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">x_title</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">y_title</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_plot_valid</span> <span class="o">=</span> <span class="bp">False</span>

<div class="viewcode-block" id="ProfilePlot.__init__"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.ProfilePlot.__init__.html#yt.visualization.profile_plotter.ProfilePlot.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_source</span><span class="p">,</span> <span class="n">x_field</span><span class="p">,</span> <span class="n">y_fields</span><span class="p">,</span>
                 <span class="n">weight_field</span><span class="o">=</span><span class="s">&quot;cell_mass&quot;</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
                 <span class="n">accumulation</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fractional</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">plot_spec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">x_log</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">y_log</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">x_log</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">logs</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logs</span> <span class="o">=</span> <span class="p">{</span><span class="n">x_field</span><span class="p">:</span><span class="n">x_log</span><span class="p">}</span>

        <span class="n">profiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">create_profile</span><span class="p">(</span><span class="n">data_source</span><span class="p">,</span> <span class="p">[</span><span class="n">x_field</span><span class="p">],</span>
                                   <span class="n">n_bins</span><span class="o">=</span><span class="p">[</span><span class="n">n_bins</span><span class="p">],</span>
                                   <span class="n">fields</span><span class="o">=</span><span class="n">ensure_list</span><span class="p">(</span><span class="n">y_fields</span><span class="p">),</span>
                                   <span class="n">weight_field</span><span class="o">=</span><span class="n">weight_field</span><span class="p">,</span>
                                   <span class="n">accumulation</span><span class="o">=</span><span class="n">accumulation</span><span class="p">,</span>
                                   <span class="n">fractional</span><span class="o">=</span><span class="n">fractional</span><span class="p">,</span>
                                   <span class="n">logs</span><span class="o">=</span><span class="n">logs</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">plot_spec</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">plot_spec</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plot_spec</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">plot_spec</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_spec</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">]</span>

        <span class="n">ProfilePlot</span><span class="o">.</span><span class="n">_initialize_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">profiles</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">plot_spec</span><span class="p">,</span> <span class="n">y_log</span><span class="p">)</span>
</div>
    <span class="nd">@validate_plot</span>
<div class="viewcode-block" id="ProfilePlot.save"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.ProfilePlot.save.html#yt.visualization.profile_plotter.ProfilePlot.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Saves a 1d profile plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The output file keyword.</span>
<span class="sd">        suffix : string</span>
<span class="sd">            Specify the image type by its suffix. If not specified, the output</span>
<span class="sd">            type will be inferred from the filename. Defaults to PNG.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_valid</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setup_plots</span><span class="p">()</span>
        <span class="n">unique</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figures</span><span class="p">):</span>
            <span class="n">iters</span> <span class="o">=</span> <span class="n">izip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique</span><span class="p">)),</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">unique</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">iters</span> <span class="o">=</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figures</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">suffix</span><span class="p">:</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="s">&quot;png&quot;</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="s">&quot;.</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">suffix</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ds</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="s">&quot;Multi-data&quot;</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sfx</span> <span class="o">=</span> <span class="n">get_image_suffix</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sfx</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
                <span class="n">suffix</span> <span class="o">=</span> <span class="n">sfx</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="n">name</span><span class="p">[:</span><span class="n">name</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">suffix</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">xfn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x_field</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xfn</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">xfn</span> <span class="o">=</span> <span class="n">xfn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">canvas_cls</span> <span class="o">=</span> <span class="n">get_canvas</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">fns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">uid</span><span class="p">,</span> <span class="n">fig</span> <span class="ow">in</span> <span class="n">iters</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">uid</span> <span class="o">=</span> <span class="n">uid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">canvas</span> <span class="o">=</span> <span class="n">canvas_cls</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="n">fns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">_1d-Profile_</span><span class="si">%s</span><span class="s">_</span><span class="si">%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">xfn</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">suffix</span><span class="p">))</span>
            <span class="n">mylog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Saving </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">fns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">canvas</span><span class="o">.</span><span class="n">print_figure</span><span class="p">(</span><span class="n">fns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">fns</span>
</div>
    <span class="nd">@validate_plot</span>
<div class="viewcode-block" id="ProfilePlot.show"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.ProfilePlot.show.html#yt.visualization.profile_plotter.ProfilePlot.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;This will send any existing plots to the IPython notebook.</span>

<span class="sd">        If yt is being run from within an IPython session, and it is able to</span>
<span class="sd">        determine this, this function will send any existing plots to the</span>
<span class="sd">        notebook for display.</span>

<span class="sd">        If yt can&#39;t determine if it&#39;s inside an IPython session, it will raise</span>
<span class="sd">        YTNotInsideNotebook.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import yt</span>
<span class="sd">        &gt;&gt;&gt; ds = yt.load(&#39;IsolatedGalaxy/galaxy0030/galaxy0030&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pp = ProfilePlot(ds.all_data(), &#39;density&#39;, &#39;temperature&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pp.show()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s">&quot;__IPYTHON__&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">builtins</span><span class="p">):</span>
            <span class="n">api_version</span> <span class="o">=</span> <span class="n">get_ipython_api_version</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">api_version</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;0.10&#39;</span><span class="p">,</span> <span class="s">&#39;0.11&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_zmq</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
                <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">YTNotInsideNotebook</span>
</div>
    <span class="nd">@validate_plot</span>
    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an html representation of the plot object. Will display as a</span>
<span class="sd">        png for each WindowPlotMPL instance in self.plots&quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="n">unique</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figures</span><span class="p">):</span>
            <span class="n">iters</span> <span class="o">=</span> <span class="n">izip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique</span><span class="p">)),</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">unique</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">iters</span> <span class="o">=</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figures</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">uid</span><span class="p">,</span> <span class="n">fig</span> <span class="ow">in</span> <span class="n">iters</span><span class="p">:</span>
            <span class="n">canvas</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">FigureCanvasAgg</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
            <span class="n">canvas</span><span class="o">.</span><span class="n">print_figure</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
            <span class="n">ret</span> <span class="o">+=</span> <span class="s">r&#39;&lt;img style=&quot;max-width:100</span><span class="si">%%</span><span class="s">;max-height:100</span><span class="si">%%</span><span class="s">;&quot; &#39;</span> \
                   <span class="s">r&#39;src=&quot;data:image/png;base64,{0}&quot;&gt;&lt;br&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">_setup_plots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_valid</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">profile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">field_data</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">field_data</span><span class="p">),</span>
                                      <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_spec</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="c"># This relies on &#39;profile&#39; leaking</span>
        <span class="k">for</span> <span class="n">fname</span><span class="p">,</span> <span class="n">axes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field_log</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">profile</span><span class="p">)</span>
            <span class="n">xtitle</span><span class="p">,</span> <span class="n">ytitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field_title</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">profile</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xtitle</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ytitle</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="n">fname</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">):</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&quot;best&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_valid</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_initialize_instance</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">profiles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">plot_specs</span><span class="p">,</span> <span class="n">y_log</span><span class="p">):</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="n">ensure_list</span><span class="p">(</span><span class="n">profiles</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">x_log</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">y_log</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">y_log</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">log</span> <span class="ow">in</span> <span class="n">y_log</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">field</span><span class="p">,</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">_determine_fields</span><span class="p">([</span><span class="n">field</span><span class="p">])</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">y_log</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">y_title</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">sanitize_label</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">profiles</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">plot_specs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">plot_specs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">profiles</span><span class="p">]</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">plot_spec</span> <span class="o">=</span> <span class="n">plot_specs</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">figures</span> <span class="o">=</span> <span class="n">FigureContainer</span><span class="p">()</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">AxesContainer</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">figures</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_setup_plots</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="ProfilePlot.from_profiles"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.ProfilePlot.from_profiles.html#yt.visualization.profile_plotter.ProfilePlot.from_profiles">[docs]</a>    <span class="k">def</span> <span class="nf">from_profiles</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">profiles</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">plot_specs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">y_log</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Instantiate a ProfilePlot object from a list of profiles</span>
<span class="sd">        created with :func:`~yt.data_objects.profiles.create_profile`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        profiles : a profile or list of profiles</span>
<span class="sd">            A single profile or list of profile objects created with</span>
<span class="sd">            :func:`~yt.data_objects.profiles.create_profile`.</span>
<span class="sd">        labels : list of strings</span>
<span class="sd">            A list of labels for each profile to be overplotted.</span>
<span class="sd">            Default: None.</span>
<span class="sd">        plot_specs : list of dicts</span>
<span class="sd">            A list of dictionaries containing plot keyword</span>
<span class="sd">            arguments.  For example, [dict(color=&quot;red&quot;, linestyle=&quot;:&quot;)].</span>
<span class="sd">            Default: None.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from yt import simulation</span>
<span class="sd">        &gt;&gt;&gt; es = simulation(&quot;AMRCosmology.enzo&quot;, &quot;Enzo&quot;)</span>
<span class="sd">        &gt;&gt;&gt; es.get_time_series()</span>

<span class="sd">        &gt;&gt;&gt; profiles = []</span>
<span class="sd">        &gt;&gt;&gt; labels = []</span>
<span class="sd">        &gt;&gt;&gt; plot_specs = []</span>
<span class="sd">        &gt;&gt;&gt; for ds in es[-4:]:</span>
<span class="sd">        ...     ad = ds.all_data()</span>
<span class="sd">        ...     profiles.append(create_profile(ad, [&quot;Density&quot;],</span>
<span class="sd">        ...                                    fields=[&quot;Temperature&quot;,</span>
<span class="sd">        ...                                            &quot;x-velocity&quot;]))</span>
<span class="sd">        ...     labels.append(ds.current_redshift)</span>
<span class="sd">        ...     plot_specs.append(dict(linestyle=&quot;--&quot;, alpha=0.7))</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; plot = ProfilePlot.from_profiles(profiles, labels=labels,</span>
<span class="sd">        ...                                  plot_specs=plot_specs)</span>
<span class="sd">        &gt;&gt;&gt; plot.save()</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">profiles</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Profiles list and labels list must be the same size.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plot_specs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_specs</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">profiles</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Profiles list and plot_specs list must be the same size.&quot;</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_initialize_instance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">profiles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">plot_specs</span><span class="p">,</span> <span class="n">y_log</span><span class="p">)</span>
</div>
    <span class="nd">@invalidate_plot</span>
<div class="viewcode-block" id="ProfilePlot.set_line_property"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.ProfilePlot.set_line_property.html#yt.visualization.profile_plotter.ProfilePlot.set_line_property">[docs]</a>    <span class="k">def</span> <span class="nf">set_line_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">property</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Set properties for one or all lines to be plotted.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        property : str</span>
<span class="sd">            The line property to be set.</span>
<span class="sd">        value : str, int, float</span>
<span class="sd">            The value to set for the line property.</span>
<span class="sd">        index : int</span>
<span class="sd">            The index of the profile in the list of profiles to be </span>
<span class="sd">            changed.  If None, change all plotted lines.</span>
<span class="sd">            Default : None.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        Change all the lines in a plot</span>
<span class="sd">        plot.set_line_property(&quot;linestyle&quot;, &quot;-&quot;)</span>

<span class="sd">        Change a single line.</span>
<span class="sd">        plot.set_line_property(&quot;linewidth&quot;, 4, index=0)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">specs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_spec</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">specs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_spec</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
            <span class="n">spec</span><span class="p">[</span><span class="nb">property</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="nd">@invalidate_plot</span>
<div class="viewcode-block" id="ProfilePlot.set_log"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.ProfilePlot.set_log.html#yt.visualization.profile_plotter.ProfilePlot.set_log">[docs]</a>    <span class="k">def</span> <span class="nf">set_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">log</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;set a field to log or linear.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field : string</span>
<span class="sd">            the field to set a transform</span>
<span class="sd">        log : boolean</span>
<span class="sd">            Log on/off.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="s">&quot;all&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_log</span> <span class="o">=</span> <span class="n">log</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">field_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y_log</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">field</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">_determine_fields</span><span class="p">([</span><span class="n">field</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x_field</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_log</span> <span class="o">=</span> <span class="n">log</span>
            <span class="k">elif</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">field_data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y_log</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s">&quot;Field </span><span class="si">%s</span><span class="s"> not in profile plot!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">field</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="nd">@invalidate_plot</span>
<div class="viewcode-block" id="ProfilePlot.set_unit"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.ProfilePlot.set_unit.html#yt.visualization.profile_plotter.ProfilePlot.set_unit">[docs]</a>    <span class="k">def</span> <span class="nf">set_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets a new unit for the requested field</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field : string</span>
<span class="sd">           The name of the field that is to be changed.</span>

<span class="sd">        new_unit : string or Unit object</span>
<span class="sd">           The name of the new unit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="n">profile</span><span class="o">.</span><span class="n">x_field</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">profile</span><span class="o">.</span><span class="n">set_x_unit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">field_map</span><span class="p">:</span>
                <span class="n">profile</span><span class="o">.</span><span class="n">set_field_unit</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s">&quot;Field </span><span class="si">%s</span><span class="s"> not in profile plot!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">field</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="nd">@invalidate_plot</span>
<div class="viewcode-block" id="ProfilePlot.set_xlim"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.ProfilePlot.set_xlim.html#yt.visualization.profile_plotter.ProfilePlot.set_xlim">[docs]</a>    <span class="k">def</span> <span class="nf">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the limits of the bin field</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        </span>
<span class="sd">        xmin : float or None</span>
<span class="sd">          The new x minimum.  Defaults to None, which leaves the xmin</span>
<span class="sd">          unchanged.</span>

<span class="sd">        xmax : float or None</span>
<span class="sd">          The new x maximum.  Defaults to None, which leaves the xmax</span>
<span class="sd">          unchanged.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import yt</span>
<span class="sd">        &gt;&gt;&gt; ds = yt.load(&#39;IsolatedGalaxy/galaxy0030/galaxy0030&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pp = yt.ProfilePlot(ds.all_data(), &#39;density&#39;, &#39;temperature&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pp.set_xlim(1e-29, 1e-24)</span>
<span class="sd">        &gt;&gt;&gt; pp.save()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">xmin</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">xmi</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">x_bins</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xmi</span> <span class="o">=</span> <span class="n">xmin</span>
            <span class="k">if</span> <span class="n">xmax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">xma</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">x_bins</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xma</span> <span class="o">=</span> <span class="n">xmax</span>
            <span class="n">extrema</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">x_field</span><span class="p">:</span> <span class="p">((</span><span class="n">xmi</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">units</span><span class="p">)),</span> <span class="p">(</span><span class="n">xma</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">units</span><span class="p">)))}</span>
            <span class="n">units</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">x_field</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">units</span><span class="p">)}</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">field_map</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">units</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">field_data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">create_profile</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data_source</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x_field</span><span class="p">,</span>
                               <span class="n">n_bins</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x_bins</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">fields</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">field_map</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
                               <span class="n">weight_field</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">weight_field</span><span class="p">,</span>
                               <span class="n">accumulation</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">accumulation</span><span class="p">,</span>
                               <span class="n">fractional</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">fractional</span><span class="p">,</span>
                               <span class="n">extrema</span><span class="o">=</span><span class="n">extrema</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="nd">@invalidate_plot</span>
<div class="viewcode-block" id="ProfilePlot.set_ylim"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.ProfilePlot.set_ylim.html#yt.visualization.profile_plotter.ProfilePlot.set_ylim">[docs]</a>    <span class="k">def</span> <span class="nf">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the plot limits for the specified field we are binning.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        field : string or field tuple</span>

<span class="sd">        The field that we want to adjust the plot limits for.</span>
<span class="sd">        </span>
<span class="sd">        ymin : float or None</span>
<span class="sd">          The new y minimum.  Defaults to None, which leaves the ymin</span>
<span class="sd">          unchanged.</span>

<span class="sd">        ymax : float or None</span>
<span class="sd">          The new y maximum.  Defaults to None, which leaves the ymax</span>
<span class="sd">          unchanged.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import yt</span>
<span class="sd">        &gt;&gt;&gt; ds = yt.load(&#39;IsolatedGalaxy/galaxy0030/galaxy0030&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pp = yt.ProfilePlot(ds.all_data(), &#39;density&#39;, [&#39;temperature&#39;, &#39;x-velocity&#39;])</span>
<span class="sd">        &gt;&gt;&gt; pp.set_ylim(&#39;temperature&#39;, 1e4, 1e6)</span>
<span class="sd">        &gt;&gt;&gt; pp.save()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="s">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">ensure_list</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">_determine_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">field_map</span><span class="p">:</span>
                    <span class="n">field</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">field_map</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
                <span class="c"># Continue on to the next profile.</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="k">def</span> <span class="nf">_get_field_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_y</span><span class="p">,</span> <span class="n">profile</span><span class="p">):</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">ds</span>
        <span class="n">yf</span><span class="p">,</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">_determine_fields</span><span class="p">([</span><span class="n">field_y</span><span class="p">])</span>
        <span class="n">yfi</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">_get_field_info</span><span class="p">(</span><span class="o">*</span><span class="n">yf</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_log</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">x_log</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">x_log</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_log</span>
        <span class="k">if</span> <span class="n">field_y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_log</span><span class="p">:</span>
            <span class="n">y_log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_log</span><span class="p">[</span><span class="n">field_y</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_log</span> <span class="o">=</span> <span class="n">yfi</span><span class="o">.</span><span class="n">take_log</span>
        <span class="n">scales</span> <span class="o">=</span> <span class="p">{</span><span class="bp">True</span><span class="p">:</span> <span class="s">&#39;log&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">:</span> <span class="s">&#39;linear&#39;</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">scales</span><span class="p">[</span><span class="n">x_log</span><span class="p">],</span> <span class="n">scales</span><span class="p">[</span><span class="n">y_log</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_field_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">field_info</span><span class="p">,</span> <span class="n">field_unit</span><span class="p">,</span> <span class="n">fractional</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="n">field_unit</span> <span class="o">=</span> <span class="n">field_unit</span><span class="o">.</span><span class="n">latex_representation</span><span class="p">()</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">field_info</span><span class="o">.</span><span class="n">display_name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span> <span class="n">field</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="s">r&#39;$\rm{&#39;</span><span class="o">+</span><span class="n">field</span><span class="o">+</span><span class="s">r&#39;}$&#39;</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="s">r&#39;$\rm{&#39;</span><span class="o">+</span><span class="n">field</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">,</span><span class="s">&#39;\ &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">+</span><span class="s">r&#39;}$&#39;</span>
        <span class="k">elif</span> <span class="n">field_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;$&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="n">field_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span><span class="s">&#39;\ &#39;</span><span class="p">)</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="s">r&#39;$\rm{&#39;</span><span class="o">+</span><span class="n">field_name</span><span class="o">+</span><span class="s">r&#39;}$&#39;</span>
        <span class="k">if</span> <span class="n">fractional</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">field_name</span> <span class="o">+</span> <span class="s">r&#39;$\rm{\ Probability\ Density}$&#39;</span>
        <span class="k">elif</span> <span class="n">field_unit</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">field_unit</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">field_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">field_name</span><span class="o">+</span><span class="s">r&#39;$\ \ (&#39;</span><span class="o">+</span><span class="n">field_unit</span><span class="o">+</span><span class="s">r&#39;)$&#39;</span>
        <span class="k">return</span> <span class="n">label</span>

    <span class="k">def</span> <span class="nf">_get_field_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_y</span><span class="p">,</span> <span class="n">profile</span><span class="p">):</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">ds</span>
        <span class="n">field_x</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">x_field</span>
        <span class="n">xf</span><span class="p">,</span> <span class="n">yf</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">_determine_fields</span><span class="p">(</span>
            <span class="p">[</span><span class="n">field_x</span><span class="p">,</span> <span class="n">field_y</span><span class="p">])</span>
        <span class="n">xfi</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">_get_field_info</span><span class="p">(</span><span class="o">*</span><span class="n">xf</span><span class="p">)</span>
        <span class="n">yfi</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">_get_field_info</span><span class="p">(</span><span class="o">*</span><span class="n">yf</span><span class="p">)</span>
        <span class="n">x_unit</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">units</span>
        <span class="n">y_unit</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">field_units</span><span class="p">[</span><span class="n">field_y</span><span class="p">]</span>
        <span class="n">fractional</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">fractional</span>
        <span class="n">x_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_title</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field_label</span><span class="p">(</span><span class="n">field_x</span><span class="p">,</span> <span class="n">xfi</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">)</span>
        <span class="n">y_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_title</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_y</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_field_label</span><span class="p">(</span><span class="n">field_y</span><span class="p">,</span> <span class="n">yfi</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">,</span> <span class="n">fractional</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">x_title</span><span class="p">,</span> <span class="n">y_title</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhasePlot"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.PhasePlot.html#yt.visualization.profile_plotter.PhasePlot">[docs]</a><span class="k">class</span> <span class="nc">PhasePlot</span><span class="p">(</span><span class="n">ImagePlotContainer</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Create a 2d profile (phase) plot from a data source or from </span>
<span class="sd">    profile object created with </span>
<span class="sd">    `yt.data_objects.profiles.create_profile`.</span>

<span class="sd">    Given a data object (all_data, region, sphere, etc.), an x field, </span>
<span class="sd">    y field, and z field (or fields), this will create a two-dimensional </span>
<span class="sd">    profile of the average (or total) value of the z field in bins of the </span>
<span class="sd">    x and y fields.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_source : YTSelectionContainer Object</span>
<span class="sd">        The data object to be profiled, such as all_data, region, or </span>
<span class="sd">        sphere.</span>
<span class="sd">    x_field : str</span>
<span class="sd">        The x binning field for the profile.</span>
<span class="sd">    y_field : str</span>
<span class="sd">        The y binning field for the profile.</span>
<span class="sd">    z_fields : str or list</span>
<span class="sd">        The field or fields to be profiled.</span>
<span class="sd">    weight_field : str</span>
<span class="sd">        The weight field for calculating weighted averages.  If None, </span>
<span class="sd">        the profile values are the sum of the field values within the bin.</span>
<span class="sd">        Otherwise, the values are a weighted average.</span>
<span class="sd">        Default : &quot;cell_mass&quot;.</span>
<span class="sd">    x_bins : int</span>
<span class="sd">        The number of bins in x field for the profile.</span>
<span class="sd">        Default: 128.</span>
<span class="sd">    y_bins : int</span>
<span class="sd">        The number of bins in y field for the profile.</span>
<span class="sd">        Default: 128.</span>
<span class="sd">    accumulation : bool or list of bools</span>
<span class="sd">        If True, the profile values for a bin n are the cumulative sum of </span>
<span class="sd">        all the values from bin 0 to n.  If -True, the sum is reversed so </span>
<span class="sd">        that the value for bin n is the cumulative sum from bin N (total bins) </span>
<span class="sd">        to n.  A list of values can be given to control the summation in each</span>
<span class="sd">        dimension independently.</span>
<span class="sd">        Default: False.</span>
<span class="sd">    fractional : If True the profile values are divided by the sum of all </span>
<span class="sd">        the profile data such that the profile represents a probability </span>
<span class="sd">        distribution function.</span>
<span class="sd">    profile : profile object</span>
<span class="sd">        If not None, a profile object created with </span>
<span class="sd">        `yt.data_objects.profiles.create_profile`.</span>
<span class="sd">        Default: None.</span>
<span class="sd">    fontsize: int</span>
<span class="sd">        Font size for all text in the plot.</span>
<span class="sd">        Default: 18.</span>
<span class="sd">    figure_size : int</span>
<span class="sd">        Size in inches of the image.</span>
<span class="sd">        Default: 8 (8x8)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import yt</span>
<span class="sd">    &gt;&gt;&gt; ds = yt.load(&quot;enzo_tiny_cosmology/DD0046/DD0046&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ad = ds.all_data()</span>
<span class="sd">    &gt;&gt;&gt; plot = PhasePlot(ad, &quot;density&quot;, &quot;temperature&quot;, [&quot;cell_mass&quot;],</span>
<span class="sd">    ...                  weight_field=None)</span>
<span class="sd">    &gt;&gt;&gt; plot.save()</span>

<span class="sd">    &gt;&gt;&gt; # Change plot properties.</span>
<span class="sd">    &gt;&gt;&gt; plot.set_cmap(&quot;cell_mass&quot;, &quot;jet&quot;)</span>
<span class="sd">    &gt;&gt;&gt; plot.set_zlim(&quot;cell_mass&quot;, 1e8, 1e13)</span>
<span class="sd">    &gt;&gt;&gt; plot.set_title(&quot;cell_mass&quot;, &quot;This is a phase plot&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x_log</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">y_log</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">plot_title</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_plot_valid</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">_plot_type</span> <span class="o">=</span> <span class="s">&#39;Phase&#39;</span>

<div class="viewcode-block" id="PhasePlot.__init__"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.PhasePlot.__init__.html#yt.visualization.profile_plotter.PhasePlot.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_source</span><span class="p">,</span> <span class="n">x_field</span><span class="p">,</span> <span class="n">y_field</span><span class="p">,</span> <span class="n">z_fields</span><span class="p">,</span>
                 <span class="n">weight_field</span><span class="o">=</span><span class="s">&quot;cell_mass&quot;</span><span class="p">,</span> <span class="n">x_bins</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">y_bins</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
                 <span class="n">accumulation</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fractional</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="mf">8.0</span><span class="p">):</span>

        <span class="n">profile</span> <span class="o">=</span> <span class="n">create_profile</span><span class="p">(</span>
            <span class="n">data_source</span><span class="p">,</span>
            <span class="p">[</span><span class="n">x_field</span><span class="p">,</span> <span class="n">y_field</span><span class="p">],</span>
            <span class="n">ensure_list</span><span class="p">(</span><span class="n">z_fields</span><span class="p">),</span>
            <span class="n">n_bins</span><span class="o">=</span><span class="p">[</span><span class="n">x_bins</span><span class="p">,</span> <span class="n">y_bins</span><span class="p">],</span>
            <span class="n">weight_field</span><span class="o">=</span><span class="n">weight_field</span><span class="p">,</span>
            <span class="n">accumulation</span><span class="o">=</span><span class="n">accumulation</span><span class="p">,</span>
            <span class="n">fractional</span><span class="o">=</span><span class="n">fractional</span><span class="p">)</span>

        <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_initialize_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_source</span><span class="p">,</span> <span class="n">profile</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span>
                                        <span class="n">figure_size</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_initialize_instance</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">data_source</span><span class="p">,</span> <span class="n">profile</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span>
                             <span class="n">figure_size</span><span class="p">):</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">plot_title</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">z_log</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">z_title</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_initfinished</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">x_log</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">y_log</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_plot_text</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_text_xpos</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_text_ypos</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_text_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">profile</span> <span class="o">=</span> <span class="n">profile</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PhasePlot</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">data_source</span><span class="p">,</span> <span class="n">figure_size</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_setup_plots</span><span class="p">()</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_initfinished</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">_get_field_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_z</span><span class="p">,</span> <span class="n">profile</span><span class="p">):</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">ds</span>
        <span class="n">field_x</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">x_field</span>
        <span class="n">field_y</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">y_field</span>
        <span class="n">xf</span><span class="p">,</span> <span class="n">yf</span><span class="p">,</span> <span class="n">zf</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">_determine_fields</span><span class="p">(</span>
            <span class="p">[</span><span class="n">field_x</span><span class="p">,</span> <span class="n">field_y</span><span class="p">,</span> <span class="n">field_z</span><span class="p">])</span>
        <span class="n">xfi</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">_get_field_info</span><span class="p">(</span><span class="o">*</span><span class="n">xf</span><span class="p">)</span>
        <span class="n">yfi</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">_get_field_info</span><span class="p">(</span><span class="o">*</span><span class="n">yf</span><span class="p">)</span>
        <span class="n">zfi</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">_get_field_info</span><span class="p">(</span><span class="o">*</span><span class="n">zf</span><span class="p">)</span>
        <span class="n">x_unit</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">units</span>
        <span class="n">y_unit</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">units</span>
        <span class="n">z_unit</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">field_units</span><span class="p">[</span><span class="n">field_z</span><span class="p">]</span>
        <span class="n">fractional</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">fractional</span>
        <span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">z_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_axes_labels</span><span class="p">(</span><span class="n">field_z</span><span class="p">)</span>
        <span class="n">x_title</span> <span class="o">=</span> <span class="n">x_label</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field_label</span><span class="p">(</span><span class="n">field_x</span><span class="p">,</span> <span class="n">xfi</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">)</span>
        <span class="n">y_title</span> <span class="o">=</span> <span class="n">y_label</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field_label</span><span class="p">(</span><span class="n">field_y</span><span class="p">,</span> <span class="n">yfi</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">)</span>
        <span class="n">z_title</span> <span class="o">=</span> <span class="n">z_label</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field_label</span><span class="p">(</span><span class="n">field_z</span><span class="p">,</span> <span class="n">zfi</span><span class="p">,</span> <span class="n">z_unit</span><span class="p">,</span>
                                                   <span class="n">fractional</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x_title</span><span class="p">,</span> <span class="n">y_title</span><span class="p">,</span> <span class="n">z_title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_field_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">field_info</span><span class="p">,</span> <span class="n">field_unit</span><span class="p">,</span> <span class="n">fractional</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="n">field_unit</span> <span class="o">=</span> <span class="n">field_unit</span><span class="o">.</span><span class="n">latex_representation</span><span class="p">()</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">field_info</span><span class="o">.</span><span class="n">display_name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span> <span class="n">field</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="s">r&#39;$\rm{&#39;</span><span class="o">+</span><span class="n">field</span><span class="o">+</span><span class="s">r&#39;}$&#39;</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="s">r&#39;$\rm{&#39;</span><span class="o">+</span><span class="n">field</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">,</span><span class="s">&#39;\ &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">+</span><span class="s">r&#39;}$&#39;</span>
        <span class="k">elif</span> <span class="n">field_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;$&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="n">field_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span><span class="s">&#39;\ &#39;</span><span class="p">)</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="s">r&#39;$\rm{&#39;</span><span class="o">+</span><span class="n">field_name</span><span class="o">+</span><span class="s">r&#39;}$&#39;</span>
        <span class="k">if</span> <span class="n">fractional</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">field_name</span> <span class="o">+</span> <span class="s">r&#39;$\rm{\ Probability\ Density}$&#39;</span>
        <span class="k">elif</span> <span class="n">field_unit</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">field_unit</span> <span class="ow">is</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">field_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">field_name</span><span class="o">+</span><span class="s">r&#39;$\ \ (&#39;</span><span class="o">+</span><span class="n">field_unit</span><span class="o">+</span><span class="s">r&#39;)$&#39;</span>
        <span class="k">return</span> <span class="n">label</span>

    <span class="k">def</span> <span class="nf">_get_field_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_z</span><span class="p">,</span> <span class="n">profile</span><span class="p">):</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">ds</span>
        <span class="n">zf</span><span class="p">,</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">_determine_fields</span><span class="p">([</span><span class="n">field_z</span><span class="p">])</span>
        <span class="n">zfi</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">_get_field_info</span><span class="p">(</span><span class="o">*</span><span class="n">zf</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_log</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">x_log</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">x_log</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_log</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_log</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">y_log</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">y_log</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_log</span>
        <span class="k">if</span> <span class="n">field_z</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_log</span><span class="p">:</span>
            <span class="n">z_log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_log</span><span class="p">[</span><span class="n">field_z</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">z_log</span> <span class="o">=</span> <span class="n">zfi</span><span class="o">.</span><span class="n">take_log</span>
        <span class="n">scales</span> <span class="o">=</span> <span class="p">{</span><span class="bp">True</span><span class="p">:</span> <span class="s">&#39;log&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">:</span> <span class="s">&#39;linear&#39;</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">scales</span><span class="p">[</span><span class="n">x_log</span><span class="p">],</span> <span class="n">scales</span><span class="p">[</span><span class="n">y_log</span><span class="p">],</span> <span class="n">scales</span><span class="p">[</span><span class="n">z_log</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_setup_plots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_valid</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">cax</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">draw_colorbar</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">draw_axes</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">zlim</span> <span class="o">=</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">:</span>
                <span class="n">draw_colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">_draw_colorbar</span>
                <span class="n">draw_axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">_draw_axes</span>
                <span class="n">zlim</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">zmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">zmax</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">figure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">figure</span>
                    <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span>
                    <span class="n">cax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">cax</span>

            <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span><span class="p">,</span> <span class="n">z_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field_log</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="p">)</span>
            <span class="n">x_title</span><span class="p">,</span> <span class="n">y_title</span><span class="p">,</span> <span class="n">z_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_field_title</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">zlim</span> <span class="o">==</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">z_scale</span> <span class="o">==</span> <span class="s">&#39;log&#39;</span><span class="p">:</span>
                    <span class="n">positive_values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">positive_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">mylog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Profiled field </span><span class="si">%s</span><span class="s"> has no positive &quot;</span>
                                      <span class="s">&quot;values.  Max = </span><span class="si">%f</span><span class="s">.&quot;</span> <span class="o">%</span>
                                      <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
                        <span class="n">mylog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Switching to linear colorbar scaling.&quot;</span><span class="p">)</span>
                        <span class="n">zmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                        <span class="n">z_scale</span> <span class="o">=</span> <span class="s">&#39;linear&#39;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_field_transform</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_transform</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">zmin</span> <span class="o">=</span> <span class="n">positive_values</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_field_transform</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_transform</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">zmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_field_transform</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_transform</span>
                <span class="n">zlim</span> <span class="o">=</span> <span class="p">[</span><span class="n">zmin</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">data</span><span class="p">)]</span>

            <span class="n">font_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_font_properties</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
            <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">_determine_fields</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c"># if this is a Particle Phase Plot AND if we using a single color,</span>
            <span class="c"># override the colorbar here.</span>
            <span class="n">splat_color</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;splat_color&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">splat_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">splat_color</span><span class="p">,</span> <span class="s">&#39;dummy&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_colormaps</span><span class="p">[</span><span class="n">f</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">PhasePlotMPL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
                                         <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span><span class="p">,</span> <span class="n">z_scale</span><span class="p">,</span>
                                         <span class="n">cmap</span><span class="p">,</span> <span class="n">zlim</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">font_size</span><span class="p">,</span>
                                         <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">cax</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">_toggle_axes</span><span class="p">(</span><span class="n">draw_axes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">_toggle_colorbar</span><span class="p">(</span><span class="n">draw_colorbar</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_text</span><span class="p">(</span><span class="n">x_title</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_text</span><span class="p">(</span><span class="n">y_title</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">cax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_text</span><span class="p">(</span><span class="n">z_title</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_text</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_xpos</span><span class="p">[</span><span class="n">f</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_ypos</span><span class="p">[</span><span class="n">f</span><span class="p">],</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_text</span><span class="p">[</span><span class="n">f</span><span class="p">],</span>
                                        <span class="n">fontproperties</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_font_properties</span><span class="p">,</span>
                                        <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_kwargs</span><span class="p">[</span><span class="n">f</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_title</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_title</span><span class="p">[</span><span class="n">f</span><span class="p">])</span>

            <span class="c"># x-y axes minorticks</span>
            <span class="k">if</span> <span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minorticks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_minorticks</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minorticks</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>

            <span class="c"># colorbar minorticks</span>
            <span class="k">if</span> <span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbar_minorticks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cbar_minorticks</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbar_minorticks</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_field_transform</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">==</span> <span class="n">linear_transform</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">cax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">cb</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">vmin</span> <span class="p">)</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">cb</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">vmax</span> <span class="p">)</span>
                    <span class="n">mticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span> <span class="n">get_log_minorticks</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span> <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">cax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">mticks</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">cax</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_font_properties</span><span class="p">()</span>

        <span class="c"># if this is a particle plot with one color only, hide the cbar here</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;use_cbar&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_cbar</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">hide_colorbar</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_valid</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="PhasePlot.from_profile"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.PhasePlot.from_profile.html#yt.visualization.profile_plotter.PhasePlot.from_profile">[docs]</a>    <span class="k">def</span> <span class="nf">from_profile</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">profile</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="mf">8.0</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Instantiate a PhasePlot object from a profile object created</span>
<span class="sd">        with :func:`~yt.data_objects.profiles.create_profile`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        profile : An instance of :class:`~yt.data_objects.profiles.ProfileND`</span>
<span class="sd">             A single profile object.</span>
<span class="sd">        fontsize : float</span>
<span class="sd">             The fontsize to use, in points.</span>
<span class="sd">        figure_size : float</span>
<span class="sd">             The figure size to use, in inches.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import yt</span>
<span class="sd">        &gt;&gt;&gt; ds = yt.load(&#39;IsolatedGalaxy/galaxy0030/galaxy0030&#39;)</span>
<span class="sd">        &gt;&gt;&gt; extrema = {</span>
<span class="sd">        ... &#39;density&#39;: (1e-31, 1e-24),</span>
<span class="sd">        ... &#39;temperature&#39;: (1e1, 1e8),</span>
<span class="sd">        ... &#39;cell_mass&#39;: (1e-6, 1e-1),</span>
<span class="sd">        ... }</span>
<span class="sd">        &gt;&gt;&gt; profile = yt.create_profile(ds.all_data(), [&#39;density&#39;, &#39;temperature&#39;],</span>
<span class="sd">        ...                             fields=[&#39;cell_mass&#39;],extrema=extrema,</span>
<span class="sd">        ...                             fractional=True)</span>
<span class="sd">        &gt;&gt;&gt; ph = yt.PhasePlot.from_profile(profile)</span>
<span class="sd">        &gt;&gt;&gt; ph.save()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>
        <span class="n">data_source</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">data_source</span>
        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_initialize_instance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">data_source</span><span class="p">,</span> <span class="n">profile</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span>
                                        <span class="n">figure_size</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">annotate_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">text_kwargs</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Allow the user to insert text onto the plot</span>
<span class="sd">        The x-position and y-position must be given as well as the text string. </span>
<span class="sd">        Add *text* tp plot at location *xpos*, *ypos* in plot coordinates</span>
<span class="sd">        (see example below).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field: str or tuple</span>
<span class="sd">          The name of the field to add text to. </span>
<span class="sd">        xpos: float</span>
<span class="sd">          Position on plot in x-coordinates.</span>
<span class="sd">        ypos: float</span>
<span class="sd">          Position on plot in y-coordinates.</span>
<span class="sd">        text: str</span>
<span class="sd">          The text to insert onto the plot.</span>
<span class="sd">        text_kwargs: dict</span>
<span class="sd">          Dictionary of text keyword arguments to be passed to matplotlib</span>

<span class="sd">        &gt;&gt;&gt;  plot.annotate_text(1e-15, 5e4, &quot;Hello YT&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">_determine_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">figure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span>
                                        <span class="n">fontproperties</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_font_properties</span><span class="p">,</span>
                                        <span class="o">**</span><span class="n">text_kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_text</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text_xpos</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">xpos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text_ypos</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">ypos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text_kwargs</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">text_kwargs</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@validate_plot</span>
<div class="viewcode-block" id="PhasePlot.save"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.PhasePlot.save.html#yt.visualization.profile_plotter.PhasePlot.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mpl_kwargs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">        Saves a 2d profile plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The output file keyword.</span>
<span class="sd">        suffix : string</span>
<span class="sd">           Specify the image type by its suffix. If not specified, the output</span>
<span class="sd">           type will be inferred from the filename. Defaults to PNG.</span>
<span class="sd">        mpl_kwargs : dict</span>
<span class="sd">           A dict of keyword arguments to be passed to matplotlib.</span>

<span class="sd">        &gt;&gt;&gt; plot.save(mpl_kwargs={&#39;bbox_inches&#39;:&#39;tight&#39;})</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_valid</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setup_plots</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">mpl_kwargs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">mpl_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">ds</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">xfn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">x_field</span>
        <span class="n">yfn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">y_field</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xfn</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">xfn</span> <span class="o">=</span> <span class="n">xfn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">yfn</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">yfn</span> <span class="o">=</span> <span class="n">yfn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">field_data</span><span class="p">:</span>
            <span class="n">_f</span> <span class="o">=</span> <span class="n">f</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">_f</span> <span class="o">=</span> <span class="n">_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">middle</span> <span class="o">=</span> <span class="s">&quot;2d-Profile_</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xfn</span><span class="p">,</span> <span class="n">yfn</span><span class="p">,</span> <span class="n">_f</span><span class="p">)</span>
            <span class="n">splitname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">splitname</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">splitname</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">splitname</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">ds</span><span class="p">):</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="k">else</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
                <span class="n">prefix</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">ds</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="n">name</span>
            <span class="k">if</span> <span class="n">suffix</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">suffix</span> <span class="o">=</span> <span class="n">get_image_suffix</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">suffix</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">):</span>
                        <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mpl_kwargs</span><span class="p">))</span>
                    <span class="k">return</span> <span class="n">names</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">suffix</span> <span class="o">=</span> <span class="s">&quot;png&quot;</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">middle</span><span class="p">,</span> <span class="n">suffix</span><span class="p">)</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">mpl_kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">names</span>
</div>
    <span class="nd">@invalidate_plot</span>
<div class="viewcode-block" id="PhasePlot.set_title"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.PhasePlot.set_title.html#yt.visualization.profile_plotter.PhasePlot.set_title">[docs]</a>    <span class="k">def</span> <span class="nf">set_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a title for the plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field : str</span>
<span class="sd">            The z field of the plot to add the title.</span>
<span class="sd">        title : str</span>
<span class="sd">            The title to add.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; plot.set_title(&quot;cell_mass&quot;, &quot;This is a phase plot&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_title</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">_determine_fields</span><span class="p">(</span><span class="n">field</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="nd">@invalidate_plot</span>
<div class="viewcode-block" id="PhasePlot.reset_plot"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.PhasePlot.reset_plot.html#yt.visualization.profile_plotter.PhasePlot.reset_plot">[docs]</a>    <span class="k">def</span> <span class="nf">reset_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plots</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="nd">@invalidate_plot</span>
<div class="viewcode-block" id="PhasePlot.set_log"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.PhasePlot.set_log.html#yt.visualization.profile_plotter.PhasePlot.set_log">[docs]</a>    <span class="k">def</span> <span class="nf">set_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">log</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;set a field to log or linear.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field : string</span>
<span class="sd">            the field to set a transform</span>
<span class="sd">        log : boolean</span>
<span class="sd">            Log on/off.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="s">&quot;all&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_log</span> <span class="o">=</span> <span class="n">log</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_log</span> <span class="o">=</span> <span class="n">log</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">field_data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">z_log</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">x_field</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_log</span> <span class="o">=</span> <span class="n">log</span>
            <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">y_field</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y_log</span> <span class="o">=</span> <span class="n">log</span>
            <span class="k">elif</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">field_map</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">z_log</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">field_map</span><span class="p">[</span><span class="n">field</span><span class="p">]]</span> <span class="o">=</span> <span class="n">log</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s">&quot;Field </span><span class="si">%s</span><span class="s"> not in phase plot!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">field</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="nd">@invalidate_plot</span>
<div class="viewcode-block" id="PhasePlot.set_unit"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.PhasePlot.set_unit.html#yt.visualization.profile_plotter.PhasePlot.set_unit">[docs]</a>    <span class="k">def</span> <span class="nf">set_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets a new unit for the requested field</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field : string</span>
<span class="sd">           The name of the field that is to be changed.</span>

<span class="sd">        new_unit : string or Unit object</span>
<span class="sd">           The name of the new unit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">fd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">fd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">field_data</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">x_field</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">set_x_unit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">y_field</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">set_y_unit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">set_field_unit</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">zmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">zmax</span> <span class="o">=</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s">&quot;Field </span><span class="si">%s</span><span class="s"> not in phase plot!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">field</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="nd">@invalidate_plot</span>
<div class="viewcode-block" id="PhasePlot.set_xlim"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.PhasePlot.set_xlim.html#yt.visualization.profile_plotter.PhasePlot.set_xlim">[docs]</a>    <span class="k">def</span> <span class="nf">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the limits of the x bin field</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        xmin : float or None</span>
<span class="sd">          The new x minimum.  Defaults to None, which leaves the xmin</span>
<span class="sd">          unchanged.</span>

<span class="sd">        xmax : float or None</span>
<span class="sd">          The new x maximum.  Defaults to None, which leaves the xmax</span>
<span class="sd">          unchanged.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import yt</span>
<span class="sd">        &gt;&gt;&gt; ds = yt.load(&#39;IsolatedGalaxy/galaxy0030/galaxy0030&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pp = yt.PhasePlot(ds.all_data(), &#39;density&#39;, &#39;temperature&#39;, &#39;cell_mass&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pp.set_xlim(1e-29, 1e-24)</span>
<span class="sd">        &gt;&gt;&gt; pp.save()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span>
        <span class="k">if</span> <span class="n">xmin</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">x_bins</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">xmax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">x_bins</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">units</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">x_field</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">units</span><span class="p">),</span>
                 <span class="n">p</span><span class="o">.</span><span class="n">y_field</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">units</span><span class="p">)}</span>
        <span class="n">zunits</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">field</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">field_units</span><span class="p">[</span><span class="n">field</span><span class="p">]))</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">field_units</span><span class="p">)</span>
        <span class="n">extrema</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">x_field</span><span class="p">:</span> <span class="p">((</span><span class="n">xmin</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">units</span><span class="p">)),</span> <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">units</span><span class="p">))),</span>
                   <span class="n">p</span><span class="o">.</span><span class="n">y_field</span><span class="p">:</span> <span class="p">((</span><span class="n">p</span><span class="o">.</span><span class="n">y_bins</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">units</span><span class="p">)),</span>
                               <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y_bins</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">units</span><span class="p">)))}</span>
        <span class="n">deposition</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="s">&quot;deposition&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deposition</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">additional_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;accumulation&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">accumulation</span><span class="p">,</span>
                                 <span class="s">&#39;fractional&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">fractional</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">additional_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;deposition&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">deposition</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profile</span> <span class="o">=</span> <span class="n">create_profile</span><span class="p">(</span>
            <span class="n">p</span><span class="o">.</span><span class="n">data_source</span><span class="p">,</span>
            <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">x_field</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y_field</span><span class="p">],</span>
            <span class="n">p</span><span class="o">.</span><span class="n">field_map</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
            <span class="n">n_bins</span><span class="o">=</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x_bins</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y_bins</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">weight_field</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">weight_field</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
            <span class="n">extrema</span><span class="o">=</span><span class="n">extrema</span><span class="p">,</span>
            <span class="o">**</span><span class="n">additional_kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">zunits</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">set_field_unit</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">zunits</span><span class="p">[</span><span class="n">field</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="nd">@invalidate_plot</span>
<div class="viewcode-block" id="PhasePlot.set_ylim"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.PhasePlot.set_ylim.html#yt.visualization.profile_plotter.PhasePlot.set_ylim">[docs]</a>    <span class="k">def</span> <span class="nf">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the plot limits for the y bin field.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        ymin : float or None</span>
<span class="sd">          The new y minimum.  Defaults to None, which leaves the ymin</span>
<span class="sd">          unchanged.</span>

<span class="sd">        ymax : float or None</span>
<span class="sd">          The new y maximum.  Defaults to None, which leaves the ymax</span>
<span class="sd">          unchanged.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import yt</span>
<span class="sd">        &gt;&gt;&gt; ds = yt.load(&#39;IsolatedGalaxy/galaxy0030/galaxy0030&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pp = yt.PhasePlot(ds.all_data(), &#39;density&#39;, &#39;temperature&#39;, &#39;cell_mass&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pp.set_ylim(1e4, 1e6)</span>
<span class="sd">        &gt;&gt;&gt; pp.save()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span>
        <span class="k">if</span> <span class="n">ymin</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">y_bins</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ymax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">y_bins</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">units</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">x_field</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">units</span><span class="p">),</span>
                 <span class="n">p</span><span class="o">.</span><span class="n">y_field</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">units</span><span class="p">)}</span>
        <span class="n">zunits</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">field</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">field_units</span><span class="p">[</span><span class="n">field</span><span class="p">]))</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">field_units</span><span class="p">)</span>
        <span class="n">extrema</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">x_field</span><span class="p">:</span> <span class="p">((</span><span class="n">p</span><span class="o">.</span><span class="n">x_bins</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">units</span><span class="p">)),</span>
                               <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x_bins</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">units</span><span class="p">))),</span>
                   <span class="n">p</span><span class="o">.</span><span class="n">y_field</span><span class="p">:</span> <span class="p">((</span><span class="n">ymin</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">units</span><span class="p">)),</span> <span class="p">(</span><span class="n">ymax</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">units</span><span class="p">)))}</span>
        <span class="n">deposition</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="s">&quot;deposition&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deposition</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">additional_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;accumulation&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">accumulation</span><span class="p">,</span>
                                 <span class="s">&#39;fractional&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">fractional</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">additional_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;deposition&#39;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">deposition</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profile</span> <span class="o">=</span> <span class="n">create_profile</span><span class="p">(</span>
            <span class="n">p</span><span class="o">.</span><span class="n">data_source</span><span class="p">,</span>
            <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">x_field</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y_field</span><span class="p">],</span>
            <span class="n">p</span><span class="o">.</span><span class="n">field_map</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
            <span class="n">n_bins</span><span class="o">=</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x_bins</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y_bins</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">weight_field</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">weight_field</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
            <span class="n">extrema</span><span class="o">=</span><span class="n">extrema</span><span class="p">,</span>
            <span class="o">**</span><span class="n">additional_kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">zunits</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">set_field_unit</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">zunits</span><span class="p">[</span><span class="n">field</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span>

</div></div>
<div class="viewcode-block" id="PhasePlotMPL"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.PhasePlotMPL.html#yt.visualization.profile_plotter.PhasePlotMPL">[docs]</a><span class="k">class</span> <span class="nc">PhasePlotMPL</span><span class="p">(</span><span class="n">ImagePlotMPL</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A container for a single matplotlib figure and axes for a PhasePlot&quot;&quot;&quot;</span>
<div class="viewcode-block" id="PhasePlotMPL.__init__"><a class="viewcode-back" href="../../../reference/api/generated/yt.visualization.profile_plotter.PhasePlotMPL.__init__.html#yt.visualization.profile_plotter.PhasePlotMPL.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
                 <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span><span class="p">,</span> <span class="n">z_scale</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span>
                 <span class="n">zlim</span><span class="p">,</span> <span class="n">figure_size</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">cax</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initfinished</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_colorbar</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_axes</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figure_size</span> <span class="o">=</span> <span class="n">figure_size</span>

        <span class="c"># Compute layout</span>
        <span class="n">fontscale</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span> <span class="o">/</span> <span class="mf">18.0</span>
        <span class="k">if</span> <span class="n">fontscale</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">fontscale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fontscale</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_size</span> <span class="o">=</span> <span class="mf">0.0375</span><span class="o">*</span><span class="n">figure_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ax_text_size</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="o">*</span><span class="n">fontscale</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">fontscale</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_top_buff_size</span> <span class="o">=</span> <span class="mf">0.30</span><span class="o">*</span><span class="n">fontscale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_aspect</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="n">size</span><span class="p">,</span> <span class="n">axrect</span><span class="p">,</span> <span class="n">caxrect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_best_layout</span><span class="p">()</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">PhasePlotMPL</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">axrect</span><span class="p">,</span> <span class="n">caxrect</span><span class="p">,</span> <span class="n">zlim</span><span class="p">,</span>
                                           <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">cax</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_init_image</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span><span class="p">,</span> <span class="n">z_scale</span><span class="p">,</span>
                         <span class="n">zlim</span><span class="p">,</span> <span class="n">cmap</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_initfinished</span> <span class="o">=</span> <span class="bp">True</span>
</div>
    <span class="k">def</span> <span class="nf">_init_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">image_data</span><span class="p">,</span>
                    <span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span><span class="p">,</span> <span class="n">z_scale</span><span class="p">,</span> <span class="n">zlim</span><span class="p">,</span> <span class="n">cmap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Store output of imshow in image variable&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">z_scale</span> <span class="o">==</span> <span class="s">&#39;log&#39;</span><span class="p">):</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">z_scale</span> <span class="o">==</span> <span class="s">&#39;linear&#39;</span><span class="p">):</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cb</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_data</span><span class="p">),</span>
                                          <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_data</span><span class="p">),</span>
                                          <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image_data</span><span class="o">.</span><span class="n">T</span><span class="p">),</span>
                                          <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                                          <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">x_scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">y_scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">z_scale</span> <span class="o">==</span> <span class="s">&#39;linear&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cb</span><span class="o">.</span><span class="n">formatter</span><span class="o">.</span><span class="n">set_scientific</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cb</span><span class="o">.</span><span class="n">formatter</span><span class="o">.</span><span class="n">set_powerlimits</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cb</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span></div>
</pre></div>

    </div>
      
  </div>
</div>
    <div class="footer">
      &copy; Copyright 2013, the yt Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>