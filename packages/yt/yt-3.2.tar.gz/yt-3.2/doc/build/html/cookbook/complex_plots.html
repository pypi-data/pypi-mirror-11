<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>A Few Complex Plots &mdash; The yt Project 3.2-dev documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.4/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.2-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="The yt Project 3.2-dev documentation" href="../index.html" />
    <link rel="up" title="The Cookbook" href="index.html" />
    <link rel="next" title="Cosmological Analysis" href="cosmological_analysis.html" />
    <link rel="prev" title="Calculating Dataset Information" href="calculating_information.html" />
    
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-391373-2']);
      _gaq.push(['_setDomainName', 'yt-project.org']);
      _gaq.push(['_setAllowHash', false]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/yt_icon.png">
          The yt Project</a>
        <span class="navbar-text navbar-version pull-left"><b>3.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../help/index.html">How to get help</a></li>
                <li><a href="../quickstart/index.html">Quickstart notebooks</a></li>
                <li><a href="index.html">Cookbook</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Getting and Installing yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installing.html#getting-yt">Getting yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing.html#testing-your-installation">Testing Your Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing.html#switching-between-yt-2-x-and-yt-3-x">Switching between yt-2.x and yt-3.x</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">yt Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/data_inspection.html">Data Inspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/simple_visualization.html">Simple Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/data_objects_and_time_series.html">Data Objects and Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/derived_fields_and_profiles.html">Derived Fields and Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/volume_rendering.html">Volume Rendering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../yt3differences.html">What&#8217;s New and Different in yt 3.0?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../yt3differences.html#updating-to-yt-3-0-from-old-versions-and-going-back">Updating to yt 3.0 from Old Versions (and going back)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../yt3differences.html#converting-old-scripts-to-work-with-yt-3-0">Converting Old Scripts to Work with yt 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../yt3differences.html#cool-new-things">Cool New Things</a></li>
<li class="toctree-l2"><a class="reference internal" href="../yt3differences.html#api-changes">API Changes</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">The Cookbook</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#getting-the-sample-data">Getting the Sample Data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#example-scripts">Example Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#example-notebooks">Example Notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../visualizing/index.html">Visualizing Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/plots.html">How to Make Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/callbacks.html">Plot Modifications: Overplotting Contours, Velocities, Particles, and More</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/manual_plotting.html">Using the Manual Plotting Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/volume_rendering.html">Volume Rendering: Making 3D Photorealistic Isocontoured Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/hardware_volume_rendering.html">Hardware Volume Rendering on NVidia Graphics cards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/sketchfab.html">3D Surfaces and Sketchfab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/mapserver.html">Mapserver - A Google-Maps-like Interface to your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/streamlines.html">Streamlines: Tracking the Trajectories of Tracers in your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/colormaps/index.html">Colormaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualizing/writing_fits_images.html">Writing FITS Images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../analyzing/index.html">General Data Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/fields.html">Fields in yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developing/creating_derived_fields.html">Creating Derived Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/objects.html">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/units/index.html">Symbolic Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/filtering.html">Filtering your Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/generating_processed_data.html">Generating Processed Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/time_series_analysis.html">Time Series Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/parallel_computation.html">Parallel Computation With yt</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../analyzing/analysis_modules/index.html">Topic-Specific Analysis Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/halo_analysis.html">Halo Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/synthetic_observation.html">Synthetic Observation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/exporting.html">Exporting to External Radiation Transport Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/two_point_functions.html">Two Point Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/clump_finding.html">Clump Finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/particle_trajectories.html">Particle Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzing/analysis_modules/ellipsoid_analysis.html">Halo Ellipsoid Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examining/index.html">Loading and Examining Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examining/loading_data.html">Loading Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examining/generic_array_data.html">Loading Generic Array Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examining/generic_particle_data.html">Loading Generic Particle Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examining/spherical_data.html">Loading Spherical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examining/low_level_inspection.html">Low-Level Data Inspection: Accessing Raw Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developing/index.html">Developing in yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developing/intro.html">Getting Involved</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developing/developing.html">How to Develop yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developing/building_the_docs.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developing/testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developing/debugdrive.html">Debugging yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developing/creating_datatypes.html">Creating Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developing/creating_derived_fields.html">Creating Derived Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developing/creating_derived_quantities.html">Creating Derived Quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developing/creating_frontend.html">Creating A New Code Frontend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developing/external_analysis.html">Using yt with External Analysis Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference Materials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/code_support.html">Code Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/command-line.html">Command-Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/api/api.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/configuration.html">Customizing yt: The Configuration and Plugin Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/field_list.html">Field List</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/changelog.html">ChangeLog</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#version-installation">Version &amp; Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#code-errors-and-failures">Code Errors and Failures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#units">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#fields">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#data-objects">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#developing">Developing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../help/index.html">Getting Help</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#don-t-panic-and-don-t-give-up">Don&#8217;t panic and don&#8217;t give up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#update-to-the-latest-version">Update to the latest version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#search-the-documentation-faq-and-mailing-lists">Search the documentation, FAQ, and mailing lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#look-at-the-source-code">Look at the source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#isolate-and-document-your-problem">Isolate and document your problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#go-on-irc-to-ask-a-question">Go on IRC to ask a question</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#ask-the-mailing-list">Ask the mailing list</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#submit-a-bug-report">Submit a bug report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help/index.html#special-issues">Special Issues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about/index.html#what-is-yt">What is yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/index.html#who-is-yt">Who is yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/index.html#history-of-yt">History of yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/index.html#how-do-i-contact-yt">How do I contact yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/index.html#how-do-i-cite-yt">How do I cite yt?</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">A Few Complex Plots</a><ul>
<li><a class="reference internal" href="#multi-width-image">Multi-Width Image</a></li>
<li><a class="reference internal" href="#multipanel-with-axes-labels">Multipanel with Axes Labels</a></li>
<li><a class="reference internal" href="#time-series-multipanel">Time Series Multipanel</a></li>
<li><a class="reference internal" href="#mutiple-slice-multipanel">Mutiple Slice Multipanel</a></li>
<li><a class="reference internal" href="#multi-plot-slice-and-projections">Multi-Plot Slice and Projections</a></li>
<li><a class="reference internal" href="#advanced-multi-plot-multi-panel">Advanced Multi-Plot Multi-Panel</a></li>
<li><a class="reference internal" href="#off-axis-projection-an-alternate-method">Off-Axis Projection (an alternate method)</a></li>
<li><a class="reference internal" href="#off-axis-projection-with-a-colorbar-an-alternate-method">Off-Axis Projection with a Colorbar (an alternate method)</a></li>
<li><a class="reference internal" href="#thin-slice-projections">Thin-Slice Projections</a></li>
<li><a class="reference internal" href="#plotting-particles-over-fluids">Plotting Particles Over Fluids</a></li>
<li><a class="reference internal" href="#plotting-grid-edges-over-fluids">Plotting Grid Edges Over Fluids</a></li>
<li><a class="reference internal" href="#overplotting-velocity-vectors">Overplotting Velocity Vectors</a></li>
<li><a class="reference internal" href="#overplotting-contours">Overplotting Contours</a></li>
<li><a class="reference internal" href="#simple-contours-in-a-slice">Simple Contours in a Slice</a></li>
<li><a class="reference internal" href="#styling-radial-profile-plots">Styling Radial Profile Plots</a></li>
<li><a class="reference internal" href="#customized-profile-plot">Customized Profile Plot</a></li>
<li><a class="reference internal" href="#customized-phase-plot">Customized Phase Plot</a></li>
<li><a class="reference internal" href="#moving-a-volume-rendering-camera">Moving a Volume Rendering Camera</a></li>
<li><a class="reference internal" href="#zooming-into-an-image">Zooming into an Image</a></li>
<li><a class="reference internal" href="#opaque-volume-rendering">Opaque Volume Rendering</a></li>
<li><a class="reference internal" href="#downsampling-data-for-volume-rendering">Downsampling Data for Volume Rendering</a></li>
<li><a class="reference internal" href="#volume-rendering-with-bounding-box-and-overlaid-grids">Volume Rendering with Bounding Box and Overlaid Grids</a></li>
<li><a class="reference internal" href="#volume-rendering-with-annotation">Volume Rendering with Annotation</a></li>
<li><a class="reference internal" href="#plotting-streamlines">Plotting Streamlines</a></li>
<li><a class="reference internal" href="#plotting-isocontours">Plotting Isocontours</a></li>
<li><a class="reference internal" href="#plotting-isocontours-and-streamlines">Plotting Isocontours and Streamlines</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="a-few-complex-plots">
<h1>A Few Complex Plots<a class="headerlink" href="#a-few-complex-plots" title="Permalink to this headline">¶</a></h1>
<p>The built-in plotting functionality covers the very simple use cases that are
most common.  These scripts will demonstrate how to construct more complex
plots or publication-quality plots.  In many cases these show how to make
multi-panel plots.</p>
<div class="section" id="multi-width-image">
<h2>Multi-Width Image<a class="headerlink" href="#multi-width-image" title="Permalink to this headline">¶</a></h2>
<p>This is a simple recipe to show how to open a dataset and then plot slices
through it at varying widths.
See <a class="reference internal" href="../visualizing/plots.html#slice-plots"><span>Slice Plots</span></a> for more information.</p>
<p>(<a class="reference external" href="multi_width_image.py">multi_width_image.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>

<span class="c"># Load the dataset.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;IsolatedGalaxy/galaxy0030/galaxy0030&quot;</span><span class="p">)</span>

<span class="c"># Create a slice plot for the dataset.  With no additional arguments,</span>
<span class="c"># the width will be the size of the domain and the center will be the</span>
<span class="c"># center of the simulation box</span>
<span class="n">slc</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">SlicePlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="s">&#39;density&#39;</span><span class="p">)</span>

<span class="c"># Create a list of a couple of widths and units. </span>
<span class="c"># (N.B. Mpc (megaparsec) != mpc (milliparsec)</span>
<span class="n">widths</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;Mpc&#39;</span><span class="p">),</span>
          <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="s">&#39;kpc&#39;</span><span class="p">)]</span>

<span class="c"># Loop through the list of widths and units.</span>
<span class="k">for</span> <span class="n">width</span><span class="p">,</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">widths</span><span class="p">:</span>

    <span class="c"># Set the width.</span>
    <span class="n">slc</span><span class="o">.</span><span class="n">set_width</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

    <span class="c"># Write out the image with a unique name.</span>
    <span class="n">slc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">_</span><span class="si">%010d</span><span class="s">_</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">unit</span><span class="p">))</span>

<span class="n">zoomFactors</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="c"># recreate the original slice</span>
<span class="n">slc</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">SlicePlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="s">&#39;density&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">zoomFactor</span> <span class="ow">in</span> <span class="n">zoomFactors</span><span class="p">:</span>

    <span class="c"># zoom in</span>
    <span class="n">slc</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="n">zoomFactor</span><span class="p">)</span>

    <span class="c"># Write out the image with a unique name.</span>
    <span class="n">slc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">_</span><span class="si">%i</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">zoomFactor</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="multipanel-with-axes-labels">
<h2>Multipanel with Axes Labels<a class="headerlink" href="#multipanel-with-axes-labels" title="Permalink to this headline">¶</a></h2>
<p>This illustrates how to use a SlicePlot to control a multipanel plot.  This
plot uses axes labels to illustrate the length scales in the plot.
See <a class="reference internal" href="../visualizing/plots.html#slice-plots"><span>Slice Plots</span></a> and the
<a class="reference external" href="http://matplotlib.org/mpl_toolkits/axes_grid/api/axes_grid_api.html">Matplotlib AxesGrid Object</a>
for more information.</p>
<p>(<a class="reference external" href="multiplot_2x2.py">multiplot_2x2.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">AxesGrid</span>

<span class="n">fn</span> <span class="o">=</span> <span class="s">&quot;IsolatedGalaxy/galaxy0030/galaxy0030&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="c"># load data</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="c"># See http://matplotlib.org/mpl_toolkits/axes_grid/api/axes_grid_api.html</span>
<span class="c"># These choices of keyword arguments produce a four panel plot that includes</span>
<span class="c"># four narrow colorbars, one for each plot.  Axes labels are only drawn on the </span>
<span class="c"># bottom left hand plot to avoid repeating information and make the plot less</span>
<span class="c"># cluttered.</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">AxesGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.075</span><span class="p">,</span><span class="mf">0.075</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.85</span><span class="p">),</span>
                <span class="n">nrows_ncols</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">axes_pad</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                <span class="n">label_mode</span> <span class="o">=</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
                <span class="n">share_all</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
                <span class="n">cbar_location</span><span class="o">=</span><span class="s">&quot;right&quot;</span><span class="p">,</span>
                <span class="n">cbar_mode</span><span class="o">=</span><span class="s">&quot;each&quot;</span><span class="p">,</span>
                <span class="n">cbar_size</span><span class="o">=</span><span class="s">&quot;3%&quot;</span><span class="p">,</span>
                <span class="n">cbar_pad</span><span class="o">=</span><span class="s">&quot;0%&quot;</span><span class="p">)</span>

<span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;density&#39;</span><span class="p">,</span> <span class="s">&#39;velocity_x&#39;</span><span class="p">,</span> <span class="s">&#39;velocity_y&#39;</span><span class="p">,</span> <span class="s">&#39;velocity_magnitude&#39;</span><span class="p">]</span>

<span class="c"># Create the plot.  Since SlicePlot accepts a list of fields, we need only</span>
<span class="c"># do this once.</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">SlicePlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>

<span class="c"># Velocity is going to be both positive and negative, so let&#39;s make these</span>
<span class="c"># slices use a linear colorbar scale</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_log</span><span class="p">(</span><span class="s">&#39;velocity_x&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_log</span><span class="p">(</span><span class="s">&#39;velocity_y&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c"># For each plotted field, force the SlicePlot to redraw itself onto the AxesGrid</span>
<span class="c"># axes.</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">fig</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">cax</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">cbar_axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="c"># Finally, redraw the plot on the AxesGrid axes.</span>
<span class="n">p</span><span class="o">.</span><span class="n">_setup_plots</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;multiplot_2x2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="time-series-multipanel">
<h2>Time Series Multipanel<a class="headerlink" href="#time-series-multipanel" title="Permalink to this headline">¶</a></h2>
<p>This illustrates how to create a multipanel plot of a time series dataset.
See <a class="reference internal" href="../visualizing/plots.html#projection-plots"><span>Projection Plots</span></a>, <a class="reference internal" href="../analyzing/time_series_analysis.html#time-series-analysis"><span>Time Series Analysis</span></a>, and the
<a class="reference external" href="http://matplotlib.org/mpl_toolkits/axes_grid/api/axes_grid_api.html">Matplotlib AxesGrid Object</a>
for more information.</p>
<p>(<a class="reference external" href="multiplot_2x2_time_series.py">multiplot_2x2_time_series.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">AxesGrid</span>

<span class="n">fns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Enzo_64/DD0005/data0005&#39;</span><span class="p">,</span><span class="s">&#39;Enzo_64/DD0015/data0015&#39;</span><span class="p">,</span> <span class="s">&#39;Enzo_64/DD0025/data0025&#39;</span><span class="p">,</span> <span class="s">&#39;Enzo_64/DD0035/data0035&#39;</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="c"># See http://matplotlib.org/mpl_toolkits/axes_grid/api/axes_grid_api.html</span>
<span class="c"># These choices of keyword arguments produce a four panel plot with a single</span>
<span class="c"># shared narrow colorbar on the right hand side of the multipanel plot. Axes</span>
<span class="c"># labels are drawn for all plots since we&#39;re slicing along different directions</span>
<span class="c"># for each plot.</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">AxesGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.075</span><span class="p">,</span><span class="mf">0.075</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.85</span><span class="p">),</span>
                <span class="n">nrows_ncols</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">axes_pad</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
                <span class="n">label_mode</span> <span class="o">=</span> <span class="s">&quot;L&quot;</span><span class="p">,</span>
                <span class="n">share_all</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
                <span class="n">cbar_location</span><span class="o">=</span><span class="s">&quot;right&quot;</span><span class="p">,</span>
                <span class="n">cbar_mode</span><span class="o">=</span><span class="s">&quot;single&quot;</span><span class="p">,</span>
                <span class="n">cbar_size</span><span class="o">=</span><span class="s">&quot;3%&quot;</span><span class="p">,</span>
                <span class="n">cbar_pad</span><span class="o">=</span><span class="s">&quot;0%&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fns</span><span class="p">):</span>
    <span class="c"># Load the data and create a single plot</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="c"># load data</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">ProjectionPlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="s">&#39;density&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="s">&#39;Mpccm&#39;</span><span class="p">))</span>

    <span class="c"># Ensure the colorbar limits match for all plots</span>
    <span class="n">p</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="s">&#39;density&#39;</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">)</span>

    <span class="c"># This forces the ProjectionPlot to redraw itself on the AxesGrid axes.</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s">&#39;density&#39;</span><span class="p">]</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">fig</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">cax</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">cbar_axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c"># Finally, this actually redraws the plot.</span>
    <span class="n">p</span><span class="o">.</span><span class="n">_setup_plots</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;multiplot_2x2_time_series.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="mutiple-slice-multipanel">
<h2>Mutiple Slice Multipanel<a class="headerlink" href="#mutiple-slice-multipanel" title="Permalink to this headline">¶</a></h2>
<p>This illustrates how to create a multipanel plot of slices along the coordinate
axes.  To focus on what&#8217;s happening in the x-y plane, we make an additional
Temperature slice for the bottom-right subpanel.
See <a class="reference internal" href="../visualizing/plots.html#slice-plots"><span>Slice Plots</span></a> and the
<a class="reference external" href="http://matplotlib.org/mpl_toolkits/axes_grid/api/axes_grid_api.html">Matplotlib AxesGrid Object</a>
for more information.</p>
<p>(<a class="reference external" href="multiplot_2x2_coordaxes_slice.py">multiplot_2x2_coordaxes_slice.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">AxesGrid</span>

<span class="n">fn</span> <span class="o">=</span> <span class="s">&quot;IsolatedGalaxy/galaxy0030/galaxy0030&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="c"># load data</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="c"># See http://matplotlib.org/mpl_toolkits/axes_grid/api/axes_grid_api.html</span>
<span class="c"># These choices of keyword arguments produce two colorbars, both drawn on the</span>
<span class="c"># right hand side.  This means there are only two colorbar axes, one for Density</span>
<span class="c"># and another for temperature.  In addition, axes labels will be drawn for all</span>
<span class="c"># plots.</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">AxesGrid</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.075</span><span class="p">,</span><span class="mf">0.075</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.85</span><span class="p">),</span>
                <span class="n">nrows_ncols</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">axes_pad</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                <span class="n">label_mode</span> <span class="o">=</span> <span class="s">&quot;all&quot;</span><span class="p">,</span>
                <span class="n">share_all</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
                <span class="n">cbar_location</span><span class="o">=</span><span class="s">&quot;right&quot;</span><span class="p">,</span>
                <span class="n">cbar_mode</span><span class="o">=</span><span class="s">&quot;edge&quot;</span><span class="p">,</span>
                <span class="n">cbar_size</span><span class="o">=</span><span class="s">&quot;5%&quot;</span><span class="p">,</span>
                <span class="n">cbar_pad</span><span class="o">=</span><span class="s">&quot;0%&quot;</span><span class="p">)</span>

<span class="n">cuts</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">]</span>
<span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;density&#39;</span><span class="p">,</span> <span class="s">&#39;density&#39;</span><span class="p">,</span> <span class="s">&#39;density&#39;</span><span class="p">,</span> <span class="s">&#39;temperature&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">cuts</span><span class="p">,</span> <span class="n">fields</span><span class="p">)):</span>
    <span class="c"># Load the data and create a single plot</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">SlicePlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>

    <span class="c"># This forces the ProjectionPlot to redraw itself on the AxesGrid axes.</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">fig</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span>

    <span class="c"># Since there are only two colorbar axes, we need to make sure we don&#39;t try</span>
    <span class="c"># to set the temperature colorbar to cbar_axes[4], which would if we used i</span>
    <span class="c"># to index cbar_axes, yielding a plot without a temperature colorbar.</span>
    <span class="c"># This unecessarily redraws the Density colorbar three times, but that has</span>
    <span class="c"># no effect on the final plot.</span>
    <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="s">&#39;density&#39;</span><span class="p">:</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">cax</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">cbar_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="s">&#39;temperature&#39;</span><span class="p">:</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">cax</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">cbar_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c"># Finally, redraw the plot.</span>
    <span class="n">p</span><span class="o">.</span><span class="n">_setup_plots</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;multiplot_2x2_coordaxes_slice.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="multi-plot-slice-and-projections">
<h2>Multi-Plot Slice and Projections<a class="headerlink" href="#multi-plot-slice-and-projections" title="Permalink to this headline">¶</a></h2>
<p>This shows how to combine multiple slices and projections into a single image,
with detailed control over colorbars, titles and color limits.
See <a class="reference internal" href="../visualizing/plots.html#slice-plots"><span>Slice Plots</span></a> and <a class="reference internal" href="../visualizing/plots.html#projection-plots"><span>Projection Plots</span></a> for more information.</p>
<p>(<a class="reference external" href="multi_plot_slice_and_proj.py">multi_plot_slice_and_proj.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">yt.visualization.base_plot_types</span> <span class="kn">import</span> <span class="n">get_multi_plot</span>
<span class="kn">import</span> <span class="nn">matplotlib.colorbar</span> <span class="kn">as</span> <span class="nn">cb</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LogNorm</span>

<span class="n">fn</span> <span class="o">=</span> <span class="s">&quot;GasSloshing/sloshing_nomag2_hdf5_plt_cnt_0150&quot;</span> <span class="c"># dataset to load</span>
<span class="n">orient</span> <span class="o">=</span> <span class="s">&#39;horizontal&#39;</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="c"># load data</span>

<span class="c"># There&#39;s a lot in here:</span>
<span class="c">#   From this we get a containing figure, a list-of-lists of axes into which we</span>
<span class="c">#   can place plots, and some axes that we&#39;ll put colorbars.</span>
<span class="c"># We feed it:</span>
<span class="c">#   Number of plots on the x-axis, number of plots on the y-axis, and how we</span>
<span class="c">#   want our colorbars oriented.  (This governs where they will go, too.</span>
<span class="c">#   bw is the base-width in inches, but 4 is about right for most cases.</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">colorbars</span> <span class="o">=</span> <span class="n">get_multi_plot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="n">orient</span><span class="p">,</span> <span class="n">bw</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">slc</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">SlicePlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;density&quot;</span><span class="p">,</span><span class="s">&quot;temperature&quot;</span><span class="p">,</span><span class="s">&quot;velocity_magnitude&quot;</span><span class="p">])</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">ProjectionPlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">,</span> <span class="n">weight_field</span><span class="o">=</span><span class="s">&quot;density&quot;</span><span class="p">)</span>

<span class="n">slc_frb</span> <span class="o">=</span> <span class="n">slc</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">to_frb</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;Mpc&quot;</span><span class="p">),</span> <span class="mi">512</span><span class="p">)</span>
<span class="n">proj_frb</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">to_frb</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;Mpc&quot;</span><span class="p">),</span> <span class="mi">512</span><span class="p">)</span>

<span class="n">dens_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">temp_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">vels_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span>

<span class="k">for</span> <span class="n">dax</span><span class="p">,</span> <span class="n">tax</span><span class="p">,</span> <span class="n">vax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dens_axes</span><span class="p">,</span> <span class="n">temp_axes</span><span class="p">,</span> <span class="n">vels_axes</span><span class="p">)</span> <span class="p">:</span>

    <span class="n">dax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">dax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">tax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">tax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">vax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">vax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># Converting our Fixed Resolution Buffers to numpy arrays so that matplotlib</span>
<span class="c"># can render them</span>

<span class="n">slc_dens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slc_frb</span><span class="p">[</span><span class="s">&#39;density&#39;</span><span class="p">])</span>
<span class="n">proj_dens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proj_frb</span><span class="p">[</span><span class="s">&#39;density&#39;</span><span class="p">])</span>
<span class="n">slc_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slc_frb</span><span class="p">[</span><span class="s">&#39;temperature&#39;</span><span class="p">])</span>
<span class="n">proj_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proj_frb</span><span class="p">[</span><span class="s">&#39;temperature&#39;</span><span class="p">])</span>
<span class="n">slc_vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slc_frb</span><span class="p">[</span><span class="s">&#39;velocity_magnitude&#39;</span><span class="p">])</span>
<span class="n">proj_vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proj_frb</span><span class="p">[</span><span class="s">&#39;velocity_magnitude&#39;</span><span class="p">])</span>

<span class="n">plots</span> <span class="o">=</span> <span class="p">[</span><span class="n">dens_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">slc_dens</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">()),</span>
         <span class="n">dens_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">proj_dens</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">()),</span>
         <span class="n">temp_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">slc_temp</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">),</span>    
         <span class="n">temp_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">proj_temp</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">),</span>
         <span class="n">vels_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">slc_vel</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">()),</span>
         <span class="n">vels_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">proj_vel</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">())]</span>
         
<span class="n">plots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_clim</span><span class="p">((</span><span class="mf">1.0e-27</span><span class="p">,</span><span class="mf">1.0e-25</span><span class="p">))</span>
<span class="n">plots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s">&quot;bds_highcontrast&quot;</span><span class="p">)</span>
<span class="n">plots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_clim</span><span class="p">((</span><span class="mf">1.0e-27</span><span class="p">,</span><span class="mf">1.0e-25</span><span class="p">))</span>
<span class="n">plots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s">&quot;bds_highcontrast&quot;</span><span class="p">)</span>
<span class="n">plots</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_clim</span><span class="p">((</span><span class="mf">1.0e7</span><span class="p">,</span><span class="mf">1.0e8</span><span class="p">))</span>
<span class="n">plots</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s">&quot;hot&quot;</span><span class="p">)</span>
<span class="n">plots</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_clim</span><span class="p">((</span><span class="mf">1.0e7</span><span class="p">,</span><span class="mf">1.0e8</span><span class="p">))</span>
<span class="n">plots</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s">&quot;hot&quot;</span><span class="p">)</span>
<span class="n">plots</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_clim</span><span class="p">((</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">))</span>
<span class="n">plots</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s">&quot;gist_rainbow&quot;</span><span class="p">)</span>
<span class="n">plots</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">set_clim</span><span class="p">((</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">))</span>
<span class="n">plots</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s">&quot;gist_rainbow&quot;</span><span class="p">)</span>

<span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s">r&#39;$\mathrm{Density}\ (\mathrm{g\ cm^{-3}})$&#39;</span><span class="p">,</span> 
        <span class="s">r&#39;$\mathrm{Temperature}\ (\mathrm{K})$&#39;</span><span class="p">,</span>
        <span class="s">r&#39;$\mathrm{Velocity Magnitude}\ (\mathrm{cm\ s^{-1}})$&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">cax</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">plots</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">colorbars</span><span class="p">,</span> <span class="n">titles</span><span class="p">):</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">orient</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c"># And now we&#39;re done! </span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">_3x2&quot;</span> <span class="o">%</span> <span class="n">ds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="advanced-multi-plot-multi-panel">
<span id="advanced-multi-panel"></span><h2>Advanced Multi-Plot Multi-Panel<a class="headerlink" href="#advanced-multi-plot-multi-panel" title="Permalink to this headline">¶</a></h2>
<p>This produces a series of slices of multiple fields with different color maps
and zlimits, and makes use of the FixedResolutionBuffer. While this is more
complex than the equivalent plot collection-based solution, it allows for a
<em>lot</em> more flexibility. Every part of the script uses matplotlib commands,
allowing its full power to be exercised.
See <a class="reference internal" href="../visualizing/plots.html#slice-plots"><span>Slice Plots</span></a> and <a class="reference internal" href="../visualizing/plots.html#projection-plots"><span>Projection Plots</span></a> for more information.</p>
<p>(<a class="reference external" href="multi_plot_3x2_FRB.py">multi_plot_3x2_FRB.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">yt.visualization.api</span> <span class="kn">import</span> <span class="n">get_multi_plot</span>
<span class="kn">import</span> <span class="nn">matplotlib.colorbar</span> <span class="kn">as</span> <span class="nn">cb</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LogNorm</span>

<span class="n">fn</span> <span class="o">=</span> <span class="s">&quot;Enzo_64/RD0006/RedshiftOutput0006&quot;</span> <span class="c"># dataset to load</span>

<span class="c"># load data and get center value and center location as maximum density location</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> 
<span class="n">v</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">find_max</span><span class="p">(</span><span class="s">&quot;density&quot;</span><span class="p">)</span>

<span class="c"># set up our Fixed Resolution Buffer parameters: a width, resolution, and center</span>
<span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s">&#39;unitary&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="c">#  get_multi_plot returns a containing figure, a list-of-lists of axes</span>
<span class="c">#   into which we can place plots, and some axes that we&#39;ll put</span>
<span class="c">#   colorbars.  </span>

<span class="c">#  it accepts: # of x-axis plots, # of y-axis plots, and how the</span>
<span class="c">#  colorbars are oriented (this also determines where they go: below</span>
<span class="c">#  in the case of &#39;horizontal&#39;, on the right in the case of</span>
<span class="c">#  &#39;vertical&#39;), bw is the base-width in inches (4 is about right for</span>
<span class="c">#  most cases)</span>

<span class="n">orient</span> <span class="o">=</span> <span class="s">&#39;horizontal&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">colorbars</span> <span class="o">=</span> <span class="n">get_multi_plot</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="n">orient</span><span class="p">,</span> <span class="n">bw</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>

<span class="c"># Now we follow the method of &quot;multi_plot.py&quot; but we&#39;re going to iterate</span>
<span class="c"># over the columns, which will become axes of slicing.</span>
<span class="n">plots</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">sli</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="n">ax</span><span class="p">])</span>
    <span class="n">frb</span> <span class="o">=</span> <span class="n">sli</span><span class="o">.</span><span class="n">to_frb</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
    <span class="n">den_axis</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">ax</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">temp_axis</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">ax</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="c"># here, we turn off the axes labels and ticks, but you could</span>
    <span class="c"># customize further.</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">(</span><span class="n">den_axis</span><span class="p">,</span> <span class="n">temp_axis</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

    <span class="c"># converting our fixed resolution buffers to NDarray so matplotlib can</span>
    <span class="c"># render them</span>
    <span class="n">dens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">frb</span><span class="p">[</span><span class="s">&#39;density&#39;</span><span class="p">])</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">frb</span><span class="p">[</span><span class="s">&#39;temperature&#39;</span><span class="p">])</span>

    <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">den_axis</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">()))</span>
    <span class="n">plots</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_clim</span><span class="p">((</span><span class="mf">5e-32</span><span class="p">,</span> <span class="mf">1e-29</span><span class="p">))</span>
    <span class="n">plots</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s">&quot;bds_highcontrast&quot;</span><span class="p">)</span>

    <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_axis</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">()))</span>
    <span class="n">plots</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_clim</span><span class="p">((</span><span class="mf">1e3</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">))</span>
    <span class="n">plots</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s">&quot;hot&quot;</span><span class="p">)</span>
    
<span class="c"># Each &#39;cax&#39; is a colorbar-container, into which we&#39;ll put a colorbar.</span>
<span class="c"># the zip command creates triples from each element of the three lists</span>
<span class="c"># .  Note that it cuts off after the shortest iterator is exhausted,</span>
<span class="c"># in this case, titles.</span>
<span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s">r&#39;$\mathrm{Density}\ (\mathrm{g\ cm^{-3}})$&#39;</span><span class="p">,</span> <span class="s">r&#39;$\mathrm{temperature}\ (\mathrm{K})$&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">cax</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">plots</span><span class="p">,</span> <span class="n">colorbars</span><span class="p">,</span><span class="n">titles</span><span class="p">):</span>
    <span class="c"># Now we make a colorbar, using the &#39;image&#39; we stored in plots</span>
    <span class="c"># above. note this is what is *returned* by the imshow method of</span>
    <span class="c"># the plots.</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">orient</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c"># And now we&#39;re done!  </span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">_3x2.png&quot;</span> <span class="o">%</span> <span class="n">ds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="off-axis-projection-an-alternate-method">
<span id="cookbook-offaxis-projection"></span><h2>Off-Axis Projection (an alternate method)<a class="headerlink" href="#off-axis-projection-an-alternate-method" title="Permalink to this headline">¶</a></h2>
<p>This recipe demonstrates how to take an image-plane line integral along an
arbitrary axis in a simulation.  This uses alternate machinery than the
standard <a class="reference internal" href="../visualizing/plots.html#off-axis-projections"><span>PlotWindow interface</span></a> to create an
off-axis projection as demonstrated in this
<a class="reference internal" href="simple_plots.html#cookbook-simple-off-axis-projection"><span>recipe</span></a>.</p>
<p>(<a class="reference external" href="offaxis_projection.py">offaxis_projection.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c"># Load the dataset.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;IsolatedGalaxy/galaxy0030/galaxy0030&quot;</span><span class="p">)</span>

<span class="c"># Choose a center for the render.</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>

<span class="c"># Our image plane will be normal to some vector.  For things like collapsing</span>
<span class="c"># objects, you could set it the way you would a cutting plane -- but for this</span>
<span class="c"># dataset, we&#39;ll just choose an off-axis value at random.  This gets normalized</span>
<span class="c"># automatically.</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>

<span class="c"># Our &quot;width&quot; is the width of the image plane as well as the depth.</span>
<span class="c"># The first element is the left to right width, the second is the</span>
<span class="c"># top-bottom width, and the last element is the back-to-front width</span>
<span class="c"># (all in code units)</span>
<span class="n">W</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.04</span><span class="p">,</span><span class="mf">0.04</span><span class="p">,</span><span class="mf">0.4</span><span class="p">]</span>

<span class="c"># The number of pixels along one side of the image.</span>
<span class="c"># The final image will have Npixel^2 pixels.</span>
<span class="n">Npixels</span> <span class="o">=</span> <span class="mi">512</span>

<span class="c"># Create the off axis projection.</span>
<span class="c"># Setting no_ghost to False speeds up the process, but makes a</span>
<span class="c"># slighly lower quality image.</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">off_axis_projection</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">Npixels</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">,</span> <span class="n">no_ghost</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># Write out the final image and give it a name</span>
<span class="c"># relating to what our dataset is called.</span>
<span class="c"># We save the log of the values so that the colors do not span</span>
<span class="c"># many orders of magnitude.  Try it without and see what happens.</span>
<span class="n">yt</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">image</span><span class="p">),</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">_offaxis_projection.png&quot;</span> <span class="o">%</span> <span class="n">ds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="off-axis-projection-with-a-colorbar-an-alternate-method">
<h2>Off-Axis Projection with a Colorbar (an alternate method)<a class="headerlink" href="#off-axis-projection-with-a-colorbar-an-alternate-method" title="Permalink to this headline">¶</a></h2>
<p>This recipe shows how to generate a colorbar with a projection of a dataset
from an arbitrary projection angle (so you are not confined to the x, y, and z
axes).</p>
<p>This uses alternate machinery than the standard
<a class="reference internal" href="../visualizing/plots.html#off-axis-projections"><span>PlotWindow interface</span></a> to create an off-axis
projection as demonstrated in this
<a class="reference internal" href="simple_plots.html#cookbook-simple-off-axis-projection"><span>recipe</span></a>.</p>
<p>(<a class="reference external" href="offaxis_projection_colorbar.py">offaxis_projection_colorbar.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">fn</span> <span class="o">=</span> <span class="s">&quot;IsolatedGalaxy/galaxy0030/galaxy0030&quot;</span> <span class="c"># dataset to load</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="c"># load data</span>

<span class="c"># Now we need a center of our volume to render.  Here we&#39;ll just use</span>
<span class="c"># 0.5,0.5,0.5, because volume renderings are not periodic.</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>

<span class="c"># Our image plane will be normal to some vector.  For things like collapsing</span>
<span class="c"># objects, you could set it the way you would a cutting plane -- but for this</span>
<span class="c"># dataset, we&#39;ll just choose an off-axis value at random.  This gets normalized</span>
<span class="c"># automatically.</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>

<span class="c"># Our &quot;width&quot; is the width of the image plane as well as the depth.</span>
<span class="c"># The first element is the left to right width, the second is the</span>
<span class="c"># top-bottom width, and the last element is the back-to-front width</span>
<span class="c"># (all in code units)</span>
<span class="n">W</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.04</span><span class="p">,</span><span class="mf">0.04</span><span class="p">,</span><span class="mf">0.4</span><span class="p">]</span>

<span class="c"># The number of pixels along one side of the image.</span>
<span class="c"># The final image will have Npixel^2 pixels.</span>
<span class="n">Npixels</span> <span class="o">=</span> <span class="mi">512</span>

<span class="c"># Now we call the off_axis_projection function, which handles the rest.</span>
<span class="c"># Note that we set no_ghost equal to False, so that we *do* include ghost</span>
<span class="c"># zones in our data.  This takes longer to calculate, but the results look</span>
<span class="c"># much cleaner than when you ignore the ghost zones.</span>
<span class="c"># Also note that we set the field which we want to project as &quot;density&quot;, but</span>
<span class="c"># really we could use any arbitrary field like &quot;temperature&quot;, &quot;metallicity&quot;</span>
<span class="c"># or whatever.</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">off_axis_projection</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">Npixels</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">,</span> <span class="n">no_ghost</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># Image is now an NxN array representing the intensities of the various pixels.</span>
<span class="c"># And now, we call our direct image saver.  We save the log of the result.</span>
<span class="n">yt</span><span class="o">.</span><span class="n">write_projection</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s">&quot;offaxis_projection_colorbar.png&quot;</span><span class="p">,</span> 
                    <span class="n">colorbar_label</span><span class="o">=</span><span class="s">&quot;Column Density (cm$^{-2}$)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="thin-slice-projections">
<span id="id3"></span><h2>Thin-Slice Projections<a class="headerlink" href="#thin-slice-projections" title="Permalink to this headline">¶</a></h2>
<p>This recipe is an example of how to project through only a given data object,
in this case a thin region, and then display the result.
See <a class="reference internal" href="../visualizing/plots.html#projection-plots"><span>Projection Plots</span></a> and <a class="reference internal" href="../analyzing/objects.html#available-objects"><span>Available Objects</span></a> for more information.</p>
<p>(<a class="reference external" href="thin_slice_projection.py">thin_slice_projection.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>

<span class="c"># Load the dataset.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;Enzo_64/DD0030/data0030&quot;</span><span class="p">)</span>

<span class="c"># Make a projection that is the full width of the domain,</span>
<span class="c"># but only 5 Mpc in depth.  This is done by creating a</span>
<span class="c"># region object with this exact geometry and providing it</span>
<span class="c"># as a data_source for the projection.</span>

<span class="c"># Center on the domain center</span>
<span class="n">center</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">domain_center</span>

<span class="c"># First make the left and right corner of the region based</span>
<span class="c"># on the full domain.</span>
<span class="n">left_corner</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">domain_left_edge</span>
<span class="n">right_corner</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">domain_right_edge</span>

<span class="c"># Now adjust the size of the region along the line of sight (x axis).</span>
<span class="n">depth</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">quan</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span><span class="s">&#39;Mpc&#39;</span><span class="p">)</span>
<span class="n">left_corner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">depth</span>
<span class="n">right_corner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">depth</span>

<span class="c"># Create the region</span>
<span class="n">region</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="n">left_corner</span><span class="p">,</span> <span class="n">right_corner</span><span class="p">)</span>

<span class="c"># Create a density projection and supply the region we have just created.</span>
<span class="c"># Only cells within the region will be included in the projection.</span>
<span class="c"># Try with another data container, like a sphere or disk.</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">ProjectionPlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">,</span> <span class="n">weight_field</span><span class="o">=</span><span class="s">&quot;density&quot;</span><span class="p">,</span>
                         <span class="n">data_source</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>

<span class="c"># Save the image with the keyword.</span>
<span class="n">plot</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;Thin_Slice&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-particles-over-fluids">
<h2>Plotting Particles Over Fluids<a class="headerlink" href="#plotting-particles-over-fluids" title="Permalink to this headline">¶</a></h2>
<p>This recipe demonstrates how to overplot particles on top of a fluid image.
See <a class="reference internal" href="../visualizing/callbacks.html#annotate-particles"><span>Overplotting Particle Positions</span></a> for more information.</p>
<p>(<a class="reference external" href="overplot_particles.py">overplot_particles.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>

<span class="c"># Load the dataset.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;Enzo_64/DD0043/data0043&quot;</span><span class="p">)</span>

<span class="c"># Make a density projection centered on the &#39;m&#39;aximum density location</span>
<span class="c"># with a width of 10 Mpc..</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">ProjectionPlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="s">&#39;m&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s">&#39;Mpc&#39;</span><span class="p">))</span>

<span class="c"># Modify the projection</span>
<span class="c"># The argument specifies the region along the line of sight</span>
<span class="c"># for which particles will be gathered.</span>
<span class="c"># 1.0 signifies the entire domain in the line of sight</span>
<span class="c"># p.annotate_particles(1.0)</span>
<span class="c"># but in this case we only go 10 Mpc in depth</span>
<span class="n">p</span><span class="o">.</span><span class="n">annotate_particles</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="s">&#39;Mpc&#39;</span><span class="p">))</span>

<span class="c"># Save the image.</span>
<span class="c"># Optionally, give a string as an argument</span>
<span class="c"># to name files with a keyword.</span>
<span class="n">p</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-grid-edges-over-fluids">
<h2>Plotting Grid Edges Over Fluids<a class="headerlink" href="#plotting-grid-edges-over-fluids" title="Permalink to this headline">¶</a></h2>
<p>This recipe demonstrates how to overplot grid boxes on top of a fluid image.
Each level is represented with a different color from white (low refinement) to
black (high refinement).  One can change the colormap used for the grids colors
by using the cmap keyword (or set it to None to get all grid edges as black).
See <a class="reference internal" href="../visualizing/callbacks.html#annotate-grids"><span>Overplot Grids</span></a> for more information.</p>
<p>(<a class="reference external" href="overplot_grids.py">overplot_grids.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>

<span class="c"># Load the dataset.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;Enzo_64/DD0043/data0043&quot;</span><span class="p">)</span>

<span class="c"># Make a density projection.</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">ProjectionPlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">)</span>

<span class="c"># Modify the projection</span>
<span class="c"># The argument specifies the region along the line of sight</span>
<span class="c"># for which particles will be gathered.</span>
<span class="c"># 1.0 signifies the entire domain in the line of sight.</span>
<span class="n">p</span><span class="o">.</span><span class="n">annotate_grids</span><span class="p">()</span>

<span class="c"># Save the image.</span>
<span class="c"># Optionally, give a string as an argument</span>
<span class="c"># to name files with a keyword.</span>
<span class="n">p</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="overplotting-velocity-vectors">
<h2>Overplotting Velocity Vectors<a class="headerlink" href="#overplotting-velocity-vectors" title="Permalink to this headline">¶</a></h2>
<p>This recipe demonstrates how to plot velocity vectors on top of a slice.
See <a class="reference internal" href="../visualizing/callbacks.html#annotate-velocity"><span>Overplot Quivers for the Velocity Field</span></a> for more information.</p>
<p>(<a class="reference external" href="velocity_vectors_on_slice.py">velocity_vectors_on_slice.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>

<span class="c"># Load the dataset.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;GasSloshing/sloshing_nomag2_hdf5_plt_cnt_0150&quot;</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">SlicePlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">)</span>

<span class="c"># Draw a velocity vector every 16 pixels.</span>
<span class="n">p</span><span class="o">.</span><span class="n">annotate_velocity</span><span class="p">(</span><span class="n">factor</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="overplotting-contours">
<h2>Overplotting Contours<a class="headerlink" href="#overplotting-contours" title="Permalink to this headline">¶</a></h2>
<p>This is a simple recipe to show how to open a dataset, plot a slice through it,
and add contours of another quantity on top.
See <a class="reference internal" href="../visualizing/callbacks.html#annotate-contours"><span>Overplot Contours</span></a> for more information.</p>
<p>(<a class="reference external" href="contours_on_slice.py">contours_on_slice.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>

<span class="c"># first add density contours on a density slice</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;GasSloshing/sloshing_nomag2_hdf5_plt_cnt_0150&quot;</span><span class="p">)</span>

<span class="c"># add density contours on the density slice.</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">SlicePlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">annotate_contour</span><span class="p">(</span><span class="s">&quot;density&quot;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="c"># then add temperature contours on the same density slice</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">SlicePlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">annotate_contour</span><span class="p">(</span><span class="s">&quot;temperature&quot;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;_T_contour&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="simple-contours-in-a-slice">
<h2>Simple Contours in a Slice<a class="headerlink" href="#simple-contours-in-a-slice" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is useful to plot just a few contours of a quantity in a
dataset.  This shows how one does this by first making a slice, adding
contours, and then hiding the colormap plot of the slice to leave the
plot containing only the contours that one has added.
See <a class="reference internal" href="../visualizing/callbacks.html#annotate-contours"><span>Overplot Contours</span></a> for more information.</p>
<p>(<a class="reference external" href="simple_contour_in_slice.py">simple_contour_in_slice.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>

<span class="c"># Load the data file.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;Sedov_3d/sedov_hdf5_chk_0002&quot;</span><span class="p">)</span>

<span class="c"># Make a traditional slice plot.</span>
<span class="n">sp</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">SlicePlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">)</span>

<span class="c"># Overlay the slice plot with thick red contours of density.</span>
<span class="n">sp</span><span class="o">.</span><span class="n">annotate_contour</span><span class="p">(</span><span class="s">&quot;density&quot;</span><span class="p">,</span> <span class="n">ncont</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span><span class="mf">1e-1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">plot_args</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;colors&quot;</span><span class="p">:</span> <span class="s">&quot;red&quot;</span><span class="p">,</span>
                               <span class="s">&quot;linewidths&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

<span class="c"># What about some nice temperature contours in blue?</span>
<span class="n">sp</span><span class="o">.</span><span class="n">annotate_contour</span><span class="p">(</span><span class="s">&quot;temperature&quot;</span><span class="p">,</span> <span class="n">ncont</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span><span class="mf">1e-6</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">plot_args</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;colors&quot;</span><span class="p">:</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span>
                               <span class="s">&quot;linewidths&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

<span class="c"># This is the plot object.</span>
<span class="n">po</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s">&quot;density&quot;</span><span class="p">]</span>

<span class="c"># Turn off the colormap image, leaving just the contours.</span>
<span class="n">po</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># Remove the colorbar and its label.</span>
<span class="n">po</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">po</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c"># Save it and ask for a close fit to get rid of the space used by the colorbar.</span>
<span class="n">sp</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">mpl_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;bbox_inches&#39;</span><span class="p">:</span><span class="s">&#39;tight&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="styling-radial-profile-plots">
<h2>Styling Radial Profile Plots<a class="headerlink" href="#styling-radial-profile-plots" title="Permalink to this headline">¶</a></h2>
<p>This recipe demonstrates a method of calculating radial profiles for several
quantities, styling them and saving out the resultant plot.
See <a class="reference internal" href="../visualizing/plots.html#how-to-make-1d-profiles"><span>1D Profile Plots</span></a> for more information.</p>
<p>(<a class="reference external" href="radial_profile_styles.py">radial_profile_styles.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;GasSloshing/sloshing_nomag2_hdf5_plt_cnt_0150&quot;</span><span class="p">)</span>

<span class="c"># Get a sphere object</span>

<span class="n">sp</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sphere</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">domain_center</span><span class="p">,</span> <span class="p">(</span><span class="mf">500.</span><span class="p">,</span> <span class="s">&quot;kpc&quot;</span><span class="p">))</span>

<span class="c"># Bin up the data from the sphere into a radial profile</span>

<span class="n">rp</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">create_profile</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s">&#39;radius&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;density&#39;</span><span class="p">,</span> <span class="s">&#39;temperature&#39;</span><span class="p">],</span>
                       <span class="n">units</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;radius&#39;</span><span class="p">:</span> <span class="s">&#39;kpc&#39;</span><span class="p">},</span>
                       <span class="n">logs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;radius&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">})</span>

<span class="c"># Make plots using matplotlib</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c"># Plot the density as a log-log plot using the default settings</span>
<span class="n">dens_plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">rp</span><span class="p">[</span><span class="s">&quot;density&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="c"># Here we set the labels of the plot axes</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">r&quot;$\mathrm{r\ (kpc)}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">r&quot;$\mathrm{\rho\ (g\ cm^{-3})}$&quot;</span><span class="p">)</span>

<span class="c"># Save the default plot</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;density_profile_default.png&quot;</span> <span class="o">%</span> <span class="n">ds</span><span class="p">)</span>

<span class="c"># The &quot;dens_plot&quot; object is a list of plot objects. In our case we only have one,</span>
<span class="c"># so we index the list by &#39;0&#39; to get it. </span>

<span class="c"># Plot using dashed red lines</span>

<span class="n">dens_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_linestyle</span><span class="p">(</span><span class="s">&quot;--&quot;</span><span class="p">)</span>
<span class="n">dens_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;density_profile_dashed_red.png&quot;</span><span class="p">)</span>

<span class="c"># Increase the line width and add points in the shape of x&#39;s</span>

<span class="n">dens_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">dens_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_marker</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">dens_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_markersize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;density_profile_thick_with_xs.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="customized-profile-plot">
<h2>Customized Profile Plot<a class="headerlink" href="#customized-profile-plot" title="Permalink to this headline">¶</a></h2>
<p>This recipe demonstrates how to create a fully customized 1D profile object
using the <a class="reference internal" href="../reference/api/generated/yt.data_objects.profiles.create_profile.html#yt.data_objects.profiles.create_profile" title="yt.data_objects.profiles.create_profile"><code class="xref py py-func docutils literal"><span class="pre">create_profile()</span></code></a> function and then
create a <a class="reference internal" href="../reference/api/generated/yt.visualization.profile_plotter.ProfilePlot.html#yt.visualization.profile_plotter.ProfilePlot" title="yt.visualization.profile_plotter.ProfilePlot"><code class="xref py py-class docutils literal"><span class="pre">ProfilePlot</span></code></a> using the
customized profile.  This illustrates how a <code class="docutils literal"><span class="pre">ProfilePlot</span></code> created this way
inherits the properties of the profile it is constructed from.
See <a class="reference internal" href="../visualizing/plots.html#how-to-make-1d-profiles"><span>1D Profile Plots</span></a> for more information.</p>
<p>(<a class="reference external" href="customized_profile_plot.py">customized_profile_plot.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">yt.units</span> <span class="kn">as</span> <span class="nn">u</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;HiresIsolatedGalaxy/DD0044/DD0044&#39;</span><span class="p">)</span>

<span class="n">center</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">]</span>
<span class="n">normal</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mi">40</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span>

<span class="n">disk</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">disk</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

<span class="n">profile</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">create_profile</span><span class="p">(</span>
    <span class="n">data_source</span><span class="o">=</span><span class="n">disk</span><span class="p">,</span>
    <span class="n">bin_fields</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;radius&quot;</span><span class="p">],</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;cylindrical_tangential_velocity_absolute&quot;</span><span class="p">],</span>
    <span class="n">n_bins</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">units</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="s">&quot;kpc&quot;</span><span class="p">,</span>
               <span class="n">cylindrical_tangential_velocity_absolute</span><span class="o">=</span><span class="s">&quot;km/s&quot;</span><span class="p">),</span>
    <span class="n">logs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
    <span class="n">weight_field</span><span class="o">=</span><span class="s">&#39;cell_mass&#39;</span><span class="p">,</span>
    <span class="n">extrema</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">40</span><span class="p">)),</span>
    <span class="p">)</span>

<span class="n">plot</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">ProfilePlot</span><span class="o">.</span><span class="n">from_profiles</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span>

<span class="n">plot</span><span class="o">.</span><span class="n">set_log</span><span class="p">(</span><span class="s">&#39;cylindrical_tangential_velocity_absolute&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="s">&#39;cylindrical_tangential_velocity_absolute&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">160</span><span class="p">)</span>

<span class="n">plot</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="customized-phase-plot">
<h2>Customized Phase Plot<a class="headerlink" href="#customized-phase-plot" title="Permalink to this headline">¶</a></h2>
<p>Similar to the recipe above, this demonstrates how to create a fully customized
2D profile object using the <a class="reference internal" href="../reference/api/generated/yt.data_objects.profiles.create_profile.html#yt.data_objects.profiles.create_profile" title="yt.data_objects.profiles.create_profile"><code class="xref py py-func docutils literal"><span class="pre">create_profile()</span></code></a>
function and then create a <a class="reference internal" href="../reference/api/generated/yt.visualization.profile_plotter.PhasePlot.html#yt.visualization.profile_plotter.PhasePlot" title="yt.visualization.profile_plotter.PhasePlot"><code class="xref py py-class docutils literal"><span class="pre">PhasePlot</span></code></a>
using the customized profile object.  This illustrates how a <code class="docutils literal"><span class="pre">PhasePlot</span></code>
created this way inherits the properties of the profile object from which it
is constructed. See <a class="reference internal" href="../visualizing/plots.html#how-to-make-2d-profiles"><span>2D Phase Plots</span></a> for more information.</p>
<p>(<a class="reference external" href="customized_phase_plot.py">customized_phase_plot.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">yt.units</span> <span class="kn">as</span> <span class="nn">u</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;HiresIsolatedGalaxy/DD0044/DD0044&#39;</span><span class="p">)</span>

<span class="n">center</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">]</span>
<span class="n">normal</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mi">40</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span>

<span class="n">disk</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">disk</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

<span class="n">profile</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">create_profile</span><span class="p">(</span>
    <span class="n">data_source</span><span class="o">=</span><span class="n">disk</span><span class="p">,</span>
    <span class="n">bin_fields</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;radius&quot;</span><span class="p">,</span> <span class="s">&quot;cylindrical_tangential_velocity&quot;</span><span class="p">],</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;cell_mass&quot;</span><span class="p">],</span>
    <span class="n">n_bins</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">units</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="s">&quot;kpc&quot;</span><span class="p">,</span>
               <span class="n">cylindrical_tangential_velocity</span><span class="o">=</span><span class="s">&quot;km/s&quot;</span><span class="p">,</span>
               <span class="n">cell_mass</span><span class="o">=</span><span class="s">&quot;Msun&quot;</span><span class="p">),</span>
    <span class="n">logs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
              <span class="n">cylindrical_tangential_velocity</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
    <span class="n">weight_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">extrema</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">40</span><span class="p">),</span>
                 <span class="n">cylindrical_tangential_velocity</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)),</span>
    <span class="p">)</span>

<span class="n">plot</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">PhasePlot</span><span class="o">.</span><span class="n">from_profile</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s">&quot;cell_mass&quot;</span><span class="p">,</span> <span class="s">&quot;YlOrRd&quot;</span><span class="p">)</span>

<span class="n">plot</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="moving-a-volume-rendering-camera">
<span id="cookbook-camera-movement"></span><h2>Moving a Volume Rendering Camera<a class="headerlink" href="#moving-a-volume-rendering-camera" title="Permalink to this headline">¶</a></h2>
<p>In this recipe, we move a camera through a domain and take multiple volume
rendering snapshots.
See <a class="reference internal" href="../visualizing/volume_rendering.html#volume-rendering"><span>Volume Rendering: Making 3D Photorealistic Isocontoured Images</span></a> for more information.</p>
<p>(<a class="reference external" href="camera_movement.py">camera_movement.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c"># Follow the simple_volume_rendering cookbook for the first part of this.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;IsolatedGalaxy/galaxy0030/galaxy0030&quot;</span><span class="p">)</span>  <span class="c"># load data</span>
<span class="n">ad</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">all_data</span><span class="p">()</span>
<span class="n">mi</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">quantities</span><span class="o">.</span><span class="n">extrema</span><span class="p">(</span><span class="s">&quot;density&quot;</span><span class="p">)</span>

<span class="c"># Set up transfer function</span>
<span class="n">tf</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">ColorTransferFunction</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ma</span><span class="p">)))</span>
<span class="n">tf</span><span class="o">.</span><span class="n">add_layers</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="c"># Set up camera paramters</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>  <span class="c"># Center</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c"># Normal Vector</span>
<span class="n">W</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c"># Width</span>
<span class="n">Nvec</span> <span class="o">=</span> <span class="mi">512</span>  <span class="c"># Pixels on a side</span>

<span class="c"># Specify a north vector, which helps with rotations.</span>
<span class="n">north_vector</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]</span>

<span class="c"># Find the maximum density location, store it in max_c</span>
<span class="n">v</span><span class="p">,</span> <span class="n">max_c</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">find_max</span><span class="p">(</span><span class="s">&#39;density&#39;</span><span class="p">)</span>

<span class="c"># Initialize the Camera</span>
<span class="n">cam</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">camera</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="p">(</span><span class="n">Nvec</span><span class="p">,</span> <span class="n">Nvec</span><span class="p">),</span> <span class="n">tf</span><span class="p">,</span> <span class="n">north_vector</span><span class="o">=</span><span class="n">north_vector</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c"># Do a rotation over 5 frames</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">snapshot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">rotation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">8.0</span><span class="p">)):</span>
    <span class="n">snapshot</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="s">&#39;camera_movement_</span><span class="si">%04i</span><span class="s">.png&#39;</span> <span class="o">%</span> <span class="n">frame</span><span class="p">)</span>
    <span class="n">frame</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c"># Move to the maximum density location over 5 frames</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">snapshot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">max_c</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">8.0</span><span class="p">)):</span>
    <span class="n">snapshot</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="s">&#39;camera_movement_</span><span class="si">%04i</span><span class="s">.png&#39;</span> <span class="o">%</span> <span class="n">frame</span><span class="p">)</span>
    <span class="n">frame</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c"># Zoom in by a factor of 10 over 5 frames</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">snapshot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">zoomin</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">8.0</span><span class="p">)):</span>
    <span class="n">snapshot</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="s">&#39;camera_movement_</span><span class="si">%04i</span><span class="s">.png&#39;</span> <span class="o">%</span> <span class="n">frame</span><span class="p">)</span>
    <span class="n">frame</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="zooming-into-an-image">
<h2>Zooming into an Image<a class="headerlink" href="#zooming-into-an-image" title="Permalink to this headline">¶</a></h2>
<p>This is a recipe that takes a slice through the most dense point, then creates
a bunch of frames as it zooms in.  It&#8217;s important to note that this particular
recipe is provided to show how to be more flexible and add annotations and the
like &#8211; the base system, of a zoomin, is provided by the &#8220;yt zoomin&#8221; command on
the command line.
See <a class="reference internal" href="../visualizing/plots.html#slice-plots"><span>Slice Plots</span></a> and <a class="reference internal" href="../visualizing/callbacks.html#callbacks"><span>Plot Modifications: Overplotting Contours, Velocities, Particles, and More</span></a> for more information.</p>
<p>(<a class="reference external" href="zoomin_frames.py">zoomin_frames.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c"># load data</span>
<span class="n">fn</span> <span class="o">=</span> <span class="s">&quot;IsolatedGalaxy/galaxy0030/galaxy0030&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

<span class="c"># This is the number of frames to make -- below, you can see how this is used.</span>
<span class="n">n_frames</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c"># This is the minimum size in smallest_dx of our last frame.</span>
<span class="c"># Usually it should be set to something like 400, but for THIS</span>
<span class="c"># dataset, we actually don&#39;t have that great of resolution.</span>
<span class="n">min_dx</span> <span class="o">=</span> <span class="mi">40</span>

<span class="n">frame_template</span> <span class="o">=</span> <span class="s">&quot;frame_</span><span class="si">%05i</span><span class="s">&quot;</span> <span class="c"># Template for frame filenames</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">SlicePlot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s">&quot;z&quot;</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">)</span> <span class="c"># Add our slice, along z</span>
<span class="n">p</span><span class="o">.</span><span class="n">annotate_contour</span><span class="p">(</span><span class="s">&quot;temperature&quot;</span><span class="p">)</span> <span class="c"># We&#39;ll contour in temperature</span>

<span class="c"># What we do now is a bit fun.  &quot;enumerate&quot; returns a tuple for every item --</span>
<span class="c"># the index of the item, and the item itself.  This saves us having to write</span>
<span class="c"># something like &quot;i = 0&quot; and then inside the loop &quot;i += 1&quot; for ever loop.  The</span>
<span class="c"># argument to enumerate is the &#39;logspace&#39; function, which takes a minimum and a</span>
<span class="c"># maximum and the number of items to generate.  It returns 10^power of each</span>
<span class="c"># item it generates.</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_smallest_dx</span><span class="p">()</span><span class="o">*</span><span class="n">min_dx</span><span class="p">),</span>
                                 <span class="n">n_frames</span><span class="p">)):</span>
    <span class="c"># We set our width as necessary for this frame</span>
    <span class="n">p</span><span class="o">.</span><span class="n">set_width</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s">&#39;unitary&#39;</span><span class="p">)</span>
    <span class="c"># save</span>
    <span class="n">p</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">frame_template</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="opaque-volume-rendering">
<span id="cookbook-opaque-rendering"></span><h2>Opaque Volume Rendering<a class="headerlink" href="#opaque-volume-rendering" title="Permalink to this headline">¶</a></h2>
<p>This recipe demonstrates how to make semi-opaque volume renderings, but also
how to step through and try different things to identify the type of volume
rendering you want.
See <a class="reference internal" href="../visualizing/volume_rendering.html#volume-rendering"><span>Volume Rendering: Making 3D Photorealistic Isocontoured Images</span></a> for more information.</p>
<p>(<a class="reference external" href="opaque_rendering.py">opaque_rendering.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;IsolatedGalaxy/galaxy0030/galaxy0030&quot;</span><span class="p">)</span>

<span class="c"># We start by building a transfer function, and initializing a camera.</span>

<span class="n">tf</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">ColorTransferFunction</span><span class="p">((</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">22</span><span class="p">))</span>
<span class="n">cam</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">camera</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">tf</span><span class="p">)</span>

<span class="c"># Now let&#39;s add some isocontours, and take a snapshot.</span>

<span class="n">tf</span><span class="o">.</span><span class="n">add_layers</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">col_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">27.5</span><span class="p">,</span><span class="o">-</span><span class="mf">25.5</span><span class="p">],</span> <span class="n">colormap</span> <span class="o">=</span> <span class="s">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v1.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># In this case, the default alphas used (np.logspace(-3,0,Nbins)) does not</span>
<span class="c"># accentuate the outer regions of the galaxy. Let&#39;s start by bringing up the</span>
<span class="c"># alpha values for each contour to go between 0.1 and 1.0</span>

<span class="n">tf</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">tf</span><span class="o">.</span><span class="n">add_layers</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">col_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">27.5</span><span class="p">,</span><span class="o">-</span><span class="mf">25.5</span><span class="p">],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">colormap</span> <span class="o">=</span> <span class="s">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v2.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># Now let&#39;s set the grey_opacity to True.  This should make the inner portions</span>
<span class="c"># start to be obcured</span>

<span class="n">tf</span><span class="o">.</span><span class="n">grey_opacity</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v3.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># That looks pretty good, but let&#39;s start bumping up the opacity.</span>

<span class="n">tf</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">tf</span><span class="o">.</span><span class="n">add_layers</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">col_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">27.5</span><span class="p">,</span><span class="o">-</span><span class="mf">25.5</span><span class="p">],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">10.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float64&#39;</span><span class="p">),</span> <span class="n">colormap</span> <span class="o">=</span> <span class="s">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v4.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># Let&#39;s bump up again to see if we can obscure the inner contour.</span>

<span class="n">tf</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">tf</span><span class="o">.</span><span class="n">add_layers</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">col_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">27.5</span><span class="p">,</span><span class="o">-</span><span class="mf">25.5</span><span class="p">],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">30.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float64&#39;</span><span class="p">),</span> <span class="n">colormap</span> <span class="o">=</span> <span class="s">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v5.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># Now we are losing sight of everything.  Let&#39;s see if we can obscure the next</span>
<span class="c"># layer</span>

<span class="n">tf</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">tf</span><span class="o">.</span><span class="n">add_layers</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">col_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">27.5</span><span class="p">,</span><span class="o">-</span><span class="mf">25.5</span><span class="p">],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">100.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float64&#39;</span><span class="p">),</span> <span class="n">colormap</span> <span class="o">=</span> <span class="s">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v6.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># That is very opaque!  Now lets go back and see what it would look like with</span>
<span class="c"># grey_opacity = False</span>

<span class="n">tf</span><span class="o">.</span><span class="n">grey_opacity</span><span class="o">=</span><span class="bp">False</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v7.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># That looks pretty different, but the main thing is that you can see that the</span>
<span class="c"># inner contours are somewhat visible again.  </span>
</pre></div>
</div>
</div>
<div class="section" id="downsampling-data-for-volume-rendering">
<span id="cookbook-amrkdtree-downsampling"></span><h2>Downsampling Data for Volume Rendering<a class="headerlink" href="#downsampling-data-for-volume-rendering" title="Permalink to this headline">¶</a></h2>
<p>This recipe demonstrates how to downsample data in a simulation to speed up
volume rendering.
See <a class="reference internal" href="../visualizing/volume_rendering.html#volume-rendering"><span>Volume Rendering: Making 3D Photorealistic Isocontoured Images</span></a> for more information.</p>
<p>(<a class="reference external" href="amrkdtree_downsampling.py">amrkdtree_downsampling.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Using AMRKDTree Homogenized Volumes to examine large datasets</span>
<span class="c"># at lower resolution.</span>

<span class="c"># In this example we will show how to use the AMRKDTree to take a simulation</span>
<span class="c"># with 8 levels of refinement and only use levels 0-3 to render the dataset.</span>

<span class="c"># We begin by loading up yt, and importing the AMRKDTree</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">from</span> <span class="nn">yt.utilities.amr_kdtree.api</span> <span class="kn">import</span> <span class="n">AMRKDTree</span>

<span class="c"># Load up a dataset and define the kdtree</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;IsolatedGalaxy/galaxy0030/galaxy0030&#39;</span><span class="p">)</span>
<span class="n">kd</span> <span class="o">=</span> <span class="n">AMRKDTree</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

<span class="c"># Print out specifics of KD Tree</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Total volume of all bricks = </span><span class="si">%i</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">kd</span><span class="o">.</span><span class="n">count_volume</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Total number of cells = </span><span class="si">%i</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">kd</span><span class="o">.</span><span class="n">count_cells</span><span class="p">())</span>

<span class="c"># Define a camera and take an volume rendering.</span>
<span class="n">tf</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">ColorTransferFunction</span><span class="p">((</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">22</span><span class="p">))</span>
<span class="n">cam</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">camera</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span>
                  <span class="n">tf</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="n">kd</span><span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">add_layers</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">col_bounds</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">27.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.5</span><span class="p">],</span> <span class="n">colormap</span><span class="o">=</span><span class="s">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v1.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># This rendering is okay, but lets say I&#39;d like to improve it, and I don&#39;t want</span>
<span class="c"># to spend the time rendering the high resolution data.  What we can do is</span>
<span class="c"># generate a low resolution version of the AMRKDTree and pass that in to the</span>
<span class="c"># camera.  We do this by specifying a maximum refinement level of 6.</span>

<span class="n">kd_low_res</span> <span class="o">=</span> <span class="n">AMRKDTree</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">max_level</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">kd_low_res</span><span class="o">.</span><span class="n">count_volume</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">kd_low_res</span><span class="o">.</span><span class="n">count_cells</span><span class="p">())</span>

<span class="c"># Now we pass this in as the volume to our camera, and render the snapshot</span>
<span class="c"># again.</span>

<span class="n">cam</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">kd_low_res</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v4.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># This operation was substantiall faster.  Now lets modify the low resolution</span>
<span class="c"># rendering until we find something we like.</span>

<span class="n">tf</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">tf</span><span class="o">.</span><span class="n">add_layers</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">col_bounds</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">27.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.5</span><span class="p">],</span>
              <span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float64&#39;</span><span class="p">),</span> <span class="n">colormap</span><span class="o">=</span><span class="s">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v2.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># This looks better.  Now let&#39;s try turning on opacity.</span>

<span class="n">tf</span><span class="o">.</span><span class="n">grey_opacity</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v4.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># That seemed to pick out som interesting structures.  Now let&#39;s bump up the</span>
<span class="c"># opacity.</span>

<span class="n">tf</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">tf</span><span class="o">.</span><span class="n">add_layers</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">col_bounds</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">27.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.5</span><span class="p">],</span>
              <span class="n">alpha</span><span class="o">=</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float64&#39;</span><span class="p">),</span> <span class="n">colormap</span><span class="o">=</span><span class="s">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v3.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># This looks pretty good, now lets go back to the full resolution AMRKDTree</span>

<span class="n">cam</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">kd</span>
<span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;v4.png&quot;</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">6.0</span><span class="p">)</span>

<span class="c"># This looks great!</span>
</pre></div>
</div>
</div>
<div class="section" id="volume-rendering-with-bounding-box-and-overlaid-grids">
<h2>Volume Rendering with Bounding Box and Overlaid Grids<a class="headerlink" href="#volume-rendering-with-bounding-box-and-overlaid-grids" title="Permalink to this headline">¶</a></h2>
<p>This recipe demonstrates how to overplot a bounding box on a volume rendering
as well as overplotting grids representing the level of refinement achieved
in different regions of the code.
See <a class="reference internal" href="../visualizing/volume_rendering.html#volume-rendering"><span>Volume Rendering: Making 3D Photorealistic Isocontoured Images</span></a> for more information.</p>
<p>(<a class="reference external" href="rendering_with_box_and_grids.py">rendering_with_box_and_grids.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c"># Load the dataset.</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;Enzo_64/DD0043/data0043&quot;</span><span class="p">)</span>

<span class="c"># Create a data container (like a sphere or region) that</span>
<span class="c"># represents the entire domain.</span>
<span class="n">ad</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">all_data</span><span class="p">()</span>

<span class="c"># Get the minimum and maximum densities.</span>
<span class="n">mi</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">quantities</span><span class="o">.</span><span class="n">extrema</span><span class="p">(</span><span class="s">&quot;density&quot;</span><span class="p">)</span>

<span class="c"># Create a transfer function to map field values to colors.</span>
<span class="c"># We bump up our minimum to cut out some of the background fluid</span>
<span class="n">tf</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">ColorTransferFunction</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span><span class="o">+</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ma</span><span class="p">)))</span>

<span class="c"># Add three Gaussians, evenly spaced between the min and</span>
<span class="c"># max specified above with widths of 0.02 and using the</span>
<span class="c"># gist_stern colormap.</span>
<span class="n">tf</span><span class="o">.</span><span class="n">add_layers</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s">&quot;gist_stern&quot;</span><span class="p">)</span>

<span class="c"># Choose a center for the render.</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>

<span class="c"># Choose a vector representing the viewing direction.</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>

<span class="c"># Set the width of the image.</span>
<span class="c"># Decreasing or increasing this value</span>
<span class="c"># results in a zoom in or out.</span>
<span class="n">W</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c"># The number of pixels along one side of the image.</span>
<span class="c"># The final image will have Npixel^2 pixels.</span>
<span class="n">Npixels</span> <span class="o">=</span> <span class="mi">512</span>

<span class="c"># Create a camera object.</span>
<span class="c"># This object creates the images and</span>
<span class="c"># can be moved and rotated.</span>
<span class="n">cam</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">camera</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">Npixels</span><span class="p">,</span> <span class="n">tf</span><span class="p">)</span>

<span class="c"># Create a snapshot.</span>
<span class="c"># The return value of this function could also be accepted, modified (or saved</span>
<span class="c"># for later manipulation) and then put written out using write_bitmap.</span>
<span class="c"># clip_ratio applies a maximum to the function, which is set to that value</span>
<span class="c"># times the .std() of the array.</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">_volume_rendered.png&quot;</span> <span class="o">%</span> <span class="n">ds</span><span class="p">,</span> <span class="n">clip_ratio</span><span class="o">=</span><span class="mf">8.0</span><span class="p">)</span>

<span class="c"># Add the domain edges, with an alpha blending of 0.3:</span>
<span class="n">nim</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">draw_domain</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">nim</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">_vr_domain.png&#39;</span> <span class="o">%</span> <span class="n">ds</span><span class="p">)</span>

<span class="c"># Add the grids, colored by the grid level with the algae colormap</span>
<span class="n">nim</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">draw_grids</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">&#39;algae&#39;</span><span class="p">)</span>
<span class="n">nim</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">_vr_grids.png&#39;</span> <span class="o">%</span> <span class="n">ds</span><span class="p">)</span>

<span class="c"># Here we can draw the coordinate vectors on top of the image by processing</span>
<span class="c"># it through the camera. Then save it out.</span>
<span class="n">cam</span><span class="o">.</span><span class="n">draw_coordinate_vectors</span><span class="p">(</span><span class="n">nim</span><span class="p">)</span>
<span class="n">nim</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">_vr_vectors.png&quot;</span> <span class="o">%</span> <span class="n">ds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="volume-rendering-with-annotation">
<h2>Volume Rendering with Annotation<a class="headerlink" href="#volume-rendering-with-annotation" title="Permalink to this headline">¶</a></h2>
<p>This recipe demonstrates how to write the simulation time, show an
axis triad indicating the direction of the coordinate system, and show
the transfer function on a volume rendering.
See <a class="reference internal" href="../visualizing/volume_rendering.html#volume-rendering"><span>Volume Rendering: Making 3D Photorealistic Isocontoured Images</span></a> for more information.</p>
<p>(<a class="reference external" href="vol-annotated.py">vol-annotated.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pylab</span>

<span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">yt.visualization.volume_rendering.api</span> <span class="kn">as</span> <span class="nn">vr</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;maestro_subCh_plt00248&quot;</span><span class="p">)</span>

<span class="n">dd</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">all_data</span><span class="p">()</span>

<span class="c"># field in the dataset we will visualize</span>
<span class="n">field</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;boxlib&#39;</span><span class="p">,</span> <span class="s">&#39;radial_velocity&#39;</span><span class="p">)</span>

<span class="c"># the values we wish to highlight in the rendering.  We&#39;ll put a Gaussian</span>
<span class="c"># centered on these with width sigma        </span>
<span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.e7</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5e6</span><span class="p">,</span> <span class="mf">2.5e6</span><span class="p">,</span> <span class="mf">5.e6</span><span class="p">,</span> <span class="mf">1.e7</span><span class="p">]</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">2.e5</span>
        
<span class="n">mi</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>

<span class="c"># Instantiate the ColorTransferfunction.</span>
<span class="n">tf</span> <span class="o">=</span>  <span class="n">vr</span><span class="o">.</span><span class="n">ColorTransferFunction</span><span class="p">((</span><span class="n">mi</span><span class="p">,</span> <span class="n">ma</span><span class="p">))</span>

<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">sample_colormap</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s">&quot;coolwarm&quot;</span><span class="p">)</span>


<span class="c"># volume rendering requires periodic boundaries.  This dataset has</span>
<span class="c"># solid walls.  We need to hack it for now (this will be fixed in </span>
<span class="c"># a later yt)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">periodicity</span> <span class="o">=</span> <span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>


<span class="c"># Set up the camera parameters: center, looking direction, width, resolution</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="n">W</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">ds</span><span class="o">.</span><span class="n">domain_width</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">720</span>

<span class="c"># +z is &quot;up&quot; for our dataset</span>
<span class="n">north</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>

<span class="c"># Create a camera object</span>
<span class="n">cam</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">transfer_function</span><span class="o">=</span><span class="n">tf</span><span class="p">,</span> <span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span> 
                <span class="n">no_ghost</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">north_vector</span><span class="o">=</span><span class="n">north</span><span class="p">,</span>
                <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="n">log_fields</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">])</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">snapshot</span><span class="p">()</span>

<span class="c"># add an axes triad </span>
<span class="n">cam</span><span class="o">.</span><span class="n">draw_coordinate_vectors</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>

<span class="c"># add the domain box to the image</span>
<span class="n">nim</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">draw_domain</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>

<span class="c"># increase the contrast -- for some reason, the enhance default</span>
<span class="c"># to save_annotated doesn&#39;t do the trick </span>
<span class="n">max_val</span> <span class="o">=</span> <span class="n">im</span><span class="p">[:,:,:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="mf">4.0</span>
<span class="n">nim</span><span class="p">[:,:,:</span><span class="mi">3</span><span class="p">]</span> <span class="o">/=</span> <span class="n">max_val</span>

<span class="c"># we want to write the simulation time on the figure, so create a </span>
<span class="c"># figure and annotate it</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s">&quot;{:.3g} s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">current_time</span><span class="o">.</span><span class="n">d</span><span class="p">)),</span>
           <span class="n">transform</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">)</span>

<span class="c"># tell the camera to use our figure</span>
<span class="n">cam</span><span class="o">.</span><span class="n">_render_figure</span> <span class="o">=</span> <span class="n">f</span>
    
<span class="c"># save annotated -- this added the transfer function values, </span>
<span class="c"># and the clear_fig=False ensures it writes onto our existing figure.</span>
<span class="n">cam</span><span class="o">.</span><span class="n">save_annotated</span><span class="p">(</span><span class="s">&quot;vol_annotated.png&quot;</span><span class="p">,</span> <span class="n">nim</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">145</span><span class="p">,</span> <span class="n">clear_fig</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-streamlines">
<h2>Plotting Streamlines<a class="headerlink" href="#plotting-streamlines" title="Permalink to this headline">¶</a></h2>
<p>This recipe demonstrates how to display streamlines in a simulation.  (Note:
streamlines can also be queried for values!)
See <a class="reference internal" href="../visualizing/streamlines.html#streamlines"><span>Streamlines: Tracking the Trajectories of Tracers in your Data</span></a> for more information.</p>
<p>(<a class="reference external" href="streamlines.py">streamlines.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">pl</span>

<span class="kn">from</span> <span class="nn">yt.visualization.api</span> <span class="kn">import</span> <span class="n">Streamlines</span>
<span class="kn">from</span> <span class="nn">yt.units</span> <span class="kn">import</span> <span class="n">Mpc</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="c"># Load the dataset</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;IsolatedGalaxy/galaxy0030/galaxy0030&#39;</span><span class="p">)</span>

<span class="c"># Define c: the center of the box, N: the number of streamlines, </span>
<span class="c"># scale: the spatial scale of the streamlines relative to the boxsize,</span>
<span class="c"># and then pos: the random positions of the streamlines.</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">domain_center</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">domain_width</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pos_dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">scale</span><span class="o">-</span><span class="n">scale</span><span class="o">/</span><span class="mf">2.</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="n">pos_dx</span>

<span class="c"># Create streamlines of the 3D vector velocity and integrate them through </span>
<span class="c"># the box defined above</span>
<span class="n">streamlines</span> <span class="o">=</span> <span class="n">Streamlines</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="s">&#39;velocity_x&#39;</span><span class="p">,</span> <span class="s">&#39;velocity_y&#39;</span><span class="p">,</span> <span class="s">&#39;velocity_z&#39;</span><span class="p">,</span> 
                          <span class="n">length</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="n">Mpc</span><span class="p">,</span> <span class="n">get_magnitude</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">streamlines</span><span class="o">.</span><span class="n">integrate_through_volume</span><span class="p">()</span>

<span class="c"># Create a 3D plot, trace the streamlines throught the 3D volume of the plot</span>
<span class="n">fig</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">streamlines</span><span class="o">.</span><span class="n">streamlines</span><span class="p">:</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">stream</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">stream</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">stream</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">stream</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c"># Save the plot to disk.</span>
<span class="n">pl</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;streamlines.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-isocontours">
<h2>Plotting Isocontours<a class="headerlink" href="#plotting-isocontours" title="Permalink to this headline">¶</a></h2>
<p>This recipe demonstrates how to extract an isocontour and then plot it in
matplotlib, coloring the surface by a second quantity.
See <a class="reference internal" href="../visualizing/sketchfab.html#surfaces"><span>3D Surfaces and Sketchfab</span></a> for more information.</p>
<p>(<a class="reference external" href="surface_plot.py">surface_plot.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d.art3d</span> <span class="kn">import</span> <span class="n">Poly3DCollection</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c"># Load the dataset</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;IsolatedGalaxy/galaxy0030/galaxy0030&quot;</span><span class="p">)</span>

<span class="c"># Create a sphere object centered on the highest density point in the simulation</span>
<span class="c"># with radius 1 Mpc</span>
<span class="n">sphere</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sphere</span><span class="p">(</span><span class="s">&quot;max&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;Mpc&quot;</span><span class="p">))</span>

<span class="c"># Identify the isodensity surface in this sphere with density = 1e-24 g/cm^3</span>
<span class="n">surface</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">sphere</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">,</span> <span class="mf">1e-24</span><span class="p">)</span>

<span class="c"># Color this isodensity surface according to the log of the temperature field</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">apply_colormap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">surface</span><span class="p">[</span><span class="s">&quot;temperature&quot;</span><span class="p">]),</span> <span class="n">cmap_name</span><span class="o">=</span><span class="s">&quot;hot&quot;</span><span class="p">)</span>

<span class="c"># Create a 3D matplotlib figure for visualizing the surface</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">p3dc</span> <span class="o">=</span> <span class="n">Poly3DCollection</span><span class="p">(</span><span class="n">surface</span><span class="o">.</span><span class="n">triangles</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

<span class="c"># Set the surface colors in the right scaling [0,1]</span>
<span class="n">p3dc</span><span class="o">.</span><span class="n">set_facecolors</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:]</span><span class="o">/</span><span class="mf">255.</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">p3dc</span><span class="p">)</span>

<span class="c"># Let&#39;s keep the axis ratio fixed in all directions by taking the maximum </span>
<span class="c"># extent in one dimension and make it the bounds in all dimensions</span>
<span class="n">max_extent</span> <span class="o">=</span> <span class="p">(</span><span class="n">surface</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">surface</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">centers</span> <span class="o">=</span> <span class="p">(</span><span class="n">surface</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">surface</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">bounds</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">centers</span><span class="p">[:]</span> <span class="o">-</span> <span class="n">max_extent</span><span class="o">/</span><span class="mi">2</span>
<span class="n">bounds</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">centers</span><span class="p">[:]</span> <span class="o">+</span> <span class="n">max_extent</span><span class="o">/</span><span class="mi">2</span>
<span class="n">ax</span><span class="o">.</span><span class="n">auto_scale_xyz</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">,:])</span>

<span class="c"># Save the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">_Surface.png&quot;</span> <span class="o">%</span> <span class="n">ds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-isocontours-and-streamlines">
<h2>Plotting Isocontours and Streamlines<a class="headerlink" href="#plotting-isocontours-and-streamlines" title="Permalink to this headline">¶</a></h2>
<p>This recipe plots both isocontours and streamlines simultaneously.  Note that
this will not include any blending, so streamlines that are occluded by the
surface will still be visible.
See <a class="reference internal" href="../visualizing/streamlines.html#streamlines"><span>Streamlines: Tracking the Trajectories of Tracers in your Data</span></a> and <a class="reference internal" href="../visualizing/sketchfab.html#surfaces"><span>3D Surfaces and Sketchfab</span></a> for more information.</p>
<p>(<a class="reference external" href="streamlines_isocontour.py">streamlines_isocontour.py</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">yt.visualization.api</span> <span class="kn">import</span> <span class="n">Streamlines</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">pl</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d.art3d</span> <span class="kn">import</span> <span class="n">Poly3DCollection</span>

<span class="c"># Load the dataset</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;IsolatedGalaxy/galaxy0030/galaxy0030&quot;</span><span class="p">)</span>

<span class="c"># Define c: the center of the box, N: the number of streamlines,</span>
<span class="c"># scale: the spatial scale of the streamlines relative to the boxsize,</span>
<span class="c"># and then pos: the random positions of the streamlines.</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">arr</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;code_length&#39;</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">quan</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="s">&#39;kpc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">in_units</span><span class="p">(</span><span class="s">&#39;code_length&#39;</span><span class="p">)</span>  <span class="c"># 15 kpc in code units</span>
<span class="n">pos_dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">scale</span><span class="o">-</span><span class="n">scale</span><span class="o">/</span><span class="mf">2.</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="n">pos_dx</span>
 
<span class="c"># Create the streamlines from these positions with the velocity fields as the</span>
<span class="c"># fields to be traced</span>
<span class="n">streamlines</span> <span class="o">=</span> <span class="n">Streamlines</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="s">&#39;velocity_x&#39;</span><span class="p">,</span> <span class="s">&#39;velocity_y&#39;</span><span class="p">,</span> <span class="s">&#39;velocity_z&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span> 
<span class="n">streamlines</span><span class="o">.</span><span class="n">integrate_through_volume</span><span class="p">()</span>

<span class="c"># Create a 3D matplotlib figure for visualizing the streamlines</span>
<span class="n">fig</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span> 
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="c"># Trace the streamlines through the volume of the 3D figure</span>
<span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">streamlines</span><span class="o">.</span><span class="n">streamlines</span><span class="p">:</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">stream</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>

    <span class="c"># Make the colors of each stream vary continuously from blue to red</span>
    <span class="c"># from low-x to high-x of the stream start position (each color is R, G, B)</span>
    <span class="c"># can omit and just set streamline colors to a fixed color</span>
    <span class="n">x_start_pos</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">arr</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;code_length&#39;</span><span class="p">)</span>
    <span class="n">x_start_pos</span> <span class="o">-=</span> <span class="n">ds</span><span class="o">.</span><span class="n">arr</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="s">&#39;code_length&#39;</span><span class="p">)</span>
    <span class="n">x_start_pos</span> <span class="o">/=</span> <span class="n">scale</span> 
    <span class="n">x_start_pos</span> <span class="o">+=</span> <span class="mf">0.5</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_start_pos</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">x_start_pos</span><span class="p">])</span>

    <span class="c"># Plot the stream in 3D</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">stream</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">stream</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">stream</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

<span class="c"># Create a sphere object centered on the highest density point in the simulation</span>
<span class="c"># with radius = 1 Mpc</span>
<span class="n">sphere</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sphere</span><span class="p">(</span><span class="s">&quot;max&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;Mpc&quot;</span><span class="p">))</span>

<span class="c"># Identify the isodensity surface in this sphere with density = 1e-24 g/cm^3</span>
<span class="n">surface</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">sphere</span><span class="p">,</span> <span class="s">&quot;density&quot;</span><span class="p">,</span> <span class="mf">1e-24</span><span class="p">)</span>

<span class="c"># Color this isodensity surface according to the log of the temperature field</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">apply_colormap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">surface</span><span class="p">[</span><span class="s">&quot;temperature&quot;</span><span class="p">]),</span> <span class="n">cmap_name</span><span class="o">=</span><span class="s">&quot;hot&quot;</span><span class="p">)</span>

<span class="c"># Render this surface </span>
<span class="n">p3dc</span> <span class="o">=</span> <span class="n">Poly3DCollection</span><span class="p">(</span><span class="n">surface</span><span class="o">.</span><span class="n">triangles</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:]</span><span class="o">/</span><span class="mf">255.</span>  <span class="c"># scale to [0,1]</span>
<span class="n">colors</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span>            <span class="c"># alpha = 0.3</span>
<span class="n">p3dc</span><span class="o">.</span><span class="n">set_facecolors</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">p3dc</span><span class="p">)</span>

<span class="c"># Save the figure</span>
<span class="n">pl</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;streamlines_isocontour.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
    <div class="footer">
      &copy; Copyright 2013, the yt Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>