<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Halo Finding &mdash; The yt Project 3.2-dev documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.3.4/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.2-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="The yt Project 3.2-dev documentation" href="../../index.html" />
    <link rel="up" title="Halo Analysis" href="halo_analysis.html" />
    <link rel="next" title="Halo Mass Function" href="halo_mass_function.html" />
    <link rel="prev" title="Halo Catalogs" href="halo_catalogs.html" />
    
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-391373-2']);
      _gaq.push(['_setDomainName', 'yt-project.org']);
      _gaq.push(['_setAllowHash', false]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/yt_icon.png">
          The yt Project</a>
        <span class="navbar-text navbar-version pull-left"><b>3.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../help/index.html">How to get help</a></li>
                <li><a href="../../quickstart/index.html">Quickstart notebooks</a></li>
                <li><a href="../../cookbook/index.html">Cookbook</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installing.html">Getting and Installing yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#getting-yt">Getting yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#testing-your-installation">Testing Your Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#switching-between-yt-2-x-and-yt-3-x">Switching between yt-2.x and yt-3.x</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">yt Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/data_inspection.html">Data Inspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/simple_visualization.html">Simple Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/data_objects_and_time_series.html">Data Objects and Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/derived_fields_and_profiles.html">Derived Fields and Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/volume_rendering.html">Volume Rendering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../yt3differences.html">What&#8217;s New and Different in yt 3.0?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../yt3differences.html#updating-to-yt-3-0-from-old-versions-and-going-back">Updating to yt 3.0 from Old Versions (and going back)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../yt3differences.html#converting-old-scripts-to-work-with-yt-3-0">Converting Old Scripts to Work with yt 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../yt3differences.html#cool-new-things">Cool New Things</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../yt3differences.html#api-changes">API Changes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cookbook/index.html">The Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/index.html#getting-the-sample-data">Getting the Sample Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/index.html#example-scripts">Example Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/index.html#example-notebooks">Example Notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../visualizing/index.html">Visualizing Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/plots.html">How to Make Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/callbacks.html">Plot Modifications: Overplotting Contours, Velocities, Particles, and More</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/manual_plotting.html">Using the Manual Plotting Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/volume_rendering.html">Volume Rendering: Making 3D Photorealistic Isocontoured Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/hardware_volume_rendering.html">Hardware Volume Rendering on NVidia Graphics cards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/sketchfab.html">3D Surfaces and Sketchfab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/mapserver.html">Mapserver - A Google-Maps-like Interface to your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/streamlines.html">Streamlines: Tracking the Trajectories of Tracers in your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/colormaps/index.html">Colormaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/writing_fits_images.html">Writing FITS Images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">General Data Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../fields.html">Fields in yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_derived_fields.html">Creating Derived Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../objects.html">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../units/index.html">Symbolic Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filtering.html">Filtering your Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generating_processed_data.html">Generating Processed Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time_series_analysis.html">Time Series Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_computation.html">Parallel Computation With yt</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Topic-Specific Analysis Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="halo_analysis.html">Halo Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="synthetic_observation.html">Synthetic Observation</a></li>
<li class="toctree-l2"><a class="reference internal" href="exporting.html">Exporting to External Radiation Transport Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="two_point_functions.html">Two Point Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="clump_finding.html">Clump Finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="particle_trajectories.html">Particle Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="ellipsoid_analysis.html">Halo Ellipsoid Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examining/index.html">Loading and Examining Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examining/loading_data.html">Loading Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examining/generic_array_data.html">Loading Generic Array Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examining/generic_particle_data.html">Loading Generic Particle Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examining/spherical_data.html">Loading Spherical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examining/low_level_inspection.html">Low-Level Data Inspection: Accessing Raw Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developing/index.html">Developing in yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../developing/intro.html">Getting Involved</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/developing.html">How to Develop yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/building_the_docs.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/debugdrive.html">Debugging yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_datatypes.html">Creating Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_derived_fields.html">Creating Derived Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_derived_quantities.html">Creating Derived Quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_frontend.html">Creating A New Code Frontend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/external_analysis.html">Using yt with External Analysis Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference Materials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/code_support.html">Code Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/command-line.html">Command-Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/api/api.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/configuration.html">Customizing yt: The Configuration and Plugin Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/field_list.html">Field List</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/changelog.html">ChangeLog</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#version-installation">Version &amp; Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#code-errors-and-failures">Code Errors and Failures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#units">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#fields">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#data-objects">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#developing">Developing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../help/index.html">Getting Help</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#don-t-panic-and-don-t-give-up">Don&#8217;t panic and don&#8217;t give up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#update-to-the-latest-version">Update to the latest version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#search-the-documentation-faq-and-mailing-lists">Search the documentation, FAQ, and mailing lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#look-at-the-source-code">Look at the source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#isolate-and-document-your-problem">Isolate and document your problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#go-on-irc-to-ask-a-question">Go on IRC to ask a question</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#ask-the-mailing-list">Ask the mailing list</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#submit-a-bug-report">Submit a bug report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#special-issues">Special Issues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#what-is-yt">What is yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#who-is-yt">Who is yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#history-of-yt">History of yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#how-do-i-contact-yt">How do I contact yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#how-do-i-cite-yt">How do I cite yt?</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Halo Finding</a><ul>
<li><a class="reference internal" href="#hop">HOP</a></li>
<li><a class="reference internal" href="#fof">FOF</a></li>
<li><a class="reference internal" href="#rockstar-halo-finding">Rockstar Halo Finding</a></li>
<li><a class="reference internal" href="#parallel-hop-and-fof">Parallel HOP and FOF</a></li>
<li><a class="reference internal" href="#rockstar-installation">Rockstar Installation</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="halo-finding">
<span id="id1"></span><h1>Halo Finding<a class="headerlink" href="#halo-finding" title="Permalink to this headline">¶</a></h1>
<p>There are three methods of finding particle haloes in yt. The
default method is called HOP, a method described
in <a class="reference external" href="http://adsabs.harvard.edu/abs/1998ApJ...498..137E">Eisenstein and Hut (1998)</a>. A basic
friends-of-friends (e.g. <a class="reference external" href="http://adsabs.harvard.edu/abs/1985ApJS...57..241E">Efstathiou et al. (1985)</a>) halo
finder is also implemented. Finally Rockstar (<a class="reference external" href="http://adsabs.harvard.edu/abs/2011arXiv1110.4372B">Behroozi et a.
(2011)</a>) is
a 6D-phase space halo finder developed by Peter Behroozi that
excels in finding subhalos and substrcture, but does not allow
multiple particle masses.</p>
<div class="section" id="hop">
<span id="id2"></span><h2>HOP<a class="headerlink" href="#hop" title="Permalink to this headline">¶</a></h2>
<p>The version of HOP used in yt is an upgraded version of the
<a class="reference external" href="http://cmb.as.arizona.edu/~eisenste/hop/hop.html">publicly available HOP code</a>. Support
for 64-bit floats and integers has been added, as well as
parallel analysis through spatial decomposition. HOP builds
groups in this fashion:</p>
<ol class="arabic simple">
<li>Estimates the local density at each particle using a
smoothing kernel.</li>
<li>Builds chains of linked particles by &#8216;hopping&#8217; from one
particle to its densest neighbor. A particle which is
its own densest neighbor is the end of the chain.</li>
<li>All chains that share the same densest particle are
grouped together.</li>
<li>Groups are included, linked together, or discarded
depending on the user-supplied over density
threshold parameter. The default is 160.0.</li>
</ol>
<p>Please see the <a class="reference external" href="http://adsabs.harvard.edu/abs/1998ApJ...498..137E">HOP method paper</a> for
full details and the
<a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.halo_finding.halo_objects.HOPHalo.html#yt.analysis_modules.halo_finding.halo_objects.HOPHalo" title="yt.analysis_modules.halo_finding.halo_objects.HOPHalo"><code class="xref py py-class docutils literal"><span class="pre">HOPHalo</span></code></a> and
<a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.halo_finding.halo_objects.Halo.html#yt.analysis_modules.halo_finding.halo_objects.Halo" title="yt.analysis_modules.halo_finding.halo_objects.Halo"><code class="xref py py-class docutils literal"><span class="pre">Halo</span></code></a> classes.</p>
</div>
<div class="section" id="fof">
<span id="id3"></span><h2>FOF<a class="headerlink" href="#fof" title="Permalink to this headline">¶</a></h2>
<p>A basic friends-of-friends halo finder is included.  See the
<a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.halo_finding.halo_objects.FOFHalo.html#yt.analysis_modules.halo_finding.halo_objects.FOFHalo" title="yt.analysis_modules.halo_finding.halo_objects.FOFHalo"><code class="xref py py-class docutils literal"><span class="pre">FOFHalo</span></code></a> and
<a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.halo_finding.halo_objects.Halo.html#yt.analysis_modules.halo_finding.halo_objects.Halo" title="yt.analysis_modules.halo_finding.halo_objects.Halo"><code class="xref py py-class docutils literal"><span class="pre">Halo</span></code></a> classes.</p>
</div>
<div class="section" id="rockstar-halo-finding">
<span id="rockstar"></span><h2>Rockstar Halo Finding<a class="headerlink" href="#rockstar-halo-finding" title="Permalink to this headline">¶</a></h2>
<p>Rockstar uses an adaptive hierarchical refinement of friends-of-friends
groups in six phase-space dimensions and one time dimension, which
allows for robust (grid-independent, shape-independent, and noise-
resilient) tracking of substructure. The code is prepackaged with yt,
but also <a class="reference external" href="https://bitbucket.org/gfcstanford/rockstar">separately available</a>. The lead
developer is Peter Behroozi, and the methods are described in <a class="reference external" href="http://arxiv.org/abs/1110.4372">Behroozi
et al. 2011</a>.
In order to run the Rockstar halo finder in yt, make sure you&#8217;ve
<a class="reference internal" href="#rockstar-installation"><span>installed it so that it can integrate with yt</span></a>.</p>
<p>At the moment, Rockstar does not support multiple particle masses,
instead using a fixed particle mass. This will not affect most dark matter
simulations, but does make it less useful for finding halos from the stellar
mass. In simulations where the highest-resolution particles all have the
same mass (ie: zoom-in grid based simulations), one can set up a particle
filter to select the lowest mass particles and perform the halo finding
only on those.  See the this cookbook recipe for an example:
<a class="reference internal" href="../../cookbook/cosmological_analysis.html#cookbook-rockstar-nested-grid"><span>Running Rockstar to Find Halos on Multi-Resolution-Particle Datasets</span></a>.</p>
<p>To run the Rockstar Halo finding, you must launch python with MPI and
parallelization enabled. While Rockstar itself does not require MPI to run,
the MPI libraries allow yt to distribute particle information across multiple
nodes.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">At the moment, running Rockstar inside of yt on multiple compute nodes
connected by an Infiniband network can be problematic. Therefore, for now
we recommend forcing the use of the non-Infiniband network (e.g. Ethernet)
using this flag: <code class="docutils literal"><span class="pre">--mca</span> <span class="pre">btl</span> <span class="pre">^openib</span></code>.
For example, here is how Rockstar might be called using 24 cores:
<code class="docutils literal"><span class="pre">mpirun</span> <span class="pre">-n</span> <span class="pre">24</span> <span class="pre">--mca</span> <span class="pre">btl</span> <span class="pre">^openib</span> <span class="pre">python</span> <span class="pre">./run_rockstar.py</span> <span class="pre">--parallel</span></code>.</p>
</div>
<p>The script above configures the Halo finder, launches a server process which
disseminates run information and coordinates writer-reader processes.
Afterwards, it launches reader and writer tasks, filling the available MPI
slots, which alternately read particle information and analyze for halo
content.</p>
<p>The RockstarHaloFinder class has these options that can be supplied to the
halo catalog through the <code class="docutils literal"><span class="pre">finder_kwargs</span></code> argument:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">dm_type</span></code>, the index of the dark matter particle. Default is 1.</li>
<li><code class="docutils literal"><span class="pre">outbase</span></code>, This is where the out*list files that Rockstar makes should be
placed. Default is &#8216;rockstar_halos&#8217;.</li>
<li><code class="docutils literal"><span class="pre">num_readers</span></code>, the number of reader tasks (which are idle most of the
time.) Default is 1.</li>
<li><code class="docutils literal"><span class="pre">num_writers</span></code>, the number of writer tasks (which are fed particles and
do most of the analysis). Default is MPI_TASKS-num_readers-1.
If left undefined, the above options are automatically
configured from the number of available MPI tasks.</li>
<li><code class="docutils literal"><span class="pre">force_res</span></code>, the resolution that Rockstar uses for various calculations
and smoothing lengths. This is in units of Mpc/h.
If no value is provided, this parameter is automatically set to
the width of the smallest grid element in the simulation from the
last data snapshot (i.e. the one where time has evolved the
longest) in the time series:
<code class="docutils literal"><span class="pre">ds_last.index.get_smallest_dx()</span> <span class="pre">*</span> <span class="pre">ds_last['Mpch']</span></code>.</li>
<li><code class="docutils literal"><span class="pre">total_particles</span></code>, if supplied, this is a pre-calculated
total number of dark matter
particles present in the simulation. For example, this is useful
when analyzing a series of snapshots where the number of dark
matter particles should not change and this will save some disk
access time. If left unspecified, it will
be calculated automatically. Default: <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><code class="docutils literal"><span class="pre">dm_only</span></code>, if set to <code class="docutils literal"><span class="pre">True</span></code>, it will be assumed that there are
only dark matter particles present in the simulation.
This option does not modify the halos found by Rockstar, however
this option can save disk access time if there are no star particles
(or other non-dark matter particles) in the simulation. Default: <code class="docutils literal"><span class="pre">False</span></code>.</li>
</ul>
<p>Rockstar dumps halo information in a series of text (halo*list and
out*list) and binary (halo*bin) files inside the <code class="docutils literal"><span class="pre">outbase</span></code> directory.
We use the halo list classes to recover the information.</p>
<p>Inside the <code class="docutils literal"><span class="pre">outbase</span></code> directory there is a text file named <code class="docutils literal"><span class="pre">datasets.txt</span></code>
that records the connection between ds names and the Rockstar file names.</p>
<p>For more information, see the
<a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.halo_finding.halo_objects.RockstarHalo.html#yt.analysis_modules.halo_finding.halo_objects.RockstarHalo" title="yt.analysis_modules.halo_finding.halo_objects.RockstarHalo"><code class="xref py py-class docutils literal"><span class="pre">RockstarHalo</span></code></a> and
<a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.halo_finding.halo_objects.Halo.html#yt.analysis_modules.halo_finding.halo_objects.Halo" title="yt.analysis_modules.halo_finding.halo_objects.Halo"><code class="xref py py-class docutils literal"><span class="pre">Halo</span></code></a> classes.</p>
</div>
<div class="section" id="parallel-hop-and-fof">
<span id="id4"></span><h2>Parallel HOP and FOF<a class="headerlink" href="#parallel-hop-and-fof" title="Permalink to this headline">¶</a></h2>
<p>Both the HOP and FoF halo finders can run in parallel using simple
spatial decomposition. In order to run them in parallel it is helpful
to understand how it works. Below in the first plot (i) is a simplified
depiction of three haloes labeled 1,2 and 3:</p>
<a class="reference internal image-reference" href="../../_images/ParallelHaloFinder.png"><img alt="../../_images/ParallelHaloFinder.png" src="../../_images/ParallelHaloFinder.png" style="width: 500px;" /></a>
<p>Halo 3 is twice reflected around the periodic boundary conditions.</p>
<p>In (ii), the volume has been sub-divided into four equal subregions,
A,B,C and D, shown with dotted lines. Notice that halo 2 is now in
two different subregions, C and D, and that halo 3 is now in three,
A, B and D. If the halo finder is run on these four separate subregions,
halo 1 is be identified as a single halo, but haloes 2 and 3 are split
up into multiple haloes, which is incorrect. The solution is to give
each subregion padding to oversample into neighboring regions.</p>
<p>In (iii), subregion C has oversampled into the other three regions,
with the periodic boundary conditions taken into account, shown by
dot-dashed lines. The other subregions oversample in a similar way.</p>
<p>The halo finder is then run on each padded subregion independently
and simultaneously. By oversampling like this, haloes 2 and 3 will
both be enclosed fully in at least one subregion and identified
completely.</p>
<p>Haloes identified with centers of mass inside the padded part of a
subregion are thrown out, eliminating the problem of halo duplication.
The centers for the three haloes are shown with stars. Halo 1 will
belong to subregion A, 2 to C and 3 to B.</p>
<p>To run with parallel halo finding, you must supply a value for
padding in the finder_kwargs argument. The <code class="docutils literal"><span class="pre">padding</span></code> parameter
is in simulation units and defaults to 0.02. This parameter is how
much padding is added to each of the six sides of a subregion.
This value should be 2x-3x larger than the largest expected halo
in the simulation. It is unlikely, of course, that the largest
object in the simulation will be on a subregion boundary, but there
is no way of knowing before the halo finder is run.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">from</span> <span class="nn">yt.analysis_modules.halo_analysis.api</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;data0001&quot;</span><span class="p">)</span>

<span class="n">hc</span> <span class="o">=</span> <span class="n">HaloCatalog</span><span class="p">(</span><span class="n">data_ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">,</span> <span class="n">finder_method</span> <span class="o">=</span> <span class="s">&#39;hop&#39;</span><span class="p">,</span> <span class="n">finder_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;padding&#39;</span><span class="p">:</span><span class="mf">0.02</span><span class="p">})</span>
<span class="c"># --or--</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">HaloCatalog</span><span class="p">(</span><span class="n">data_ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">,</span> <span class="n">finder_method</span> <span class="o">=</span> <span class="s">&#39;fof&#39;</span><span class="p">,</span> <span class="n">finder_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;padding&#39;</span><span class="p">:</span><span class="mf">0.02</span><span class="p">})</span>
</pre></div>
</div>
<p>In general, a little bit of padding goes a long way, and too much
just slows down the analysis and doesn&#8217;t improve the answer (but
doesn&#8217;t change it).  It may be worth your time to run the parallel
halo finder at a few paddings to find the right amount, especially
if you&#8217;re analyzing many similar datasets.</p>
</div>
<div class="section" id="rockstar-installation">
<span id="id5"></span><h2>Rockstar Installation<a class="headerlink" href="#rockstar-installation" title="Permalink to this headline">¶</a></h2>
<p>Because of changes in the Rockstar API over time, yt only currently works with
a slightly older version of Rockstar.  This version of Rockstar has been
slightly patched and modified to run as a library inside of yt. By default it
is not installed with yt, but installation is very easy.  The
<a class="reference internal" href="../../installing.html#install-script"><span>All-in-One Installation Script</span></a> used to install yt from source has a line:
<code class="docutils literal"><span class="pre">INST_ROCKSTAR=0</span></code> that must be changed to <code class="docutils literal"><span class="pre">INST_ROCKSTAR=1</span></code>.  You can
rerun this installer script over the top of an existing installation, and
it will only install components missing from the existing installation.
You can do this as follows.  Put your freshly modified install_script in
the parent directory of the yt installation directory (e.g. the parent of
<code class="docutils literal"><span class="pre">$YT_DEST</span></code>, <code class="docutils literal"><span class="pre">yt-x86_64</span></code>, <code class="docutils literal"><span class="pre">yt-i386</span></code>, etc.), and rerun the installer:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd</span> <span class="nv">$YT_DEST</span>
<span class="nb">cd</span> ..
vi install_script.sh  // or your favorite editor to change <span class="nv">INST_ROCKSTAR</span><span class="o">=</span>1
bash &lt; install_script.sh
</pre></div>
</div>
<p>This will download Rockstar and install it as a library in yt.  You should now
be able to use Rockstar and yt together.</p>
</div>
</div>


    </div>
      
  </div>
</div>
    <div class="footer">
      &copy; Copyright 2013, the yt Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>