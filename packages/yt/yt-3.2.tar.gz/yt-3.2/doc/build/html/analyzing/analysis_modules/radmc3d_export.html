<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Exporting to RADMC-3D &mdash; The yt Project 3.2-dev documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.3.4/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.2-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="The yt Project 3.2-dev documentation" href="../../index.html" />
    <link rel="up" title="Exporting to External Radiation Transport Codes" href="exporting.html" />
    <link rel="next" title="Two Point Functions" href="two_point_functions.html" />
    <link rel="prev" title="Exporting to Sunrise" href="sunrise_export.html" />
    
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-391373-2']);
      _gaq.push(['_setDomainName', 'yt-project.org']);
      _gaq.push(['_setAllowHash', false]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/yt_icon.png">
          The yt Project</a>
        <span class="navbar-text navbar-version pull-left"><b>3.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../help/index.html">How to get help</a></li>
                <li><a href="../../quickstart/index.html">Quickstart notebooks</a></li>
                <li><a href="../../cookbook/index.html">Cookbook</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installing.html">Getting and Installing yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#getting-yt">Getting yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#testing-your-installation">Testing Your Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#switching-between-yt-2-x-and-yt-3-x">Switching between yt-2.x and yt-3.x</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">yt Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/data_inspection.html">Data Inspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/simple_visualization.html">Simple Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/data_objects_and_time_series.html">Data Objects and Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/derived_fields_and_profiles.html">Derived Fields and Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/volume_rendering.html">Volume Rendering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../yt3differences.html">What&#8217;s New and Different in yt 3.0?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../yt3differences.html#updating-to-yt-3-0-from-old-versions-and-going-back">Updating to yt 3.0 from Old Versions (and going back)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../yt3differences.html#converting-old-scripts-to-work-with-yt-3-0">Converting Old Scripts to Work with yt 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../yt3differences.html#cool-new-things">Cool New Things</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../yt3differences.html#api-changes">API Changes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cookbook/index.html">The Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/index.html#getting-the-sample-data">Getting the Sample Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/index.html#example-scripts">Example Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/index.html#example-notebooks">Example Notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../visualizing/index.html">Visualizing Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/plots.html">How to Make Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/callbacks.html">Plot Modifications: Overplotting Contours, Velocities, Particles, and More</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/manual_plotting.html">Using the Manual Plotting Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/volume_rendering.html">Volume Rendering: Making 3D Photorealistic Isocontoured Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/hardware_volume_rendering.html">Hardware Volume Rendering on NVidia Graphics cards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/sketchfab.html">3D Surfaces and Sketchfab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/mapserver.html">Mapserver - A Google-Maps-like Interface to your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/streamlines.html">Streamlines: Tracking the Trajectories of Tracers in your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/colormaps/index.html">Colormaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/writing_fits_images.html">Writing FITS Images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">General Data Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../fields.html">Fields in yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_derived_fields.html">Creating Derived Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../objects.html">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../units/index.html">Symbolic Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filtering.html">Filtering your Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generating_processed_data.html">Generating Processed Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time_series_analysis.html">Time Series Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_computation.html">Parallel Computation With yt</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Topic-Specific Analysis Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="halo_analysis.html">Halo Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="synthetic_observation.html">Synthetic Observation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="exporting.html">Exporting to External Radiation Transport Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="two_point_functions.html">Two Point Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="clump_finding.html">Clump Finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="particle_trajectories.html">Particle Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="ellipsoid_analysis.html">Halo Ellipsoid Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examining/index.html">Loading and Examining Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examining/loading_data.html">Loading Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examining/generic_array_data.html">Loading Generic Array Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examining/generic_particle_data.html">Loading Generic Particle Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examining/spherical_data.html">Loading Spherical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examining/low_level_inspection.html">Low-Level Data Inspection: Accessing Raw Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developing/index.html">Developing in yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../developing/intro.html">Getting Involved</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/developing.html">How to Develop yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/building_the_docs.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/debugdrive.html">Debugging yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_datatypes.html">Creating Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_derived_fields.html">Creating Derived Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_derived_quantities.html">Creating Derived Quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_frontend.html">Creating A New Code Frontend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/external_analysis.html">Using yt with External Analysis Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference Materials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/code_support.html">Code Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/command-line.html">Command-Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/api/api.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/configuration.html">Customizing yt: The Configuration and Plugin Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/field_list.html">Field List</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/changelog.html">ChangeLog</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#version-installation">Version &amp; Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#code-errors-and-failures">Code Errors and Failures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#units">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#fields">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#data-objects">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#developing">Developing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../help/index.html">Getting Help</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#don-t-panic-and-don-t-give-up">Don&#8217;t panic and don&#8217;t give up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#update-to-the-latest-version">Update to the latest version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#search-the-documentation-faq-and-mailing-lists">Search the documentation, FAQ, and mailing lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#look-at-the-source-code">Look at the source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#isolate-and-document-your-problem">Isolate and document your problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#go-on-irc-to-ask-a-question">Go on IRC to ask a question</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#ask-the-mailing-list">Ask the mailing list</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#submit-a-bug-report">Submit a bug report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#special-issues">Special Issues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#what-is-yt">What is yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#who-is-yt">Who is yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#history-of-yt">History of yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#how-do-i-contact-yt">How do I contact yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#how-do-i-cite-yt">How do I cite yt?</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Exporting to RADMC-3D</a><ul>
<li><a class="reference internal" href="#continuum-emission">Continuum Emission</a></li>
<li><a class="reference internal" href="#line-emission">Line Emission</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="exporting-to-radmc-3d">
<span id="radmc3d-export"></span><h1>Exporting to RADMC-3D<a class="headerlink" href="#exporting-to-radmc-3d" title="Permalink to this headline">¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.6.</span></p>
</div>
<div class="figure" id="id1">
<img alt="../../_images/31micron.png" src="../../_images/31micron.png" />
<p class="caption"><span class="caption-text">Above: a sample image showing the continuum dust emission image around a massive protostar
made using RADMC-3D and plotted with pyplot.</span></p>
</div>
<p><a class="reference external" href="http://www.ita.uni-heidelberg.de/~dullemond/software/radmc-3d/">RADMC-3D</a> is a
three-dimensional Monte-Carlo radiative transfer code that is capable of
handling both line and continuum emission. yt comes equipped with a
<a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.radmc3d_export.RadMC3DInterface.RadMC3DWriter.html#yt.analysis_modules.radmc3d_export.RadMC3DInterface.RadMC3DWriter" title="yt.analysis_modules.radmc3d_export.RadMC3DInterface.RadMC3DWriter"><code class="xref py py-class docutils literal"><span class="pre">RadMC3DWriter</span></code></a>
class that exports AMR data to a format that RADMC-3D can read. Currently, only
the ASCII-style data format is supported.
In principle, this allows one to use RADMC-3D to make synthetic observations
from any simulation data format that yt recognizes.</p>
<div class="section" id="continuum-emission">
<h2>Continuum Emission<a class="headerlink" href="#continuum-emission" title="Permalink to this headline">¶</a></h2>
<p>To compute thermal emission intensities, RADMC-3D needs several inputs files that
describe the spatial distribution of the dust and photon sources. To create these
files, first import the RADMC-3D exporter, which is not loaded into your environment
by default:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">yt.analysis_modules.radmc3d_export.api</span> <span class="kn">import</span> <span class="n">RadMC3DWriter</span><span class="p">,</span> <span class="n">RadMC3DSource</span>
</pre></div>
</div>
<p>Next, load up a dataset and instantiate the <a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.radmc3d_export.RadMC3DInterface.RadMC3DWriter.html#yt.analysis_modules.radmc3d_export.RadMC3DInterface.RadMC3DWriter" title="yt.analysis_modules.radmc3d_export.RadMC3DInterface.RadMC3DWriter"><code class="xref py py-class docutils literal"><span class="pre">RadMC3DWriter</span></code></a>.
For this example, we&#8217;ll use the &#8220;StarParticle&#8221; dataset,
available <a class="reference external" href="http://yt-project.org/data/">here</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;StarParticles/plrd01000/&quot;</span><span class="p">)</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">RadMC3DWriter</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
</pre></div>
</div>
<p>The first data file to create is the &#8220;amr_grid.inp&#8221; file, which describes the structure
of the AMR index. To create this file, simply call:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">writer</span><span class="o">.</span><span class="n">write_amr_grid</span><span class="p">()</span>
</pre></div>
</div>
<p>Next, we must give RADMC-3D information about the dust density. To do this, we
define a field that calculates the dust density in each cell. We
assume a constant dust-to-gas mass ratio of 0.01:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dust_to_gas</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="k">def</span> <span class="nf">_DustDensity</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">dust_to_gas</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s">&quot;density&quot;</span><span class="p">]</span>
<span class="n">ds</span><span class="o">.</span><span class="n">add_field</span><span class="p">((</span><span class="s">&quot;gas&quot;</span><span class="p">,</span> <span class="s">&quot;dust_density&quot;</span><span class="p">),</span> <span class="n">function</span><span class="o">=</span><span class="n">_DustDensity</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;g/cm**3&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We save this information into a file called &#8220;dust_density.inp&#8221;.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">writer</span><span class="o">.</span><span class="n">write_dust_file</span><span class="p">((</span><span class="s">&quot;gas&quot;</span><span class="p">,</span> <span class="s">&quot;dust_density&quot;</span><span class="p">),</span> <span class="s">&quot;dust_density.inp&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, we must give RADMC-3D information about any stellar sources that are
present. To do this, we have provided the
<code class="xref py py-class docutils literal"><span class="pre">RadMC3DSource</span></code>
class. For this example, we place a single source with temperature 5780 K
at the center of the domain:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">radius_cm</span> <span class="o">=</span> <span class="mf">6.96e10</span>
<span class="n">mass_g</span> <span class="o">=</span> <span class="mf">1.989e33</span>
<span class="n">position_cm</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">temperature_K</span> <span class="o">=</span> <span class="mf">5780.0</span>
<span class="n">star</span> <span class="o">=</span> <span class="n">RadMC3DSource</span><span class="p">(</span><span class="n">radius_cm</span><span class="p">,</span> <span class="n">mass_g</span><span class="p">,</span> <span class="n">position_cm</span><span class="p">,</span> <span class="n">temperature_K</span><span class="p">)</span>

<span class="n">sources_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">star</span><span class="p">]</span>
<span class="n">wavelengths_micron</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">writer</span><span class="o">.</span><span class="n">write_source_files</span><span class="p">(</span><span class="n">sources_list</span><span class="p">,</span> <span class="n">wavelengths_micron</span><span class="p">)</span>
</pre></div>
</div>
<p>The last line creates the files &#8220;stars.inp&#8221; and &#8220;wavelength_micron.inp&#8221;,
which describe the locations and spectra of the stellar sources as well
as the wavelengths RADMC-3D will use in it&#8217;s calculations.</p>
<p>If everything goes correctly, after executing the above code, you should have
the files &#8220;amr_grid.inp&#8221;, &#8220;dust_density.inp&#8221;, &#8220;stars.inp&#8221;, and &#8220;wavelength_micron.inp&#8221;
sitting in your working directory. RADMC-3D needs a few more configuration files to
compute the thermal dust emission. In particular, you need an opacity file, like the
&#8220;dustkappa_silicate.inp&#8221; file included in RADMC-3D, a main &#8220;radmc3d.inp&#8221; file that sets
some runtime parameters, and a &#8220;dustopac.inp&#8221; that describes the assumed composition of the dust.
yt cannot make these files for you; in the example that follows, we used a
&#8220;radmc3d.inp&#8221; file that looked like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nphot</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="n">nphot_scat</span> <span class="o">=</span> <span class="mi">1000000</span>
</pre></div>
</div>
<p>which basically tells RADMC-3D to use 1,000,000 photon packets instead of the default 100,000. The
&#8220;dustopac.inp&#8221; file looked like:</p>
<div class="highlight-python"><div class="highlight"><pre>2
1
-----------------------------
1
0
silicate
-----------------------------
</pre></div>
</div>
<p>To get RADMC-3D to compute the dust temperature, run the command:</p>
<div class="highlight-python"><div class="highlight"><pre>./radmc3D mctherm
</pre></div>
</div>
<p>in the directory that contains your &#8220;amr_grid.inp&#8221;, &#8220;dust_density.inp&#8221;, &#8220;stars.inp&#8221;, &#8220;wavelength_micron.inp&#8221;,
&#8220;radmc3d.inp&#8221;, &#8220;dustkappa_silicate.inp&#8221;, and &#8220;dustopac.inp&#8221; files. If everything goes correctly, you should
get a &#8220;dust_temperature.dat&#8221; file in your working directory. Once that file is generated, you can use
RADMC-3D to generate SEDs, images, and so forth. For example, to create an image at 31 microns, do the command:</p>
<div class="highlight-python"><div class="highlight"><pre>./radmc3d image lambda 31 sizeau 30000 npix 800
</pre></div>
</div>
<p>which should create a file called &#8220;image.out&#8221;. You can view this image using pyplot or whatever other
plotting package you want. To facilitate this, we provide helper functions
that parse the image.out file, returning a header dictionary with some useful metadata
and an np.array containing the image values. To plot this image in pyplot, you could do something like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">yt.analysis_modules.radmc3d_export.api</span> <span class="kn">import</span> <span class="n">read_radmc3d_image</span>
<span class="n">header</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="n">read_radmc3d_image</span><span class="p">(</span><span class="s">&quot;image.out&quot;</span><span class="p">)</span>

<span class="n">Nx</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="s">&#39;Nx&#39;</span><span class="p">]</span>
<span class="n">Ny</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="s">&#39;Ny&#39;</span><span class="p">]</span>

<span class="n">x_hi</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">header</span><span class="p">[</span><span class="s">&quot;pixel_size_cm_x&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">Nx</span>
<span class="n">x_lo</span> <span class="o">=</span> <span class="o">-</span><span class="n">x_hi</span>
<span class="n">y_hi</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">header</span><span class="p">[</span><span class="s">&quot;pixel_size_cm_y&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">Ny</span>
<span class="n">y_lo</span> <span class="o">=</span> <span class="o">-</span><span class="n">y_hi</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_lo</span><span class="p">,</span> <span class="n">x_hi</span><span class="p">,</span> <span class="n">Nx</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_lo</span><span class="p">,</span> <span class="n">y_hi</span><span class="p">,</span> <span class="n">Ny</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">image</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s">&#39;hot&#39;</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">((</span><span class="n">x_lo</span><span class="p">,</span> <span class="n">x_hi</span><span class="p">,</span> <span class="n">y_lo</span><span class="p">,</span> <span class="n">y_hi</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">r&quot;$x$ (cm)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">r&quot;$y$ (cm)&quot;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">r&quot;Log Intensity (erg cm$^{-2}$ s$^{-1}$ Hz$^{-1}$ ster$^{-1}$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;dust_continuum.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting image should look like:</p>
<img alt="../../_images/dust_continuum.png" src="../../_images/dust_continuum.png" />
<p>This barely scratches the surface of what you can do with RADMC-3D. Our goal here is
just to describe how to use yt to export the data it knows about (densities, stellar
sources, etc.) into a format that RADMC-3D can recognize.</p>
</div>
<div class="section" id="line-emission">
<h2>Line Emission<a class="headerlink" href="#line-emission" title="Permalink to this headline">¶</a></h2>
<p>The file format required for line emission is slightly different. The
following script will generate two files, one called &#8220;numderdens_co.inp&#8221;,
which contains the number density of CO molecules for every cell in the index,
and another called &#8220;gas-velocity.inp&#8221;, which is useful if you want to include
doppler broadening.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">from</span> <span class="nn">yt.analysis_modules.radmc3d_export.api</span> <span class="kn">import</span> <span class="n">RadMC3DWriter</span>

<span class="n">x_co</span> <span class="o">=</span> <span class="mf">1.0e-4</span>
<span class="n">mu_h</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">YTQuantity</span><span class="p">(</span><span class="mf">2.34e-24</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_NumberDensityCO</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x_co</span><span class="o">/</span><span class="n">mu_h</span><span class="p">)</span><span class="o">*</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;density&quot;</span><span class="p">]</span>
<span class="n">yt</span><span class="o">.</span><span class="n">add_field</span><span class="p">((</span><span class="s">&quot;gas&quot;</span><span class="p">,</span> <span class="s">&quot;number_density_CO&quot;</span><span class="p">),</span> <span class="n">function</span><span class="o">=</span><span class="n">_NumberDensityCO</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;cm**-3&quot;</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;IsolatedGalaxy/galaxy0030/galaxy0030&quot;</span><span class="p">)</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">RadMC3DWriter</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

<span class="n">writer</span><span class="o">.</span><span class="n">write_amr_grid</span><span class="p">()</span>
<span class="n">writer</span><span class="o">.</span><span class="n">write_line_file</span><span class="p">((</span><span class="s">&quot;gas&quot;</span><span class="p">,</span> <span class="s">&quot;number_density_CO&quot;</span><span class="p">),</span> <span class="s">&quot;numberdens_co.inp&quot;</span><span class="p">)</span>
<span class="n">velocity_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;velocity_x&quot;</span><span class="p">,</span> <span class="s">&quot;velocity_y&quot;</span><span class="p">,</span> <span class="s">&quot;velocity_z&quot;</span><span class="p">]</span>
<span class="n">writer</span><span class="o">.</span><span class="n">write_line_file</span><span class="p">(</span><span class="n">velocity_fields</span><span class="p">,</span> <span class="s">&quot;gas_velocity.inp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
    <div class="footer">
      &copy; Copyright 2013, the yt Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>