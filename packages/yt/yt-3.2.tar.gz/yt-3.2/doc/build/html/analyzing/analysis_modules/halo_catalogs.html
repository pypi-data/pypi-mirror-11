<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Halo Catalogs &mdash; The yt Project 3.2-dev documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.3.4/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.2-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="The yt Project 3.2-dev documentation" href="../../index.html" />
    <link rel="up" title="Halo Analysis" href="halo_analysis.html" />
    <link rel="next" title="Halo Finding" href="halo_finders.html" />
    <link rel="prev" title="Getting up to Speed with Halo Analysis in yt-3.0" href="halo_transition.html" />
    
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-391373-2']);
      _gaq.push(['_setDomainName', 'yt-project.org']);
      _gaq.push(['_setAllowHash', false]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/yt_icon.png">
          The yt Project</a>
        <span class="navbar-text navbar-version pull-left"><b>3.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../help/index.html">How to get help</a></li>
                <li><a href="../../quickstart/index.html">Quickstart notebooks</a></li>
                <li><a href="../../cookbook/index.html">Cookbook</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installing.html">Getting and Installing yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#getting-yt">Getting yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#testing-your-installation">Testing Your Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#switching-between-yt-2-x-and-yt-3-x">Switching between yt-2.x and yt-3.x</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">yt Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/data_inspection.html">Data Inspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/simple_visualization.html">Simple Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/data_objects_and_time_series.html">Data Objects and Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/derived_fields_and_profiles.html">Derived Fields and Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/volume_rendering.html">Volume Rendering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../yt3differences.html">What&#8217;s New and Different in yt 3.0?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../yt3differences.html#updating-to-yt-3-0-from-old-versions-and-going-back">Updating to yt 3.0 from Old Versions (and going back)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../yt3differences.html#converting-old-scripts-to-work-with-yt-3-0">Converting Old Scripts to Work with yt 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../yt3differences.html#cool-new-things">Cool New Things</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../yt3differences.html#api-changes">API Changes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cookbook/index.html">The Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/index.html#getting-the-sample-data">Getting the Sample Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/index.html#example-scripts">Example Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/index.html#example-notebooks">Example Notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../visualizing/index.html">Visualizing Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/plots.html">How to Make Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/callbacks.html">Plot Modifications: Overplotting Contours, Velocities, Particles, and More</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/manual_plotting.html">Using the Manual Plotting Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/volume_rendering.html">Volume Rendering: Making 3D Photorealistic Isocontoured Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/hardware_volume_rendering.html">Hardware Volume Rendering on NVidia Graphics cards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/sketchfab.html">3D Surfaces and Sketchfab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/mapserver.html">Mapserver - A Google-Maps-like Interface to your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/streamlines.html">Streamlines: Tracking the Trajectories of Tracers in your Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/colormaps/index.html">Colormaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualizing/writing_fits_images.html">Writing FITS Images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">General Data Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../fields.html">Fields in yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_derived_fields.html">Creating Derived Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../objects.html">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../units/index.html">Symbolic Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filtering.html">Filtering your Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generating_processed_data.html">Generating Processed Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time_series_analysis.html">Time Series Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_computation.html">Parallel Computation With yt</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Topic-Specific Analysis Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="halo_analysis.html">Halo Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="synthetic_observation.html">Synthetic Observation</a></li>
<li class="toctree-l2"><a class="reference internal" href="exporting.html">Exporting to External Radiation Transport Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="two_point_functions.html">Two Point Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="clump_finding.html">Clump Finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="particle_trajectories.html">Particle Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="ellipsoid_analysis.html">Halo Ellipsoid Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examining/index.html">Loading and Examining Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examining/loading_data.html">Loading Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examining/generic_array_data.html">Loading Generic Array Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examining/generic_particle_data.html">Loading Generic Particle Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examining/spherical_data.html">Loading Spherical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examining/low_level_inspection.html">Low-Level Data Inspection: Accessing Raw Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developing/index.html">Developing in yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../developing/intro.html">Getting Involved</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/developing.html">How to Develop yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/building_the_docs.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/debugdrive.html">Debugging yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_datatypes.html">Creating Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_derived_fields.html">Creating Derived Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_derived_quantities.html">Creating Derived Quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/creating_frontend.html">Creating A New Code Frontend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developing/external_analysis.html">Using yt with External Analysis Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference Materials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/code_support.html">Code Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/command-line.html">Command-Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/api/api.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/configuration.html">Customizing yt: The Configuration and Plugin Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/field_list.html">Field List</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/changelog.html">ChangeLog</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#version-installation">Version &amp; Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#code-errors-and-failures">Code Errors and Failures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#units">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#fields">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#data-objects">Data Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#developing">Developing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/index.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../help/index.html">Getting Help</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#don-t-panic-and-don-t-give-up">Don&#8217;t panic and don&#8217;t give up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#update-to-the-latest-version">Update to the latest version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#search-the-documentation-faq-and-mailing-lists">Search the documentation, FAQ, and mailing lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#look-at-the-source-code">Look at the source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#isolate-and-document-your-problem">Isolate and document your problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#go-on-irc-to-ask-a-question">Go on IRC to ask a question</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#ask-the-mailing-list">Ask the mailing list</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#submit-a-bug-report">Submit a bug report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../help/index.html#special-issues">Special Issues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About yt</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#what-is-yt">What is yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#who-is-yt">Who is yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#history-of-yt">History of yt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#how-do-i-contact-yt">How do I contact yt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/index.html#how-do-i-cite-yt">How do I cite yt?</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Halo Catalogs</a><ul>
<li><a class="reference internal" href="#creating-halo-catalogs">Creating Halo Catalogs</a></li>
<li><a class="reference internal" href="#analysis-using-halo-catalogs">Analysis Using Halo Catalogs</a><ul>
<li><a class="reference internal" href="#filters">Filters</a></li>
<li><a class="reference internal" href="#quantities">Quantities</a></li>
<li><a class="reference internal" href="#callbacks">Callbacks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-analysis">Running Analysis</a></li>
<li><a class="reference internal" href="#saving-and-reloading-halo-catalogs">Saving and Reloading Halo Catalogs</a></li>
<li><a class="reference internal" href="#worked-example-of-halo-catalog-in-action">Worked Example of Halo Catalog in Action</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="halo-catalogs">
<span id="halo-catalog"></span><h1>Halo Catalogs<a class="headerlink" href="#halo-catalogs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="creating-halo-catalogs">
<h2>Creating Halo Catalogs<a class="headerlink" href="#creating-halo-catalogs" title="Permalink to this headline">¶</a></h2>
<p>In yt 3.0, operations relating to the analysis of halos (halo finding,
merger tree creation, and individual halo analysis) are all brought
together into a single framework. This framework is substantially
different from the halo analysis machinery available in yt-2.x and is
entirely backward incompatible.
For a direct translation of various halo analysis tasks using yt-2.x
to yt-3.0 please see <a class="reference internal" href="halo_transition.html#halo-transition"><span>Getting up to Speed with Halo Analysis in yt-3.0</span></a>.</p>
<p>A catalog of halos can be created from any initial dataset given to halo
catalog through data_ds. These halos can be found using friends-of-friends,
HOP, and Rockstar. The finder_method keyword dictates which halo finder to
use. The available arguments are <a class="reference internal" href="halo_finders.html#fof"><span>FOF</span></a>, <a class="reference internal" href="halo_finders.html#hop"><span>HOP</span></a>, and <a class="reference internal" href="halo_finders.html#rockstar"><span>Rockstar Halo Finding</span></a>.
For more details on the relative differences between these halo finders see
<a class="reference internal" href="halo_finders.html#halo-finding"><span>Halo Finding</span></a>.</p>
<p>The class which holds all of the halo information is the
<a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog.html#yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog" title="yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog"><code class="xref py py-class docutils literal"><span class="pre">HaloCatalog</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">yt</span>
<span class="kn">from</span> <span class="nn">yt.analysis_modules.halo_analysis.api</span> <span class="kn">import</span> <span class="n">HaloCatalog</span>

<span class="n">data_ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;Enzo_64/RD0006/RedshiftOutput0006&#39;</span><span class="p">)</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">HaloCatalog</span><span class="p">(</span><span class="n">data_ds</span><span class="o">=</span><span class="n">data_ds</span><span class="p">,</span> <span class="n">finder_method</span><span class="o">=</span><span class="s">&#39;hop&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A halo catalog may also be created from already run rockstar outputs.
This method is not implemented for previously run friends-of-friends or
HOP finders. Even though rockstar creates one file per processor,
specifying any one file allows the full catalog to be loaded. Here we
only specify the file output by the processor with ID 0. Note that the
argument for supplying a rockstar output is <cite>halos_ds</cite>, not <cite>data_ds</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">halos_ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s">&#39;rockstar_halos/halos_0.0.bin&#39;</span><span class="p">)</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">HaloCatalog</span><span class="p">(</span><span class="n">halos_ds</span><span class="o">=</span><span class="n">halos_ds</span><span class="p">)</span>
</pre></div>
</div>
<p>Although supplying only the binary output of the rockstar halo finder
is sufficient for creating a halo catalog, it is not possible to find
any new information about the identified halos. To associate the halos
with the dataset from which they were found, supply arguments to both
halos_ds and data_ds.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">halos_ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s">&#39;rockstar_halos/halos_0.0.bin&#39;</span><span class="p">)</span>
<span class="n">data_ds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;Enzo_64/RD0006/RedshiftOutput0006&#39;</span><span class="p">)</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">HaloCatalog</span><span class="p">(</span><span class="n">data_ds</span><span class="o">=</span><span class="n">data_ds</span><span class="p">,</span> <span class="n">halos_ds</span><span class="o">=</span><span class="n">halos_ds</span><span class="p">)</span>
</pre></div>
</div>
<p>A data object can also be supplied via the keyword <code class="docutils literal"><span class="pre">data_source</span></code>,
associated with either dataset, to control the spatial region in
which halo analysis will be performed.</p>
</div>
<div class="section" id="analysis-using-halo-catalogs">
<h2>Analysis Using Halo Catalogs<a class="headerlink" href="#analysis-using-halo-catalogs" title="Permalink to this headline">¶</a></h2>
<p>Analysis is done by adding actions to the
<a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog.html#yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog" title="yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog"><code class="xref py py-class docutils literal"><span class="pre">HaloCatalog</span></code></a>.
Each action is represented by a callback function that will be run on each halo.
There are three types of actions:</p>
<ul class="simple">
<li>Filters</li>
<li>Quantities</li>
<li>Callbacks</li>
</ul>
<p>A list of all available filters, quantities, and callbacks can be found in
<a class="reference internal" href="../../reference/api/api.html#halo-analysis-ref"><span>Halo Analysis</span></a>.
All interaction with this analysis can be performed by importing from
halo_analysis.</p>
<div class="section" id="filters">
<h3>Filters<a class="headerlink" href="#filters" title="Permalink to this headline">¶</a></h3>
<p>A filter is a function that returns True or False. If the return value
is True, any further queued analysis will proceed and the halo in
question will be added to the final catalog. If the return value False,
further analysis will not be performed and the halo will not be included
in the final catalog.</p>
<p>An example of adding a filter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">hc</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s">&#39;quantity_value&#39;</span><span class="p">,</span> <span class="s">&#39;particle_mass&#39;</span><span class="p">,</span> <span class="s">&#39;&gt;&#39;</span><span class="p">,</span> <span class="mf">1E13</span><span class="p">,</span> <span class="s">&#39;Msun&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Currently quantity_value is the only available filter, but more can be
added by the user by defining a function that accepts a halo object as
the first argument and then adding it as an available filter. If you
think that your filter may be of use to the general community, you can
add it to <code class="docutils literal"><span class="pre">yt/analysis_modules/halo_analysis/halo_filters.py</span></code> and issue a
pull request.</p>
<p>An example of defining your own filter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_filter_function</span><span class="p">(</span><span class="n">halo</span><span class="p">):</span>

    <span class="c"># Define condition for filter</span>
    <span class="n">filter_value</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="c"># Return a boolean value</span>
    <span class="k">return</span> <span class="n">filter_value</span>

<span class="c"># Add your filter to the filter registry</span>
<span class="n">add_filter</span><span class="p">(</span><span class="s">&quot;my_filter&quot;</span><span class="p">,</span> <span class="n">my_filter_function</span><span class="p">)</span>

<span class="c"># ... Later on in your script</span>
<span class="n">hc</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s">&quot;my_filter&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="quantities">
<h3>Quantities<a class="headerlink" href="#quantities" title="Permalink to this headline">¶</a></h3>
<p>A quantity is a call back that returns a value or values. The return values
are stored within the halo object in a dictionary called “quantities.” At
the end of the analysis, all of these quantities will be written to disk as
the final form of the generated halo catalog.</p>
<p>Quantities may be available in the initial fields found in the halo catalog,
or calculated from a function after supplying a definition. An example
definition of center of mass is shown below. Currently available quantities
are center_of_mass and bulk_velocity. Their definitions are available in
<code class="docutils literal"><span class="pre">yt/analysis_modules/halo_analysis/halo_quantities.py</span></code>. If you think that
your quantity may be of use to the general community, add it to
<code class="docutils literal"><span class="pre">halo_quantities.py</span></code> and issue a pull request.  Default halo quantities are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">particle_identifier</span></code> &#8211; Halo ID (e.g. 0 to N)</li>
<li><code class="docutils literal"><span class="pre">particle_mass</span></code> &#8211; Mass of halo</li>
<li><code class="docutils literal"><span class="pre">particle_position_x</span></code> &#8211; Location of halo</li>
<li><code class="docutils literal"><span class="pre">particle_position_y</span></code> &#8211; Location of halo</li>
<li><code class="docutils literal"><span class="pre">particle_position_z</span></code> &#8211; Location of halo</li>
<li><code class="docutils literal"><span class="pre">virial_radius</span></code> &#8211; Virial radius of halo</li>
</ul>
<p>An example of adding a quantity:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">hc</span><span class="o">.</span><span class="n">add_quantity</span><span class="p">(</span><span class="s">&#39;center_of_mass&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>An example of defining your own quantity:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_quantity_function</span><span class="p">(</span><span class="n">halo</span><span class="p">):</span>
    <span class="c"># Define quantity to return</span>
    <span class="n">quantity</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">return</span> <span class="n">quantity</span>

<span class="c"># Add your filter to the filter registry</span>
<span class="n">add_quantity</span><span class="p">(</span><span class="s">&#39;my_quantity&#39;</span><span class="p">,</span> <span class="n">my_quantity_function</span><span class="p">)</span>


<span class="c"># ... Later on in your script</span>
<span class="n">hc</span><span class="o">.</span><span class="n">add_quantity</span><span class="p">(</span><span class="s">&quot;my_quantity&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This quantity will then be accessible for functions called later via the
<em>quantities</em> dictionary that is associated with the halo object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_new_function</span><span class="p">(</span><span class="n">halo</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">halo</span><span class="o">.</span><span class="n">quantities</span><span class="p">[</span><span class="s">&quot;my_quantity&quot;</span><span class="p">]</span>
<span class="n">add_callback</span><span class="p">(</span><span class="s">&quot;print_quantity&quot;</span><span class="p">,</span> <span class="n">my_new_function</span><span class="p">)</span>

<span class="c"># ... Anywhere after &quot;my_quantity&quot; has been called</span>
<span class="n">hc</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="s">&quot;print_quantity&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="callbacks">
<h3>Callbacks<a class="headerlink" href="#callbacks" title="Permalink to this headline">¶</a></h3>
<p>A callback is actually the super class for quantities and filters and
is a general purpose function that does something, anything, to a Halo
object. This can include hanging new attributes off the Halo object,
performing analysis and writing to disk, etc. A callback does not return
anything.</p>
<p>An example of using a pre-defined callback where we create a sphere for
each halo with a radius that is twice the saved <code class="docutils literal"><span class="pre">radius</span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">hc</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="s">&quot;sphere&quot;</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Currently available callbacks are located in
<code class="docutils literal"><span class="pre">yt/analysis_modules/halo_analysis/halo_callbacks.py</span></code>.  New callbacks may
be added by using the syntax shown below. If you think that your
callback may be of use to the general community, add it to
halo_callbacks.py and issue a pull request.</p>
<p>An example of defining your own callback:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_callback_function</span><span class="p">(</span><span class="n">halo</span><span class="p">):</span>
    <span class="c"># Perform some callback actions here</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">halo</span><span class="o">.</span><span class="n">x_val</span> <span class="o">=</span> <span class="n">x</span>

<span class="c"># Add the callback to the callback registry</span>
<span class="n">add_callback</span><span class="p">(</span><span class="s">&#39;my_callback&#39;</span><span class="p">,</span> <span class="n">my_callback_function</span><span class="p">)</span>


<span class="c"># ...  Later on in your script</span>
<span class="n">hc</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="s">&quot;my_callback&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-analysis">
<h2>Running Analysis<a class="headerlink" href="#running-analysis" title="Permalink to this headline">¶</a></h2>
<p>After all callbacks, quantities, and filters have been added, the
analysis begins with a call to HaloCatalog.create.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">hc</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
</pre></div>
</div>
<p>The save_halos keyword determines whether the actual Halo objects
are saved after analysis on them has completed or whether just the
contents of their quantities dicts will be retained for creating the
final catalog. The looping over halos uses a call to parallel_objects
allowing the user to control how many processors work on each halo.
The final catalog is written to disk in the output directory given
when the
<a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog.html#yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog" title="yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog"><code class="xref py py-class docutils literal"><span class="pre">HaloCatalog</span></code></a>
object was created.</p>
<p>All callbacks, quantities, and filters are stored in an actions list,
meaning that they are executed in the same order in which they were added.
This enables the use of simple, reusable, single action callbacks that
depend on each other. This also prevents unecessary computation by allowing
the user to add filters at multiple stages to skip remaining analysis if it
is not warranted.</p>
</div>
<div class="section" id="saving-and-reloading-halo-catalogs">
<h2>Saving and Reloading Halo Catalogs<a class="headerlink" href="#saving-and-reloading-halo-catalogs" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog.html#yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog" title="yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog"><code class="xref py py-class docutils literal"><span class="pre">HaloCatalog</span></code></a>
saved to disk can be reloaded as a yt dataset with the
standard call to load. Any side data, such as profiles, can be reloaded
with a <code class="docutils literal"><span class="pre">load_profiles</span></code> callback and a call to
<a class="reference internal" href="../../reference/api/generated/yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog.load.html#yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog.load" title="yt.analysis_modules.halo_analysis.halo_catalog.HaloCatalog.load"><code class="xref py py-func docutils literal"><span class="pre">load()</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">hds</span> <span class="o">=</span> <span class="n">yt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;halo_catalogs/catalog_0046/catalog_0046.0.h5&quot;</span><span class="p">)</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">HaloCatalog</span><span class="p">(</span><span class="n">halos_ds</span><span class="o">=</span><span class="n">hds</span><span class="p">,</span>
                 <span class="n">output_dir</span><span class="o">=</span><span class="s">&quot;halo_catalogs/catalog_0046&quot;</span><span class="p">)</span>
<span class="n">hc</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="s">&quot;load_profiles&quot;</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s">&quot;profiles&quot;</span><span class="p">,</span>
                <span class="n">filename</span><span class="o">=</span><span class="s">&quot;virial_profiles&quot;</span><span class="p">)</span>
<span class="n">hc</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="worked-example-of-halo-catalog-in-action">
<h2>Worked Example of Halo Catalog in Action<a class="headerlink" href="#worked-example-of-halo-catalog-in-action" title="Permalink to this headline">¶</a></h2>
<p>For a full example of how to use these methods together see
<a class="reference internal" href="../../cookbook/halo_analysis_example.html#halo-analysis-example"><span>Worked Example of Halo Analysis</span></a>.</p>
</div>
</div>


    </div>
      
  </div>
</div>
    <div class="footer">
      &copy; Copyright 2013, the yt Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>