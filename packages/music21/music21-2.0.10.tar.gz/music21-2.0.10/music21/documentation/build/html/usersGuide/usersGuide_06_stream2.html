<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>User’s Guide, Chapter 6: Streams (II): Hierarchies, Recursion, and Flattening &mdash; music21 Documentation</title>
    
    <link rel="stylesheet" href="../_static/m21.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="top" title="music21 Documentation" href="../index.html" />
    <link rel="up" title="Users Guide" href="index.html" />
    <link rel="next" title="User’s Guide, Chapter 7: Chords" href="usersGuide_07_chords.html" />
    <link rel="prev" title="User’s Guide, Chapter 5: Lists of Lists, Functions, and Recursion" href="usersGuide_05_listsOfLists.html" /><link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'>
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="usersGuide_07_chords.html" title="User’s Guide, Chapter 7: Chords"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="usersGuide_05_listsOfLists.html" title="User’s Guide, Chapter 5: Lists of Lists, Functions, and Recursion"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">music21</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Users Guide</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="usersGuide_05_listsOfLists.html"
                        title="previous chapter">User&#8217;s Guide, Chapter 5: Lists of Lists, Functions, and Recursion</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="usersGuide_07_chords.html"
                        title="next chapter">User&#8217;s Guide, Chapter 7: Chords</a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">User&#8217;s Guide, Chapter 6: Streams (II): Hierarchies, Recursion, and Flattening</a><ul>
<li><a class="reference internal" href="#accessing-scores-parts-measures-and-notes">Accessing Scores, Parts, Measures, and Notes</a></li>
<li><a class="reference internal" href="#recursion-in-streams">Recursion in Streams</a></li>
<li><a class="reference internal" href="#flattening-a-stream">Flattening a Stream</a></li>
</ul>
</li>
</ul>

<h3><a href="../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About Music21</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Users Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="usersGuide_99_Table_of_Contents.html">User&#8217;s Guide, Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_00_introduction.html">User&#8217;s Guide: Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_01_installing.html">User&#8217;s Guide, Chapter 1: Installing and Getting Started with <code class="docutils literal"><span class="pre">music21</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_02_notes.html">User&#8217;s Guide, Chapter 2: Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_03_pitches.html">User&#8217;s Guide, Chapter 3: Pitches, Durations, and Notes again</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_04_stream1.html">User&#8217;s Guide, Chapter 4: Lists, Streams (I) and Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_05_listsOfLists.html">User&#8217;s Guide, Chapter 5: Lists of Lists, Functions, and Recursion</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">User&#8217;s Guide, Chapter 6: Streams (II): Hierarchies, Recursion, and Flattening</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_07_chords.html">User&#8217;s Guide, Chapter 7: Chords</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_09_chordify.html">User&#8217;s Guide: Chapter 9: Chordify</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_10_fileFormats1.html">User&#8217;s Guide, Chapter 10: File Formats (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_11_corpusSearching.html">User&#8217;s Guide: Chapter 11: Corpus Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_14_timeSignatures.html">User&#8217;s Guide: Chapter 14: Time Signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_17_derivations.html">User&#8217;s Guide: Chapter 17: Derivations</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_21_sorting.html">User&#8217;s Guide, Chapter 21: Ordering and Sorting of Stream Elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_22_graphing.html">User’s Guide, Chapter 22: Graphing</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_25_postTonalTools1.html">User&#8217;s Guide, Chapter 25: Post-Tonal Tools (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_54_extendingConverter.html">User&#8217;s Guide: Chapter 54: Extending Converter with New Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="usersGuide_55_advancedMeter.html">User&#8217;s Guide: Chapter 55: Advanced Meter Topics</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../moduleReference/index.html">Module Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installing/index.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Music21 Concepts Overview</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../systemReference/index.html">System Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developerReference/index.html">Developer Reference</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/usersGuide/usersGuide_06_stream2.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="usersguide-06-stream2"></span><div class="section" id="user-s-guide-chapter-6-streams-ii-hierarchies-recursion-and-flattening">
<h1>User&#8217;s Guide, Chapter 6: Streams (II): Hierarchies, Recursion, and Flattening<a class="headerlink" href="#user-s-guide-chapter-6-streams-ii-hierarchies-recursion-and-flattening" title="Permalink to this headline">¶</a></h1>
<p>We ended Chapter 4 (<a class="reference internal" href="usersGuide_04_stream1.html#usersguide-04-stream1"><span>Streams (I)</span></a>.) with
a <a class="reference internal" href="../moduleReference/moduleStream.html#music21.stream.Stream" title="music21.stream.Stream"><code class="xref py py-class docutils literal"><span class="pre">Stream</span></code></a> that was contained within another
<code class="docutils literal"><span class="pre">Stream</span></code> object. Let&#8217;s recreate that class:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">note1</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="s">&quot;C4&quot;</span><span class="p">)</span>
<span class="n">note1</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">&#39;half&#39;</span>
<span class="n">note2</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="s">&quot;F#4&quot;</span><span class="p">)</span>
<span class="n">note3</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="s">&quot;B-2&quot;</span><span class="p">)</span>

<span class="n">stream1</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">Stream</span><span class="p">()</span>
<span class="n">stream1</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="s">&#39;some notes&#39;</span>
<span class="n">stream1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">note1</span><span class="p">)</span>
<span class="n">stream1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">note2</span><span class="p">)</span>
<span class="n">stream1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">note3</span><span class="p">)</span>

<span class="n">biggerStream</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">Stream</span><span class="p">()</span>
<span class="n">note2</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="s">&quot;D#5&quot;</span><span class="p">)</span>
<span class="n">biggerStream</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">note2</span><span class="p">)</span>
<span class="n">biggerStream</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stream1</span><span class="p">)</span>
</pre></div>
</div>
<p>The only way to find out what was in the contained Stream that we
demonstrated so far was the <a class="reference internal" href="../moduleReference/moduleBase.html#music21.base.Music21Object.show" title="music21.base.Music21Object.show"><code class="xref py py-meth docutils literal"><span class="pre">show()</span></code></a>
method using the <code class="docutils literal"><span class="pre">('text')</span></code> argument.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">biggerStream</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s">&#39;text&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> {0.0} &lt;music21.note.Note D#&gt;
 {1.0} &lt;music21.stream.Stream some notes&gt;
     {0.0} &lt;music21.note.Note C&gt;
     {2.0} &lt;music21.note.Note F#&gt;
     {3.0} &lt;music21.note.Note B-&gt;
</pre></div>
</div>
<p>As Chapter 4 noted, there&#8217;s</p>
<div class="section" id="accessing-scores-parts-measures-and-notes">
<h2>Accessing Scores, Parts, Measures, and Notes<a class="headerlink" href="#accessing-scores-parts-measures-and-notes" title="Permalink to this headline">¶</a></h2>
<p>Streams provide a way to structure and position music21 objects both
hierarchically and temporally. A Stream, or a Stream subclass such as
<a class="reference internal" href="../moduleReference/moduleStream.html#music21.stream.Measure" title="music21.stream.Measure"><code class="xref py py-class docutils literal"><span class="pre">Measure</span></code></a>, can be placed within another Stream.</p>
<p>A common arrangement of nested Streams is a
<a class="reference internal" href="../moduleReference/moduleStream.html#music21.stream.Score" title="music21.stream.Score"><code class="xref py py-class docutils literal"><span class="pre">Score</span></code></a> Stream containing one or more
<a class="reference internal" href="../moduleReference/moduleStream.html#music21.stream.Part" title="music21.stream.Part"><code class="xref py py-class docutils literal"><span class="pre">Part</span></code></a> Streams, each Part Stream in turn
containing one or more <a class="reference internal" href="../moduleReference/moduleStream.html#music21.stream.Measure" title="music21.stream.Measure"><code class="xref py py-class docutils literal"><span class="pre">Measure</span></code></a> Streams.</p>
<p>Such an arrangement of Stream objects is the common way musical scores
are represented in music21. For example, importing a four-part chorale
by J. S. Bach will provide a Score object with four Part Streams, each
Part containing multiple Measure objects. Music21 comes with a
<a class="reference internal" href="../moduleReference/moduleCorpus.html#modulecorpus"><span>music21.corpus</span></a> module that provides access to a large collection
of scores, including all the Bach chorales. We can parse the score from
the corpus with the <a class="reference internal" href="../moduleReference/moduleCorpus.html#music21.corpus.parse" title="music21.corpus.parse"><code class="xref py py-func docutils literal"><span class="pre">parse()</span></code></a> function.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">sBach</span> <span class="o">=</span> <span class="n">corpus</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s">&#39;bach/bwv57.8&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">We can access and examine elements at each level of this Score by</div>
</div>
<p>using standard Python syntax for lists within lists. Thus, we can see
the length of each component: first the Score which has five elements, a
<a class="reference internal" href="../moduleReference/moduleMetadata.html#music21.metadata.Metadata" title="music21.metadata.Metadata"><code class="xref py py-class docutils literal"><span class="pre">Metadata</span></code></a> object and four parts. Then we
find the length of first Part at index one which indicates 19 objects
(18 of them are measures).
| Then within that part we find an object (a Measure) at index 1. All of
these subprograms can be accessed from looking within the same score
object <code class="docutils literal"><span class="pre">sBach</span></code>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">len</span><span class="p">(</span><span class="n">sBach</span><span class="p">)</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> <span class="mi">6</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">len</span><span class="p">(</span><span class="n">sBach</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> <span class="mi">19</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">len</span><span class="p">(</span><span class="n">sBach</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> <span class="mi">6</span>
</pre></div>
</div>
<p>But how did we know that index [1] would be a Part and index [1][1]
would be a measure? As writers of the tutorial, we know this piece well
enough to know that. But as we noted above, more than just Measures
might be stored in a Part object (such as
<a class="reference internal" href="../moduleReference/moduleInstrument.html#music21.instrument.Instrument" title="music21.instrument.Instrument"><code class="xref py py-class docutils literal"><span class="pre">Instrument</span></code></a> objects), and more than just
Note and Rest objects might be stored in a Measure (such as
<a class="reference internal" href="../moduleReference/moduleMeter.html#music21.meter.TimeSignature" title="music21.meter.TimeSignature"><code class="xref py py-class docutils literal"><span class="pre">TimeSignature</span></code></a> and
<a class="reference internal" href="../moduleReference/moduleKey.html#music21.key.KeySignature" title="music21.key.KeySignature"><code class="xref py py-class docutils literal"><span class="pre">KeySignature</span></code></a> objects). We it&#8217;s much safer to
filter Stream and Stream subclasses by the class we seek. To repeat the
count and select specific classes, we can use the
<a class="reference internal" href="../moduleReference/moduleStream.html#music21.stream.Stream.getElementsByClass" title="music21.stream.Stream.getElementsByClass"><code class="xref py py-meth docutils literal"><span class="pre">getElementsByClass()</span></code></a> method.</p>
<p>Notice how the counts deviate from the examples above.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">len</span><span class="p">(</span><span class="n">sBach</span><span class="o">.</span><span class="n">getElementsByClass</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">Part</span><span class="p">))</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> <span class="mi">4</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">len</span><span class="p">(</span><span class="n">sBach</span><span class="o">.</span><span class="n">getElementsByClass</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">Part</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getElementsByClass</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">Measure</span><span class="p">))</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> <span class="mi">18</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">len</span><span class="p">(</span><span class="n">sBach</span><span class="o">.</span><span class="n">getElementsByClass</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">Part</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getElementsByClass</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">Measure</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">getElementsByClass</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">))</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> <span class="mi">3</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../moduleReference/moduleStream.html#music21.stream.Stream.getElementsByClass" title="music21.stream.Stream.getElementsByClass"><code class="xref py py-meth docutils literal"><span class="pre">getElementsByClass()</span></code></a> method can also
take a string representation of the last section of the class name. Thus
we could&#8217;ve rewritten the first call above as:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">len</span><span class="p">(</span><span class="n">sBach</span><span class="o">.</span><span class="n">getElementsByClass</span><span class="p">(</span><span class="s">&#39;Part&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> <span class="mi">4</span>
</pre></div>
</div>
<p>This way of doing things is a bit faster to code, but a little less
safe. Suppose, for instance there were objects of type stream.Measure
and tape.Measure; the latter way of writing the code would get both of
them. (But this ambiguity is rare enough that it&#8217;s safe enough to use
the strings in most code.)</p>
<p>There are some convenience properties you should know about. Calling
<code class="docutils literal"><span class="pre">.parts</span></code> is the same as <code class="docutils literal"><span class="pre">.getElementsByClass(stream.Part)</span></code> and
calling <code class="docutils literal"><span class="pre">.notes</span></code> is the same as
<code class="docutils literal"><span class="pre">.getElementsByClass([note.Note,</span> <span class="pre">note.Chord])</span></code>. Notice that the last
example also shows that you can give more than one class to
<code class="docutils literal"><span class="pre">getElementsByClass</span></code> by passing in a list of classes. Note also that
when using <code class="docutils literal"><span class="pre">.parts</span></code> or <code class="docutils literal"><span class="pre">.notes</span></code>, you do not write the <code class="docutils literal"><span class="pre">()</span></code> after
the name. Also be aware that <code class="docutils literal"><span class="pre">.notes</span></code> does not include rests. For
that, we have a method called <code class="docutils literal"><span class="pre">.notesAndRests</span></code>.</p>
<p>The index position of a Measure is often not the same as the Measure
number. For instance, most pieces that don&#8217;t have pickup measures begin
with measure 1, not zero. Sometimes there are measure discontinuities
within a piece (e.g., some people number first and second endings with
the same measure number). For that reason, gathering Measures is best
accomplished not with <code class="docutils literal"><span class="pre">getElementsByClass(stream.Measure)</span></code> but instead
with either the <a class="reference internal" href="../moduleReference/moduleStream.html#music21.stream.Stream.measures" title="music21.stream.Stream.measures"><code class="xref py py-meth docutils literal"><span class="pre">measures()</span></code></a> method
(returning a Stream of Parts or Measures) or the
<a class="reference internal" href="../moduleReference/moduleStream.html#music21.stream.Stream.measure" title="music21.stream.Stream.measure"><code class="xref py py-meth docutils literal"><span class="pre">measure()</span></code></a> method (returning a single
Measure). What is great about these methods is that they can work on a
whole score and not just a single part.</p>
</div>
<div class="section" id="recursion-in-streams">
<h2>Recursion in Streams<a class="headerlink" href="#recursion-in-streams" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="flattening-a-stream">
<h2>Flattening a Stream<a class="headerlink" href="#flattening-a-stream" title="Permalink to this headline">¶</a></h2>
<p>While nested Streams offer expressive flexibility, it is often useful to
be able to flatten all Stream and Stream subclasses into a single Stream
containing only the elements that are not Stream subclasses. The
:attr:<code class="docutils literal"><span class="pre">~music21.stream.Stream.flat</span></code> property provides immediate access
to such a flat representation of a Stream. For example, doing a similar
count of components, such as that show above, we see that we cannot get
to all of the Note objects of a complete Score until we flatten its Part
and Measure objects by accessing the <code class="docutils literal"><span class="pre">flat</span></code> attribute.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">len</span><span class="p">(</span><span class="n">sBach</span><span class="o">.</span><span class="n">getElementsByClass</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">))</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> <span class="mi">0</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">len</span><span class="p">(</span><span class="n">sBach</span><span class="o">.</span><span class="n">flat</span><span class="o">.</span><span class="n">getElementsByClass</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">Note</span><span class="p">))</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> <span class="mi">213</span>
</pre></div>
</div>
<p>Element offsets are always relative to the Stream that contains them.
For example, a Measure, when placed in a Stream, might have an offset of
16. This offset describes the position of the Measure in the Stream.
Components of this Measure, such as Notes, have offset values relative
only to their container, the Measure. The first Note of this Measure,
then, has an offset of 0. In the following example we find that the
offset of measure eight (using the
<a class="reference internal" href="../moduleReference/moduleBase.html#music21.base.Music21Object.getOffsetBySite" title="music21.base.Music21Object.getOffsetBySite"><code class="xref py py-meth docutils literal"><span class="pre">getOffsetBySite()</span></code></a> method) is 21; the
offset of the second Note in this Measure (index 1), however, is 1.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">m</span> <span class="o">=</span> <span class="n">sBach</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getElementsByClass</span><span class="p">(</span><span class="s">&#39;Measure&#39;</span><span class="p">)[</span><span class="mi">7</span><span class="p">]</span>
<span class="n">m</span><span class="o">.</span><span class="n">getOffsetBySite</span><span class="p">(</span><span class="n">sBach</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> <span class="mf">21.0</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">sBach</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">notes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">n</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> &lt;music21.note.Note B-&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">n</span><span class="o">.</span><span class="n">getOffsetBySite</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> <span class="mf">1.0</span>
</pre></div>
</div>
<p>Flattening a structure of nested Streams will set new, shifted offsets
for each of the elements on the Stream, reflecting their appropriate
position in the context of the Stream from which the <code class="docutils literal"><span class="pre">flat</span></code> property
was accessed. For example, if a flat version of the first part of the
Bach chorale is obtained, the note defined above has the appropriate
offset of 22 (the Measure offset of 21 plus the Note offset within this
Measure of 1).</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">pFlat</span> <span class="o">=</span> <span class="n">sBach</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flat</span>
<span class="n">indexN</span> <span class="o">=</span> <span class="n">pFlat</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">pFlat</span><span class="p">[</span><span class="n">indexN</span><span class="p">]</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> &lt;music21.note.Note B-&gt;
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">pFlat</span><span class="p">[</span><span class="n">indexN</span><span class="p">]</span><span class="o">.</span><span class="n">offset</span>
</pre></div>
</div>
<div class="ipython-result highlight-python"><div class="highlight"><pre> <span class="mf">22.0</span>
</pre></div>
</div>
<p>As an aside, it is important to recognize that the offset of the Note
has not been edited; instead, a Note, as all Music21Objects, can store
multiple pairs of sites and offsets. Music21Objects retain an offset
relative to all Stream or Stream subclasses they are contained within,
even if just in passing.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="usersGuide_07_chords.html" title="User’s Guide, Chapter 7: Chords"
             >next</a> |</li>
        <li class="right" >
          <a href="usersGuide_05_listsOfLists.html" title="User’s Guide, Chapter 5: Lists of Lists, Functions, and Recursion"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">music21</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Users Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2006-2015, Michael Scott Cuthbert and cuthbertLab.
      Last updated on Sep 09, 2015.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>