<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction &mdash; PyAtomDB 0.0.0.6 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="PyAtomDB 0.0.0.6 documentation" href="index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PyAtomDB 0.0.0.6 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>pyatomdb is a selection of utilities designed to interact with the AtomDB
database. Currently, these utilities are in a far from finished format, however
progress on this is ongoing. These have been taken from a series of codes on my
laptop which were useful. Some produce lots of unhelpful onscreen output.</p>
<p>There are several different modules currently. These are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">atomdb</span></code>  : a series of codes for interacting with the AtomDB atomic database</li>
<li><code class="docutils literal"><span class="pre">atomic</span></code>  : basic atomic data routines - e.g. converting element symbols to atomic number, etc.</li>
<li><code class="docutils literal"><span class="pre">const</span></code>   : a series of physical constants</li>
<li><code class="docutils literal"><span class="pre">spectrum</span></code>: routines for generating spectra from the published AtomDB line and continuum emissivity files</li>
<li><code class="docutils literal"><span class="pre">util</span></code>    : sumple utility codes (sorting etc) that pyatomdb relies on.</li>
</ul>
<p>Currently, only the spectrum library has been extensively tested. Expect bugs.
Report those bugs!</p>
</div>
<div class="section" id="license">
<h1>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h1>
<p>Pyatomdb is released under the Smithsonian License:</p>
<p>Copyright 2015 Smithsonian Institution. Permission is granted to use, copy,
modify, and distribute this software and its documentation for educational,
research and non-profit purposes, without fee and without a signed
licensing agreement, provided that this notice, including the following
two paragraphs, appear in all copies, modifications and distributions.
For commercial licensing, contact the Office of the Chief Information
Officer, Smithsonian Institution, 380 Herndon Parkway, MRC 1010, Herndon,
VA. 20170, 202-633-5256.</p>
<p>This software and accompanying documentation is supplied &#8220;as is&#8221; without
warranty of any kind. The copyright holder and the Smithsonian
Institution: (1) expressly disclaim any warranties, express or implied,
including but not limited to any implied warranties of merchantability,
fitness for a particular purpose, title or non-infringement; (2) do not
assume any legal liability or responsibility for the accuracy,
completeness, or usefulness of the software; (3) do not represent that use
of the software would not infringe privately owned rights; (4) do not
warrant that the software is error-free or will be maintained, supported,
updated or enhanced; (5) will not be liable for any indirect, incidental,
consequential special or punitive damages of any kind or nature,
including but not limited to lost profits or loss of data, on any basis
arising from contract, tort or otherwise, even if any of the parties has
been warned of the possibility of such loss or damage.</p>
</div>
<div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="interrogating-the-database">
<h2>Interrogating the database<a class="headerlink" href="#interrogating-the-database" title="Permalink to this headline">¶</a></h2>
<p>This makes use of the atomdb module. Before starting, it is a good
idea to download the AtomDB tarballs from www.atomdb.org/Downloads: the latest one is version 3.0.2. This dataset contains the filemap, which identifies the correct files for each different ion and process.</p>
<p>It is also important to set the ATOMDB environment variable to point to where this data was untarred, e.g. the folder with the filemap in it, so $ATOMDB/filemap should exist.
e.g:</p>
<div class="highlight-python"><div class="highlight"><pre>bash: export ATOMDB=/myfolder/atomdb_v3.0.2
csh: setenv ATOMDB /myfolder/atomdb_v3.0.2
</pre></div>
</div>
<p>or within python:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;ATOMDB&#39;</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;/myfolder/atomdb_v3.0.2&#39;</span>
</pre></div>
</div>
<p>Currently, the AtomDB database is more than 10GB of data, so we are avoiding distributing it to all users. You can, however, get the individual data you need using the <code class="docutils literal"><span class="pre">get_data</span></code> routine:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">lvdata</span> <span class="o">=</span> <span class="n">pyatomdb</span><span class="o">.</span><span class="n">atomdb</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">z0</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">ftype</span><span class="p">)</span>
</pre></div>
</div>
<p>This will try to open the file locally if it exists, and if it does not it will then go to the AtomDB FTP server and download the data for element z0, ion z1, with ftype a 2-character string denoting the type of data to get:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">IR</span></code>: ionization and recombination</li>
<li><code class="docutils literal"><span class="pre">LV</span></code>: energy levels</li>
<li><code class="docutils literal"><span class="pre">LA</span></code>: radiative transition data (lambda and A-values)</li>
<li><code class="docutils literal"><span class="pre">EC</span></code>: electron collision data</li>
<li><code class="docutils literal"><span class="pre">PC</span></code>: proton collision data</li>
<li><code class="docutils literal"><span class="pre">DR</span></code>: dielectronic recombination satellite line data</li>
<li><code class="docutils literal"><span class="pre">PI</span></code>: XSTAR photoionization data</li>
<li><code class="docutils literal"><span class="pre">AI</span></code>: autoionization data</li>
</ul>
<p>So to open the energy levels for oxygen with 2 electrons (O 6+, or O VII):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">lvdata</span> <span class="o">=</span> <span class="n">pyatomdb</span><span class="o">.</span><span class="n">atomdb</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="s">&#39;LV&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Data files are stored in <code class="docutils literal"><span class="pre">$ATOMDB/APED/&lt;elsymb&gt;/&lt;elsymb&gt;_&lt;ionnum&gt;/</span></code></p>
</div>
<div class="section" id="making-a-spectrum">
<h2>Making a Spectrum<a class="headerlink" href="#making-a-spectrum" title="Permalink to this headline">¶</a></h2>
<p>These functions are in the <code class="docutils literal"><span class="pre">spectrum</span></code> module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pyatomdb</span><span class="o">,</span> <span class="nn">numpy</span><span class="o">,</span> <span class="nn">pylab</span>

<span class="c"># set up a grid of energy bins to model the spectrum on:</span>
<span class="n">ebins</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>

<span class="c"># define a broadening, in keV, for the lines</span>
<span class="n">de</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="c"># define the temperature at which to plot (keV)</span>
<span class="n">te</span> <span class="o">=</span> <span class="mf">3.0</span>

<span class="c"># find the index which is closest to this temperature</span>
<span class="n">ite</span> <span class="o">=</span> <span class="n">pyatomdb</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span> <span class="n">te</span><span class="p">,</span> <span class="n">teunits</span><span class="o">=</span><span class="s">&#39;keV&#39;</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># create both a broadened and an unbroadened spectrum</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">pyatomdb</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">ebins</span><span class="p">,</span> <span class="n">ite</span><span class="p">,</span><span class="n">dummyfirst</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">pyatomdb</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">ebins</span><span class="p">,</span> <span class="n">ite</span><span class="p">,</span> <span class="n">broadening</span><span class="o">=</span><span class="n">de</span><span class="p">,</span> \
                                    <span class="n">broadenunits</span><span class="o">=</span><span class="s">&#39;kev&#39;</span><span class="p">,</span><span class="n">dummyfirst</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># The dummyfirst argument adds an extra 0 at teh beginning of the</span>
<span class="c"># returned array so it is the same length as ebins. It allows</span>
<span class="c"># accurate plotting using the &quot;drawstyle=&#39;steps&#39;&quot; flag to plot.</span>

<span class="c"># plot the results</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">ebins</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">drawstyle</span><span class="o">=</span><span class="s">&#39;steps&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Unbroadened&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">ebins</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">drawstyle</span><span class="o">=</span><span class="s">&#39;steps&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;sigma = </span><span class="si">%.2f</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">de</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Energy (keV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Emissivity (ph cm$^{3}$ s$^{-1}$ bin$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">zzz</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Press enter to continue&quot;</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;Listing lines between 1 and 2 A&quot;</span>
<span class="c"># now list the lines in a wavelength region</span>
<span class="n">llist</span> <span class="o">=</span> <span class="n">pyatomdb</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">list_lines</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mf">2.0</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">ite</span><span class="p">)</span>
<span class="c"># print these to screen</span>
<span class="n">pyatomdb</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">print_lines</span><span class="p">(</span><span class="n">llist</span><span class="p">)</span>
<span class="c"># print to screen, listing the energy, not the wavelength</span>
<span class="k">print</span> <span class="s">&quot;Listing lines between 1 and 2 A, using keV.&quot;</span>

<span class="n">pyatomdb</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">print_lines</span><span class="p">(</span><span class="n">llist</span><span class="p">,</span> <span class="n">specunits</span> <span class="o">=</span> <span class="s">&#39;keV&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a></li>
<li><a class="reference internal" href="#license">License</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#interrogating-the-database">Interrogating the database</a></li>
<li><a class="reference internal" href="#making-a-spectrum">Making a Spectrum</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pyatomdb_manual.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Adam Foster.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.3</a>
      
      |
      <a href="_sources/pyatomdb_manual.txt"
          rel="nofollow">Page source</a></li>
    </div>

    

    
  </body>
</html>