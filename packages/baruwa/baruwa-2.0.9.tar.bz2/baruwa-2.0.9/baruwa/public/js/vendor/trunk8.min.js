(function(g){var c,a,f={center:"center",left:"left",right:"right"},e={auto:"auto"};function b(h){this.$element=g(h);this.original_text=this.$element.html();this.settings=g.extend({},g.fn.trunk8.defaults)}b.prototype.updateSettings=function(h){this.settings=g.extend(this.settings,h)};function d(){var n=this.data("trunk8"),l=n.settings,h=l.width,p=l.side,u=l.fill,s=a.getLineHeight(this)*l.lines,q=n.original_text,i=q.length,j="",m,r,k,o,t;this.html(q);t=this.text();if(h===e.auto){if(this.height()<=s){return}m=0;r=i-1;while(m<=r){k=m+((r-m)>>1);o=a.eatStr(q,p,i-k,u);this.html(o);if(this.height()>s){r=k-1}else{m=k+1;j=(j.length>o.length)?j:o}}this.html("");this.html(j);if(l.tooltip){this.attr("title",t)}}else{if(!isNaN(h)){k=i-h;o=a.eatStr(q,p,k,u);this.html(o);if(l.tooltip){this.attr("title",q)}}else{g.error('Invalid width "'+h+'".')}}}c={init:function(h){return this.each(function(){var j=g(this),i=j.data("trunk8");if(!i){j.data("trunk8",(i=new b(this)))}i.updateSettings(h);d.call(j)})},update:function(h){return this.each(function(){var i=g(this);if(h){i.data("trunk8").original_text=h}d.call(i)})},revert:function(){return this.each(function(){var h=g(this).data("trunk8").original_text;g(this).html(h)})},getSettings:function(){return g(this.get(0)).data("trunk8").settings}};a={eatStr:function(o,k,j,n){var m=o.length,i=a.eatStr.generateKey.apply(null,arguments),h,l;if(a.eatStr.cache[i]){return a.eatStr.cache[i]}if((typeof o!=="string")||(m===0)){g.error('Invalid source string "'+o+'".')}if((j<0)||(j>m)){g.error('Invalid bite size "'+j+'".')}else{if(j===0){return o}}if(typeof(n+"")!=="string"){g.error("Fill unable to be converted to a string.")}switch(k){case f.right:return a.eatStr.cache[i]=g.trim(o.substr(0,m-j))+n;case f.left:return a.eatStr.cache[i]=n+g.trim(o.substr(j));case f.center:h=m>>1;l=j>>1;return a.eatStr.cache[i]=g.trim(a.eatStr(o.substr(0,m-h),f.right,j-l,""))+n+g.trim(a.eatStr(o.substr(m-h),f.left,l,""));default:g.error('Invalid side "'+k+'".')}},getLineHeight:function(j){var l=g(j).css("float");if(l!=="none"){g(j).css("float","none")}var m=g(j).css("position");if(m==="absolute"){g(j).css("position","static")}var h=g(j).html(),i="line-height-test",k;g(j).html("i").wrap('<div id="'+i+'" />');k=g("#"+i).innerHeight();g(j).html(h).css({"float":l,position:m}).unwrap();return k}};a.eatStr.cache={};a.eatStr.generateKey=function(){return Array.prototype.join.call(arguments,"")};g.fn.trunk8=function(h){if(c[h]){return c[h].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof h==="object"||!h){return c.init.apply(this,arguments)}else{g.error("Method "+h+" does not exist on jQuery.trunk8")}}};g.fn.trunk8.defaults={fill:"&hellip;",lines:1,side:f.right,tooltip:true,width:e.auto}})(jQuery);
