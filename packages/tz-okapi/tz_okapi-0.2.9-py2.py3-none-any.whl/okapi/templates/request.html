<div class="request-block" id="request-{{ request.guid }}">
  <div class="header">
    <div class="method">
      <div class="label label-{{ css_class }}">
        {% if not request.status %}
          <span class="text-warning"
                data-toggle="tooltip" data-placement="left"
                title="Tests failed">
          <span class="glyphicon glyphicon-warning-sign"></span>
        {% endif %}
        {{ request.method.upper() }}
        {% if not request.status %}
          </span>
        {% endif %}
      </div>
    </div>

    <code class="url" contenteditable="true" spellcheck="false">{{ url }}</code>
  </div>

  <div class="subheader">
    <span class="text-{{ response.status_code|status_code_class }}">
      Status code: <strong>{{ response.status_code }}</strong>
    </span>

    {% if not request.payload %} | empty request{% endif %}
    {% if not response.body %} | empty response{% endif %}

    <div class="exports">
        <a href="#" data-toggle="modal"
           data-target="#curl-{{ request.guid }}">cURL</a>
        <a href="#" data-toggle="modal"
           data-target="#jira-{{ request.guid }}">JIRA</a>
        <a href="#" data-toggle="modal"
           data-target="#tests-{{ request.guid }}">Tests</a>
        <a href="#request-{{ request.guid }}" class="text-right"><span
            class="glyphicon glyphicon-link"></span></a>
    </div>
  </div>

  {% if request.headers %}
    <div class="headers pre" contenteditable="true" spellcheck="false">
      {{ request.headers|headers_as_string|nl2br }}
    </div>
  {% endif %}

  <table>
   <tr>
  {% if request.payload %}
    <td {% if response.body %}style="width: 36%;"{% endif %}>
      <strong>Request</strong>
      <div class="request pre" contenteditable="true" spellcheck="false">
        {{ request.payload|e|nl2br }}
      </div>
    </td>
  {% endif %}

  {% if response.body %}
    <td>
      <strong>Response</strong>
      <div class="response pre" contenteditable="true" spellcheck="false">
        {{ response.body|e|nl2br }}
      </div>
    </td>
  {% endif %}
   </tr>
  </table>
</div>


<div class="modal" id="curl-{{ request.guid }}" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <textarea
            style="width: 100%; height: 500px;">{{ request|export_curl }}</textarea>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default"
                data-dismiss="modal">Close
        </button>
      </div>
    </div>
  </div>
</div>


<div class="modal" id="jira-{{ request.guid }}" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <textarea
            style="width: 100%; height: 500px;">{{ request|export_jira }}</textarea>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default"
                data-dismiss="modal">Close
        </button>
      </div>
    </div>
  </div>
</div>

<div class="modal" id="tests-{{ request.guid }}" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <strong>Tests: </strong><br>
        <ul>
          {% for test in request.tests %}
            <li
                class="text-{% if test.result %}success{% else %}danger{% endif %}">
              {{ test }}</li>
          {% endfor %}
        </ul>

        <p><small>
          <strong>Legend:</strong><br>

          <span class="text-success">Test succeeded</span>.<br>
          <span class="text-danger">Test failed</span>.<br>
        </small></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default"
                data-dismiss="modal">Close
        </button>
      </div>
    </div>
  </div>
</div>


